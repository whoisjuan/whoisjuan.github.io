/*! ====================================================== *
Copyright (c) 2015, Pykih Software LLP
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
* ====================================================== */
var PykCharts={};PykCharts.assets="../pykih-charts/assets/",PykCharts.export_menu_status=0,PykCharts["boolean"]=function(a){var b=["0","f","false","n","no","",0,"0.00","0.0",0,0],c=[void 0,null,0/0];return-1!==c.indexOf(a)?!1:(value=a.toLocaleString(),value=value.toLowerCase(),b.indexOf(value)>-1?!1:!0)},PykCharts.getEvent=function(){try{return d3.event||event}catch(a){return event}},PykCharts.Configuration=function(a){var b=this,c=(a.selector,{liveData:function(b){var c=a.real_time_charts_refresh_frequency;return PykCharts["boolean"](c)&&(clearInterval(a.interval),a.interval=setInterval(b.refresh,1e3*c)),this},emptyDiv:function(a){return d3.select(a).append("div").style("clear","both"),this},storeInitialDivHeight:function(){var b=parseFloat(d3.select(a.selector).style("height"));return a.original_div_height=b?parseFloat(d3.select(a.selector).style("height")):"auto",this},appendUnits:function(b){b=PykCharts.numberFormat(b);var c,d,e;return d=a.units_prefix,e=a.units_suffix,d?(c=d+" "+b,e&&(c+=" "+e)):c=e?b+" "+e:b,c},title:function(c){if(PykCharts["boolean"](a.title_text)&&a.title_size){var d=a.chart_width;c&&(d=c);var e=PykCharts["boolean"](a.export_enable)?.9*d:d;b.titleDiv=d3.select(a.selector).append("div").attr("id","title").style({width:e+"px","text-align":"left","float":"left"}).html("<span style='pointer-events:none;font-size:"+a.title_size+"vw;color:"+a.title_color+";font-weight:"+a.title_weight+";padding-left:1px;font-family:"+a.title_family+"'>"+a.title_text+"</span>")}return this},subtitle:function(c){if(PykCharts["boolean"](a.subtitle_text)&&a.subtitle_size){var d=a.chart_width;c&&(d=c),b.subtitleDiv=d3.select(a.selector).append("div").attr("id","sub-title").style({width:d+"px","text-align":"left"}).html("<span style='pointer-events:none;font-size:"+a.subtitle_size+"vw;color:"+a.subtitle_color+";font-weight:"+a.subtitle_weight+";padding-left:1px;font-family:"+a.subtitle_family+"'>"+a.subtitle_text+"</span>")}return this},createFooter:function(b){var c=a.chart_width;return b&&(c=b),d3.select(a.selector).append("table").attr({id:"footer",width:c+"px"}).style("background",a.bg),this},lastUpdatedAt:function(b){if(PykCharts["boolean"](a.real_time_charts_refresh_frequency)&&PykCharts["boolean"](a.real_time_charts_last_updated_at_enable)){var c=new Date,d=c.getDate()+"/"+(c.getMonth()+1)+"/"+c.getFullYear()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();"liveData"===b?document.querySelectorAll(a.selector+" #lastUpdatedAt").innerHTML="<span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+d+"</span>":d3.select(a.selector+" #footer").append("tr").attr("class","PykCharts-credits").html("<td colspan=2 style='text-align:right' id='lastUpdatedAt'><span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+d+"</span></tr>")}return this},checkChangeInData:function(c,d){var e=Object.keys(d[0]),f=Object.keys(c[0]),g=!1,h=c.length,i=e.length;if(e.length===f.length&&d.length===c.length){for(var j=0;h>j;j++)for(var k=0;i>k;k++)if("object"!=typeof c[j][f[k]]&&"object"!=typeof d[j][e[k]]){if(c[j][f[k]]!==d[j][e[k]]||e[k]!==f[k]){g=!0;break}}else if(!a.k.__proto__._isEqual(c[j][f[k]],d[j][e[k]])||e[k]!==f[k]){g=!0;break}}else g=!0;return b.compare_data=c,[b.compare_data,g]},credits:function(){if(PykCharts["boolean"](a.credit_my_site_name)||PykCharts["boolean"](a.credit_my_site_url)){var b=!0;""===a.credit_my_site_name&&(a.credit_my_site_name=a.credit_my_site_url),""===a.credit_my_site_url&&(b=!1),d3.select(a.selector+" #footer").append("tr").attr({"class":"PykCharts-credits",id:"credit-datasource"}).append("td").style("text-align","left").html("<span style='pointer-events:none;'>Credits: </span><a href='"+a.credit_my_site_url+"' target='_blank' onclick='return "+b+"'>"+a.credit_my_site_name+"</a>")}return this},dataSource:function(){if(PykCharts["boolean"](a.data_source_name)||PykCharts["boolean"](a.data_source_url)){var b=!0;""===a.data_source_name&&(a.data_source_name=a.data_source_url),""===a.data_source_url&&(b=!1);var c="<span style='pointer-events:none;'>Source: </span><a href='"+a.data_source_url+"' target='_blank' onclick='return "+b+"'>"+a.data_source_name+"</a></tr>";d3.selectAll(a.selector+" #footer").length?d3.select(a.selector+" table #credit-datasource").style({background:a.bg,"text-align":"right"}).append("td").html(c):d3.select(a.selector).append("table").attr({id:"footer","class":"PykCharts-credits",width:a.chart_width+"px"}).style({background:a.bg,"text-align":"right"}).append("tr").append("td").html(c)}return this},makeMainDiv:function(b,c){var d=d3.select(b).append("div").attr({id:"chart-container-"+c,"class":"main-div"}).style("width",a.chart_width+"px");return PykCharts["boolean"](a.panels_enable)&&d.style({"float":"left",width:"auto"}),this},tooltip:function(b,c,d){if((PykCharts["boolean"](a.tooltip_enable)||"string"===a.axis_x_data_format||"string"===a.axis_y_data_format||PykCharts["boolean"](a.annotation_enable))&&"default"===a.mode){var e;if(void 0!==c){var f=a.selector.substr(1,a.selector.length);e="tooltip-svg-container-"+d+"-pyk-tooltip"+f}else e="pyk-tooltip";PykCharts.Configuration.tooltipp=d3.select("body").append("div").attr({id:e,"class":"pyk-tooltip"})}else PykCharts["boolean"](a.tooltip_enable)&&(PykCharts.Configuration.tooltipp=d3.select("body").append("div").attr({id:"pyk-tooltip","class":"pyk-tooltip"}));return this},dateConversion:function(a){a=new Date(a);var b=a.getTimezoneOffset();return a=new Date(a.getTime()+60*b*1e3)},loading:function(){d3.select(a.selector).style("height",a.chart_height);var b="image"===a.loading_type?"<img src="+a.loading_source+">":a.loading_source;d3.select(a.selector).html("<div id='chart-loader'>"+b+"</div>");var c=parseFloat(d3.select(a.selector).style("height"));return d3.select(a.selector+" #chart-loader").style({visibility:"visible","padding-left":a.chart_width/2+"px","padding-top":c/2+"px"}),this},remove_loading_bar:function(b){var c=document.querySelector(a.selector+" #chart-loader");return c&&c.parentNode.removeChild(c),document.getElementById(b).style.height=a.original_div_height,this},dataFromPykQuery:function(b){PykCharts.boolean(a.interactive_enable)&&(a.data=b)},totalColors:function(a){var c=parseInt(a,10);return c>2&&10>c?(b.total_colors=c,this):(b.total_colors=9,this)},colorType:function(a){return"color"===a&&(b.legends="no"),this},resize:function(b,c){var d=a.chart_width;PykCharts["boolean"](a.panels_enable)&&c&&(d=c);var e,f=d/a.chart_height,g=isNaN(parseFloat(d3.select(a.selector).style("width")))?0:parseFloat(d3.select(a.selector).style("width")),h=d3.selectAll(a.selector+" #footer"),i=d3.selectAll(a.selector+" .main-div");if((g>d||0===g)&&(g=d),PykCharts["boolean"](b)&&(b.attr({width:g,height:g/f}),d3.selectAll(a.selector+" .main-div").style("width",g+"px")),PykCharts["boolean"](a.title_text)&&PykCharts["boolean"](a.export_enable)&&(e=.9*g,d3.select(a.selector+" #title").style("width",e+"px")),PykCharts["boolean"](a.subtitle_text)&&(e=.9*g,d3.select(a.selector+" #sub-title").style("width",e+"px")),PykCharts["boolean"](a.export_enable)&&(div_size=g,div_float="none",div_left=g-16,PykCharts["boolean"](a.title_text)&&a.title_size&&"default"===a.mode&&(div_size=.1*g,div_float="left",div_left=0),d3.select(a.selector+" #export").style({width:div_size+"px",left:div_left+"px","float":div_float}),d3.select(a.selector+" .dropdown-multipleConatiner-export").style("left",g-80+"px")),h&&h.attr("width",g),i&&!PykCharts["boolean"](a.panels_enable)){var j=document.querySelector(a.selector+" .main-div");j&&(j.style.width=g)}},__proto__:{_downloadDataURI:function(a){function b(a){return"object"!=typeof a||a.nodeType||null!=a&&a===a.window?!1:a.constructor&&!a.constructor.prototype.hasOwnProperty("isPrototypeOf")?!1:!0}if(a){b(a)||(a={data:a}),a.filename||(a.filename="download."+a.data.split(",")[0].split(";")[0].substring(5).split("/")[1]),a.url||(a.url="http://download-data-uri.appspot.com/");var c=(d3.select("body").append("form").attr("id","export-form").attr("method","post").attr("action",a.url).style("display","none").html("<input type='hidden' name='filename' value='"+a.filename+"'/><input type='hidden' name='data' value='"+a.data+"'/>"),document.getElementById("export-form"));c.submit(),c.parentNode.removeChild(c)}},_xmlToJson:function(a,b){var c,d,e,f,g,h,i,j,k,l=[],m=a.firstChild.childElementCount;for(0==b?(h=b,k=m,j=1):1==b&&(h=b,k=2*m+1,j=2);k>h;h+=j){for(c=a.firstChild.childNodes[h],g={},i=0,element_len=c.childElementCount;element_len>i;i++)d=c.children.item(i),e=d.nodeName,f=d.textContent,g[e]=f;l.push(g)}return l},_domainBandwidth:function(b,c,d){if(addFactor=0,"time"===d){var e=b[0],f=b[1],g=[];switch(padding=.1*(f-e),c){case 0:g[0]=e-(padding+addFactor);break;case 1:g[1]=f+(padding+addFactor);break;case 2:g[0]=e-(padding+addFactor),g[1]=f+(padding+addFactor)}return[a.k.dateConversion(g[0]),a.k.dateConversion(g[1])]}switch(padding=.1*(b[1]-b[0]),c){case 0:b[0]-=padding+addFactor;break;case 1:b[1]=parseFloat(b[1],10)+(padding+addFactor);break;case 2:b[0]-=padding+addFactor,b[1]=parseFloat(b[1],10)+(padding+addFactor)}return b},_radiusCalculation:function(b,c){var d;return d="percentageBar"===c?a.chart_height:"spiderweb"===c?d3.min([a.chart_width-a.legendsGroup_width,a.chart_height-a.legendsGroup_height-20]):void 0!==c?a.chart_width:d3.min([a.chart_width,a.chart_height]),d*b/200},_getHighestParentsAttribute:function(a,b){function c(a){return"body"===a.tagName.toLowerCase()?void(d=null):(d=a.style[b],d||(d=d3.select(a).style(b)),void(d||c(a.parentNode)))}var d,e=document.querySelector(a);return c(e),d},_groupBy:function(a,b){for(var c,d,e=[],f={oned:["name"],line:["x","name"],area:["x","name"],bar:["y","group"],column:["x","group"],scatterplot:["x","y","name","group"],pulse:["x","y","name","group"],spiderweb:["x","group"],waterfall:["x","y"],simple2x2:["group"]},g={oned:{dimension:"name",fact:"weight"},line:{dimension:"x",fact:"y",name:"name"},area:{dimension:"x",fact:"y",name:"name"},bar:{dimension:"y",fact:"x",name:"group"},column:{dimension:"x",fact:"y",name:"group"},scatterplot:{dimension:"x",fact:"y",weight:"weight",name:"name",group:"group"},pulse:{dimension:"y",fact:"x",weight:"weight",name:"name",group:"group"},spiderweb:{dimension:"x",fact:"y",name:"name",weight:"weight"},waterfall:{dimension:"y",fact:"x",name:"group"},simple2x2:{dimension:"group",fact:"weight"}},h=f[a],i=[],j=b.length,c=0;j>c;c+=1){var d=b[c];if(0==i.length)i.push([d]);else{for(var k=!1,l=i.length,m=0;l>m;m+=1){var n=i[m],o=!0,p=n[0];h.forEach(function(a){p[a]!==d[a]&&(o=!1)}),o&&(k=n)}k?k.push(d):i.push([d])}}for(c in i)if(i[c].constructor===Array){d={};var q=i[c],r=g[a],s=[],t={},u={};d[r.dimension]=q[0][r.dimension],r.name&&(d[r.name]=q[0][r.name]),r.weight?(d[r.weight]=d3.sum(q,function(b){return b[g[a].weight]}),d[r.fact]="spiderweb"===a?d3.sum(q,function(b){return b[g[a].fact]}):q[0][r.fact]):d[r.fact]=d3.sum(q,function(b){return b[g[a].fact]}),r.group&&(d[r.group]=q[0][r.group]);for(var v in g[a])s.push(g[a][v]);for(var v in q[0]){for(var w=0,c=0;c<s.length;c++)if(v===s[c]){w=1;break}0===w&&(t[v]=q[0][v])}for(var v in d)u[v]=d[v];for(var v in t)u[v]=t[v];e.push(u)}return e},_sortData:function(a,b,c,d,e){if(PykCharts["boolean"](d.data_sort_enable)||e){if(PykCharts["boolean"](d.data_sort_enable))switch(d.data_sort_type){case"numerically":a.sort(function(a,c){return"descending"===d.data_sort_order?c[b]-a[b]:a[b]-c[b]});break;case"alphabetically":a.sort(function(a,e){return a[b]<e[b]?"descending"===d.data_sort_order?1:-1:a[b]>e[b]?"descending"===d.data_sort_order?-1:1:a[c]<e[c]?"descending"===d.data_sort_order?1:-1:a[c]>e[c]?"descending"===d.data_sort_order?-1:1:0});break;case"date":a.sort(function(a,e){return new Date(a[b])<new Date(e[b])?"descending"===d.data_sort_order?1:-1:new Date(a[b])>new Date(e[b])?"descending"===d.data_sort_order?-1:1:a[c]<e[c]?"descending"===d.data_sort_order?1:-1:a[c]>e[c]?"descending"===d.data_sort_order?-1:1:0})}}else a.sort(function(a,b){return a[c]>b[c]?1:a[c]<b[c]?-1:void 0});return a},_unique:function(a,b){for(var c={},d=[],e=0,f=a.length;f>e;e++)b&&(a[e]=a[e][b]),c[a[e]]||(c[a[e]]=!0,d.push(a[e]));return d},_ready:function(a){function b(){document.removeEventListener("DOMContentLoaded",b,!1),window.removeEventListener("load",b,!1)}return document.addEventListener?(document.addEventListener("DOMContentLoaded",b,!1),window.addEventListener("load",b,!1)):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&document.detachEvent("onreadystatechange",arguments.callee)}),this},_colourBrightness:function(a,b){var c,d,e,f,g=1,h=a;if(h.match(/^rgba/)?(h=h.match(/rgba\(([^)]+)\)/)[1],h=h.split(/ *, */).map(Number),c=h[0],d=h[1],e=h[2],g=h[3]):h.match(/^rgb/)?(h=h.match(/rgb\(([^)]+)\)/)[1],h=h.split(/ *, */).map(Number),c=h[0],d=h[1],e=h[2]):"#"==h[0]&&7==h.length?(c=parseInt(h.slice(1,3),16),d=parseInt(h.slice(3,5),16),e=parseInt(h.slice(5,7),16)):"#"==h[0]&&4==h.length&&(c=parseInt(h[1]+h[1],16),d=parseInt(h[2]+h[2],16),e=parseInt(h[3]+h[3],16)),f=(299*c+587*d+114*e)/1e3,125>f&&g>.5){if(!b)return"dark";d3.selectAll(b).classed({light:!1,dark:!0})}else if(125>f&&.5>=g){if(!b)return"light";d3.selectAll(b).classed({light:!0,dark:!1})}else{if(!b)return"light";d3.selectAll(b).classed({light:!0,dark:!1})}},_isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},_where:function(a,b){var c=a.length,d=[];if("object"==typeof a)for(var e in a){var f=0,g=0;for(var h in b)a[e].hasOwnProperty(h)&&a[e][h]===b[h]?f+=1:f=0,g+=1;f===g&&d.push(a[e])}else for(var e=0;c>e;e++){var f=0,g=0;for(var h in b)a[e].hasOwnProperty(h)&&a[e][h]===b[h]?f+=1:f=0,g+=1;f===g&&d.push(a[e])}return d},_isEqual:function(a,b){var c=function(a,b,e,f){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;var g=toString.call(a);if(g!==toString.call(b))return!1;switch(g){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var h=e.length;h--;)if(e[h]===a)return f[h]===b;var i=a.constructor,j=b.constructor;if(i!==j&&"constructor"in a&&"constructor"in b&&!(d(i)&&i instanceof i&&d(j)&&j instanceof j))return!1;e.push(a),f.push(b);var k,l;if("[object Array]"===g){if(k=a.length,l=k===b.length)for(;k--&&(l=c(a[k],b[k],e,f)););}else{var m,n=Object.getOwnPropertyNames(a);if(k=n.length,l=Object.getOwnPropertyNames(b).length===k)for(;k--&&(m=n[k],l=hasOwnProperty.call(b,m)&&c(a[m],b[m],e,f)););}return e.pop(),f.pop(),l},d=function(a){return"function"==typeof a||!1};return c(a,b,[],[])},_offset:function(a){var b,c,d="undefined",e={top:0,left:0},f=a&&a.ownerDocument;return f?(b=f.documentElement,typeof a.getBoundingClientRect!==d&&(e=a.getBoundingClientRect()),c=null!=f&&f===f.window?f:9===f.nodeType&&f.defaultView,{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):void 0}},backgroundColor:function(a){function b(e){return d=e,c=d3.select(e).style("background-color"),"transparent"!==c&&"rgba(0, 0, 0, 0)"!==c?a.k.__proto__._colourBrightness(c,d3.selectAll(e)[0]):void 0!==d3.select(e)[0][0].parentNode.tagName&&"body"!==d3.select(e)[0][0].parentNode.tagName.toLowerCase()?b(d3.select(e)[0][0].parentNode):void a.k.__proto__._colourBrightness("rgb(255,255,255)",d3.select(e)[0])}d3.select(a.selector).style({"background-color":a.background_color,position:"relative"});var c,d;return b(a.selector),a.img=d3.select(d)[0][0].classList.contains("light")?PykCharts.assets+"img/download.png":PykCharts.assets+"img/download-light.png",this},dataSourceFormatIdentification:function(b,c,d){if("object"==typeof b)c.data=b,c[d](c.data);else{var e=b.lastIndexOf("."),f=b.length-e,g=Math.floor(100*Math.random()+1);if(b.constructor==Array)c.data=b,c[d](c.data);else{var h=b.substr(e+1,f);if(-1!=b.indexOf("<root>")){var i,j;window.DOMParser?(parser=new DOMParser,i=parser.parseFromString(b,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(b)),j=a.k.__proto__._xmlToJson(i,0),c[d](j)}else-1!=b.indexOf("{")?(c.data=JSON.parse(b),c[d](c.data)):-1!=b.indexOf(",")?(c.data=d3.csv.parse(b),c[d](c.data)):"json"===h?d3.json(b+"?"+g,c[d]):"csv"===h?d3.csv(b+"?"+g,c[d]):"xml"===h&&d3.xml(b+"?"+g,function(b){var e;e=a.k.__proto__._xmlToJson(b,1),c[d](e)})}}},"export":function(b,c,d,e,f,g){if(PykCharts["boolean"](a.export_enable)){var g=a.chart_width;PykCharts["boolean"](e)&&g&&(g=g);var h="export",i=g,j="none",k=g-16;if(d3.select(a.selector).append("div").style("left",g-80+"px").attr("class","dropdown-multipleConatiner-export"),PykCharts["boolean"](e))for(var l=f.length,m=0;l>m;m++)d3.select(a.selector+" .dropdown-multipleConatiner-export").append("span").attr("id",d+m).on("mouseover",function(){d3.select(this).style("background-color","#E0E0E1")}).on("mouseout",function(){d3.select(this).style("background-color","#fff")}).style({"margin-bottom":"3px",cursor:"pointer"}).html("Panel "+(m+1)+"<br>");else d3.select(a.selector+" .dropdown-multipleConatiner-export").append("span").attr("id","span").on("mouseover",function(){d3.select(this).style("background-color","#E0E0E1")}).on("mouseout",function(){d3.select(this).style("background-color","#fff")}).style({"margin-bottom":"3px",cursor:"pointer"}).html("Export as SVG<br>");PykCharts["boolean"](a.title_text)&&a.title_size&&"default"===a.mode&&(i=.1*g,j="left",k=0);var n=d3.select(b.selector).append("div").attr("id",h).style({width:i+"px",left:k+"px","float":j,"text-align":"right"});setTimeout(function(){n.html("<img title='Export to SVG' src='"+a.img+"' style='left:"+k+"px;margin-bottom:3px;cursor:pointer;'/>")},1e3*a.transition_duration)}return this},exportSVG:function(b,c,d,e,f,g,h){if(PykCharts["boolean"](a.export_enable)){g||(g=0),h||(h=0);var i="export",j=d+"canvas",k=document.createElement("canvas");k.setAttribute("id",j);var l=document.getElementById(j);paper.setup(l);var m=new paper.Project;m._view._viewSize.width=b.chart_width+g,m._view._viewSize.height=b.chart_height+h;var n=d+".svg";if(d3.select(b.selector+" #"+i).on("click",function(){PykCharts.export_menu_status=1,d3.select(a.selector+" .dropdown-multipleConatiner-export").style("visibility","visible")}),PykCharts["boolean"](e))for(var o=f.length,p=0;o>p;p++)d3.selectAll(b.selector+" #"+d+p).on("click",function(){d3.select(a.selector+" .dropdown-multipleConatiner-export").style("visibility","hidden");var e=this.id.substring(this.id.length-1,this.id.length);b.k.processSVG(document.querySelector(a.selector+" #"+c+e),d),m.importSVG(document.querySelector(a.selector+" #"+c+e));var f=m.exportSVG({asString:!0});a.k.__proto__._downloadDataURI({data:"data:image/svg+xml;base64,"+btoa(f),filename:n}),m.clear()});else d3.selectAll(b.selector+" #span").on("click",function(){d3.select(a.selector+" .dropdown-multipleConatiner-export").style("visibility","hidden"),b.k.processSVG(document.querySelector(a.selector+" "+c),d),m.importSVG(document.querySelector(a.selector+" "+c));var e=m.exportSVG({asString:!0});a.k.__proto__._downloadDataURI({data:"data:image/svg+xml;base64,"+btoa(e),filename:n}),m.clear()})}return this},shadeColorConversion:function(b,c){var d,e,f=[],g=150/c;b=d3.rgb(b),e="rgb("+b.r+","+b.g+","+b.b+")",d=a.k.__proto__._colourBrightness(e),inc="light"===d?-1:1;Math.sqrt(b.r*b.r+b.g*b.g)+Math.sqrt(b.r*b.r+b.b*b.b)+Math.sqrt(b.g*b.g+b.b*b.b);for(i=0;Math.abs(i)<c;i+=inc){var h={r:parseInt(b.r+i*g,10),g:parseInt(b.g+i*g,10),b:parseInt(b.b+i*g,10)},j="rgb("+h.r+","+h.g+","+h.b+")";f.push(j)}return-1===inc&&f.reverse(),f},processSVG:function(a){for(var b=a.querySelectorAll("text"),c=b.length,d=0;c>d;d++)if(b[d].hasAttribute("dy")){var e=b[d].getAttribute("dy"),f=e.length;if("em"==e.substring(f-2,f)){var g,h;b[d].hasAttribute("font-size")?(g=b[d].getAttribute("font-size"),h=parseFloat(g)*parseFloat(e)):h=12*parseFloat(e),b[d].setAttribute("dy",h)}}return this},errorHandling:function(b,c){console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+a.selector+'.(Invalid value for attribute "'+b+'")  Visit https://github.com/pykih/PykCharts.js/wiki/Errors#error_'+c)},warningHandling:function(b,c){console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+a.selector+'.(Invalid value for attribute "'+b+'")  Visit https://github.com/pykih/PykCharts.js/wiki/Warnings#warning_'+c)},validator:function(){var b={validatingSelector:function(b){"#"===b.charAt(0)&&(b=b.substring(1,b.length));try{if(!document.getElementById(b))throw a.stop=!0,"selector"}catch(c){a.k.errorHandling(c,"1")}return this},validatingDataType:function(b,c,d,e){try{if(!a.k.__proto__._isNumber(b))throw e?a[e]=d:a[c]=d,c;a[c]=parseFloat(b)}catch(f){a.k.warningHandling(f,"1")}return this},validatingChartMode:function(b,c,d){try{if("default"!==b&&"infographics"!==b)throw a[c]=d,"mode"}catch(e){a.k.warningHandling(e,"2")}return this},validatingAxisDataFormat:function(b,c){if(b)try{if("number"!==b&&"string"!==b&&"time"!==b)throw a.stop=!0,c}catch(d){a.k.errorHandling(d,"9")}return this},validatingColorMode:function(b,c,d,e){if(b)try{if("oneDimensionalCharts"===e){if("color"!==b&&"shade"!==b)throw a[c]=d,"color_mode"}else if("color"!==b&&"saturation"!==b)throw a[c]=d,"color_mode"}catch(f){a.k.warningHandling(f,"3")}return this},validatingYAxisPointerPosition:function(b,c,d){try{if("left"!==b&&"right"!==b)throw a[c]=d,c}catch(e){a.k.warningHandling(e,"7")}return this},validatingXAxisPointerPosition:function(b,c,d){try{if("top"!==b&&"bottom"!==b)throw a[c]=d,c}catch(e){a.k.warningHandling(e,"7")}return this},validatingBorderBetweenChartElementsStyle:function(b,c){try{if("1,3"!==b&&"5,5"!==b&&"0"!==b)throw c}catch(d){a.k.errorHandling(d,"#7")}return this},validatingLegendsPosition:function(b,c,d){try{if("horizontal"!==b&&"vertical"!==b)throw a[c]=d,c}catch(e){a.k.warningHandling(e,"13")}return this},isArray:function(b,c){try{if(b.constructor!==Array)throw c}catch(d){a.stop=!0,a.k.errorHandling(d,"4")}return this},validatingTimeScaleDataType:function(b,c){if(b)try{if("date"!==b&&"year"!==b&&"month"!==b&&"hours"!==b&&"minutes"!==b)throw a.stop=!0,c}catch(d){a.k.errorHandling(d,"5")}return this},validatingTooltipMode:function(b,c,d){if(b)try{if("fixed"!==b&&"moving"!==b)throw a[c]=d,c}catch(e){a.k.warningHandling(e,"14")}return this},validatingFontWeight:function(b,c,d,e){try{if("bold"!==b&&"normal"!==b)throw e?a[e]=d:a[c]=d,c}catch(f){a.k.warningHandling(f,"5")}return this},validatingColor:function(b,c,d,e){if(b)try{var f;if("string"!=typeof b)throw c;if("#"!=b.charAt(0)&&"rgb"!=b.substring(0,3).toLowerCase()&&"transparent"!=b.toLowerCase()){if(f=$c.name2hex(b),"Invalid Color Name"===f)throw c}else if("#"===b.charAt(0)&&(f=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(b),!f))throw c}catch(g){e?a[e]=d:a[c]=d,a.k.warningHandling(g,"4")}return this},validatingDataMode:function(b,c,d){try{if("absolute"!==b&&"percentage"!==b)throw a[c]=d,c}catch(e){a.k.warningHandling(e,"16")}return this},validatingLegendsMode:function(b,c,d){try{if("default"!==b&&"interactive"!==b)throw a[c]=d,c}catch(e){a.k.warningHandling(e,"17")}return this},validatingJSON:function(b){if(!b)try{throw a.stop=!0,"Data is not in the valid JSON format"}catch(c){console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+a.selector+'.("'+c+'")  Visit www.pykcharts.com/errors#error_2')}return a.stop?!1:!0}};return b}});return c};var configuration=PykCharts.Configuration;configuration.mouseEvent=function(a){var b=this;b.tooltip=configuration.tooltipp;var c={tooltipPosition:function(){return PykCharts["boolean"](a.tooltip_enable)||PykCharts["boolean"](a.annotation_enable)||"string"===a.axis_x_data_format||"string"===a.axis_y_data_format?(b.tooltip.style({display:"block",top:PykCharts.getEvent().pageY-20+"px",left:PykCharts.getEvent().pageX+30+"px"}),b.tooltip):void 0},tooltipTextShow:function(c,d,e,f){var g=a.selector.substr(1,a.selector.length);return PykCharts["boolean"](a.tooltip_enable)||PykCharts["boolean"](a.annotation_enable)||"string"===a.axis_x_data_format||"string"===a.axis_y_data_format?("yes"===d&&"multilineChart"===e?d3.selectAll("#tooltip-svg-container-"+f+"-pyk-tooltip"+g).html(c):b.tooltip.html(c),this):void 0},tooltipHide:function(c,d,e){return PykCharts["boolean"](a.tooltip_enable)||PykCharts["boolean"](a.annotation_enable)||"string"===a.axis_x_data_format||"string"===a.axis_y_data_format?"yes"===d&&"multilineChart"===e?d3.selectAll(".pyk-tooltip").style("display","none"):b.tooltip.style("display","none"):void 0},axisHighlightShow:function(b,c,d,e){var f,g,h,i,j,k;if(PykCharts["boolean"](a.axis_onhover_highlight_enable))if(c===a.selector+" .y.axis"&&void 0==e){i=c+" .tick text",h=a.axis_y_pointer_color,j=d3.selectAll(i)[0].length,k=b.length,d3.selectAll(i).style("fill","#bbb").style("font-weight","normal");for(var l=0;j>l;l++)for(var m=0;k>m;m++)d3.selectAll(i)[0][l].__data__===b[m]&&d3.select(d3.selectAll(i)[0][l]).style("fill",h).style("font-weight","bold")}else{c===a.selector+" .x.axis"?(i=c+" .tick text",h=a.axis_x_pointer_color):c===a.selector+" .axis-text"&&"column"===e?(i=c,h=a.axis_x_pointer_color):c===a.selector+" .axis-text"&&"bar"===e?(i=c,h=a.axis_y_pointer_color):c===a.selector+" .y.axis"&&"waterfall"==e?(i=c+" .tick text",h=a.axis_y_pointer_color):c===a.selector+" .y.axis"&&"bar"===e&&(i=c+" .tick text",h=a.axis_x_pointer_color),void 0!==g&&d3.select(d3.selectAll(i)[0][g]).style({fill:h,"font-weight":"normal"}),j=d3.selectAll(i)[0].length;var n=d.length;if("number"===a.axis_x_data_format)for(var f=0;j>f&&d3.selectAll(i)[0][f].__data__!=b;f++);else for(f=0;n>f&&d[f]!==b;f++);g=f,d3.selectAll(i).style("fill","#bbb"),d3.select(d3.selectAll(i)[0][f]).style({fill:h,"font-weight":"bold"})}return this},axisHighlightHide:function(b,c){var d,e,f;return PykCharts["boolean"](a.axis_onhover_highlight_enable)&&(b===a.selector+" .y.axis"?(e=b+" .tick text",d=a.axis_y_pointer_color,f=a.axis_y_pointer_weight):b===a.selector+" .x.axis"?(e=b+" .tick text",d=a.axis_x_pointer_color,f=a.axis_x_pointer_weight):b===a.selector+" .axis-text"&&"column"===c?(e=b,d=a.axis_x_pointer_color,f=a.axis_x_pointer_weight):b===a.selector+" .axis-text"&&"bar"===c&&(e=b,d=a.axis_y_pointer_color,f=a.axis_y_pointer_weight),d3.selectAll(e).style({fill:d,"font-weight":f})),this},highlight:function(a,b,c){var d=d3.select(b);return d3.selectAll(a).attr("fill-opacity",function(a){return a.children&&c?0:.5}),d.attr("fill-opacity",1),this},highlightHide:function(a){return d3.selectAll(a).attr("fill-opacity",function(){return d3.select(this).attr("data-fill-opacity")}),this},highlightGroup:function(a,b,c){var d=d3.select(b),e=d3.selectAll(a);return e.selectAll(c).attr("fill-opacity",.5),d.selectAll(c).attr("fill-opacity",1),this},highlightGroupHide:function(a,b){return d3.selectAll(a+" "+b).attr("fill-opacity",function(){return d3.select(this).attr("data-fill-opacity")}),this}};return c},configuration.fillChart=function(a,b){var c={selectColor:function(c){return b=new PykCharts.Configuration.Theme({}),"color"===a.color_mode?c.name.toLowerCase()===a.highlight.toLowerCase()?a.highlight_color:a.chart_color.length&&a.chart_color[0]?a.chart_color[0]:b.stylesheet.chart_color:c.color},colorChart:function(c){return c.name===a.highlight?b.stylesheet.highlight_color:b.stylesheet.chart_color},colorPieW:function(b){return b.color?b.color:a.chart_color.length?a.color:a.chart_color[0]},colorPieMS:function(b,c){return"lineChart"!==c&&"areaChart"!==c&&b.name.toLowerCase()===a.highlight.toLowerCase()?a.highlight_color:"saturation"===a.color_mode?a.saturation_color:"color"===a.color_mode?b.color:void 0},colorGroup:function(b){return"saturation"===a.color_mode?a.saturation_color:"color"===a.color_mode?b.color:void 0},colorLegends:function(b){return"saturation"===a.color_mode?a.saturation_color:"color"===a.color_mode&&b?b:"color"===a.color_mode?a.chart_color:a.chart_color[0]}};return c},configuration.border=function(a){var b={width:function(){return a.border_between_chart_elements_thickness+"px"},color:function(){return a.border_between_chart_elements_color},style:function(){return a.border_between_chart_elements_style}};return b},configuration.transition=function(a){var b={duration:function(){return"default"===a.mode&&PykCharts["boolean"](a.transition_duration)?1e3*a.transition_duration:0}};return b},configuration.renderBrush=function(a,b,c,d){function e(a){var b=+("e"==a),c=b?1:-1,e=d/3;return"M"+.5*c+","+e+"A6,6 0 0 "+b+" "+6.5*c+","+(e+6)+"V"+(2*e-6)+"A6,6 0 0 "+b+" "+.5*c+","+2*e+"ZM"+2.5*c+","+(e+8)+"V"+(2*e-8)+"M"+4.5*c+","+(e+8)+"V"+(2*e-8)}function f(){return a.brush_extent=d3.event.target.extent(),min=a.brush_extent[0],max=a.brush_extent[1],a.onBrush(b(min),b(max)),console.log(b(min),b(max)),a.brush_extent}a.make_brush=d3.svg.brush().x(b).on("brushend",f);var g=c.append("g").attr("class","brush").call(a.make_brush);g.selectAll("rect").attr("height",d).attr("fill","blue").attr("fill-opacity",.3),g.selectAll(".resize").append("path").attr("d",e).attr("fill","#4C7190").attr("stroke","#4C7190").attr("stroke-width","1.5px")},configuration.Theme=function(){var a=this;return a.stylesheet={mode:"default",selector:"",interactive_enable:"no",click_enable:"no",chart_height:430,chart_width:600,chart_margin_top:35,chart_margin_right:50,chart_margin_bottom:35,chart_margin_left:50,title_text:"",title_size:2,title_color:"#1D1D1D",title_weight:"bold",title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",subtitle_size:1,subtitle_color:"black",subtitle_weight:"normal",subtitle_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",highlight:"",highlight_color:"#08306b",background_color:"transparent",chart_color:["#255AEE"],saturation_color:"#255AEE",border_between_chart_elements_thickness:1,border_between_chart_elements_color:"white",border_between_chart_elements_style:"solid",legends_enable:"yes",legends_display:"horizontal",legends_text_size:11,legends_text_color:"#1D1D1D",legends_text_weight:"normal",legends_text_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",label_size:11,label_color:"white",label_weight:"normal",label_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pointer_overflow_enable:"yes",pointer_thickness:1,pointer_weight:"normal",pointer_size:11,pointer_color:"#1D1D1D",pointer_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",export_enable:"no",color_mode:"color",axis_x_pointer_size:11,axis_x_pointer_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_x_pointer_weight:"normal",axis_x_pointer_color:"#1D1D1D",axis_x_enable:"yes",axis_x_title:"",axis_x_title_size:14,axis_x_title_color:"#1D1D1D",axis_x_title_weight:"bold",axis_x_title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_x_position:"bottom",axis_x_pointer_position:"bottom",axis_x_line_color:"#1D1D1D",axis_x_no_of_axis_value:5,axis_x_pointer_length:5,axis_x_pointer_padding:6,axis_x_pointer_values:[],axis_x_outer_pointer_length:0,axis_x_time_value_datatype:"",axis_x_time_value_interval:0,axisHighlight_x_data_format:"string",loading_source:"<div class='PykCharts-loading'>loading...</div>",loading_type:"css",tooltip_enable:"yes",tooltip_mode:"moving",credit_my_site_name:"PykCharts",credit_my_site_url:"http://www.pykcharts.com/",chart_onhover_highlight_enable:"yes",units_prefix:!1,units_suffix:!1},a.functionality={real_time_charts_refresh_frequency:0,real_time_charts_last_updated_at_enable:"yes",transition_duration:0},a.oneDimensionalCharts={clubdata_enable:"yes",clubdata_text:"Others",clubdata_maximum_nodes:5,shade_color:"#255AEE",pie_radius_percent:70,donut_radius_percent:70,donut_inner_radius_percent:40,donut_show_total_at_center:"yes",donut_show_total_at_center_size:24,donut_show_total_at_center_color:"#1D1D1D",donut_show_total_at_center_weight:"bold",donut_show_total_at_center_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",funnel_rect_width:100,funnel_rect_height:100,percent_column_rect_width:20,percent_row_rect_height:10},a.otherCharts={pictograph_show_all_images:"yes",pictograph_total_count_enable:"yes",pictograph_current_count_enable:"yes",pictograph_image_per_line:3,pictograph_image_width:79,pictograph_image_height:66,pictograph_current_count_size:64,pictograph_current_count_color:"#255aee",pictograph_current_count_weight:"normal",pictograph_current_count_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pictograph_total_count_size:64,pictograph_total_count_color:"grey",pictograph_total_count_weight:"normal",pictograph_total_count_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pictograph_units_per_image_text_size:24,pictograph_units_per_image_text_color:"grey",pictograph_units_per_image_text_weight:"normal",pictograph_units_per_image_text_family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},a.multiDimensionalCharts={chart_grid_x_enable:"yes",chart_grid_y_enable:"yes",chart_grid_color:"#ddd",axis_onhover_highlight_enable:"yes",axis_y_pointer_size:11,axis_y_pointer_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_y_pointer_weight:"normal",axis_y_pointer_color:"#1D1D1D",axis_y_enable:"yes",axis_y_title:"",axis_y_title_size:14,axis_y_title_color:"#1D1D1D",axis_y_title_weight:"bold",axis_y_title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_y_position:"left",axis_y_pointer_position:"left",axis_y_line_color:"#1D1D1D",axis_y_no_of_axis_value:5,axis_y_pointer_length:5,axis_y_pointer_padding:6,axis_y_pointer_values:[],axis_y_outer_pointer_length:0,axis_y_time_value_datatype:"",axis_y_time_value_interval:0,axis_y_data_format:"number",variable_circle_size_enable:"yes",crosshair_enable:"yes",zoom_enable:"no",zoom_level:3,spiderweb_outer_radius_percent:100,scatterplot_radius:20,scatterplot_pointer_enable:"no",curvy_lines_enable:"no",annotation_enable:"no",annotation_view_mode:"onload",annotation_background_color:"#C2CBCF",annotation_font_color:"black",legends_mode:"default",expand_group:"yes",data_mode_enable:"no",data_mode_legends_color:"black",data_mode_default:"percentage",connecting_lines_color:"#ddd",connecting_lines_style:"solid",text_between_steps_color:"#aaa",text_between_steps_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",text_between_steps_size:10,text_between_steps_weight:"normal",data_mode_enable:"no",data_mode_legends_color:"black",data_mode_default:"percentage",connecting_lines_color:"#ddd",connecting_lines_style:"solid",data_sort_enable:"yes",data_sort_type:"alphabetically",data_sort_order:"ascending",calculate_total:"yes",axis_y_background_color:"transparent"},a.treeCharts={zoom_enable:"no",nodeRadius:4.5},a.mapsTheme={total_no_of_colors:3,palette_color:"Blue-1",tooltip_position_top:0,tooltip_position_left:0,timeline_duration:1,timeline_margin_top:5,timeline_margin_right:25,timeline_margin_bottom:25,timeline_margin_left:45,label_enable:"no",click_enable:"yes",chart_onhover_effect:"shadow"},a
},PykCharts.validation={},PykCharts.oneD={},PykCharts.other={},PykCharts.validation.processInputs=function(a,b,c){function d(a){return a.toLowerCase()}function e(a){return a in b}var f=new PykCharts.Configuration.Theme({}),g=f.stylesheet,h=f.functionality,i=f.oneDimensionalCharts,j=f.multiDimensionalCharts,k=f.mapsTheme;a.title_text=b.title_text,a.subtitle_text=b.subtitle_text,b.credit_my_site_name||b.credit_my_site_url?(a.credit_my_site_name=b.credit_my_site_name?b.credit_my_site_name:"",a.credit_my_site_url=b.credit_my_site_url?b.credit_my_site_url:""):(a.credit_my_site_name=g.credit_my_site_name,a.credit_my_site_url=g.credit_my_site_url),a.data_source_name=b.data_source_name?b.data_source_name:"",a.data_source_url=b.data_source_url?b.data_source_url:"",a.default_color=g.chart_color;var l=[{config_name:"selector",default_value:g,validation_type:"validatingSelector",all_charts:!0},{config_name:"chart_color",default_value:g,validation_type:"isArray",all_charts:!0},{config_name:"axis_x_pointer_values",default_value:g,validation_type:"isArray",maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_values",default_value:j,validation_type:"isArray",multiDimensionalCharts:!0},{config_name:"mode",default_value:g,validation_type:"validatingChartMode",condition2:d,oneDimensionalCharts:!0,multiDimensionalCharts:!0,other:!0},{config_name:"chart_width",default_value:g,validation_type:"validatingDataType",all_charts:!0},{config_name:"title_size",default_value:g,validation_type:"validatingDataType",all_charts:!0},{config_name:"subtitle_size",default_value:g,validation_type:"validatingDataType",condition1:e,all_charts:!0},{config_name:"border_between_chart_elements_thickness",default_value:g,validation_type:"validatingDataType",condition1:e,all_charts:!0},{config_name:"label_size",default_value:g,validation_type:"validatingDataType",condition1:e,all_charts:!0},{config_name:"pointer_thickness",default_value:g,validation_type:"validatingDataType",condition1:e,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"pointer_size",default_value:g,validation_type:"validatingDataType",condition1:e,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"axis_x_title_size",default_value:g,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"axis_y_title_size",default_value:j,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"legends_text_size",default_value:g,validation_type:"validatingDataType",condition1:e,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_size",default_value:g,validation_type:"validatingDataType",condition1:e,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_size",default_value:j,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_length",default_value:g,validation_type:"validatingDataType",condition1:e,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_length",default_value:j,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"axis_x_outer_pointer_length",default_value:g,validation_type:"validatingDataType",condition1:e,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_outer_pointer_length",default_value:j,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"real_time_charts_refresh_frequency",default_value:h,validation_type:"validatingDataType",all_charts:!0},{config_name:"transition_duration",default_value:h,validation_type:"validatingDataType",oneDimensionalCharts:!0,multiDimensionalCharts:!0,other:!0},{config_name:"clubdata_maximum_nodes",default_value:i,validation_type:"validatingDataType",oneDimensionalCharts:!0},{config_name:"title_weight",default_value:g,validation_type:"validatingFontWeight",condition2:d,all_charts:!0},{config_name:"subtitle_weight",default_value:g,validation_type:"validatingFontWeight",condition2:d,all_charts:!0},{config_name:"pointer_weight",default_value:g,validation_type:"validatingFontWeight",condition2:d,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"label_weight",default_value:g,validation_type:"validatingFontWeight",condition2:d,all_charts:!0},{config_name:"background_color",default_value:g,validation_type:"validatingColor",all_charts:!0},{config_name:"shade_color",default_value:i,validation_type:"validatingColor",oneDimensionalCharts:!0},{config_name:"title_color",default_value:g,validation_type:"validatingColor",all_charts:!0},{config_name:"subtitle_color",default_value:g,validation_type:"validatingColor",all_charts:!0},{config_name:"highlight_color",default_value:g,validation_type:"validatingColor",all_charts:!0},{config_name:"label_color",default_value:g,validation_type:"validatingColor",all_charts:!0},{config_name:"pointer_color",default_value:g,validation_type:"validatingColor",oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"border_between_chart_elements_color",default_value:g,validation_type:"validatingColor",all_charts:!0},{config_name:"axis_x_time_value_datatype",default_value:g,validation_type:"validatingTimeScaleDataType",multiDimensionalCharts:!0},{config_name:"axis_y_time_value_datatype",default_value:j,validation_type:"validatingTimeScaleDataType",multiDimensionalCharts:!0},{config_name:"chart_height",default_value:g,validation_type:"validatingDataType",multiDimensionalCharts:!0,maps:!0},{config_name:"chart_margin_left",default_value:g,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"chart_margin_right",default_value:g,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"chart_margin_top",default_value:g,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"chart_margin_bottom",default_value:g,validation_type:"validatingDataType",condition1:e,multiDimensionalCharts:!0},{config_name:"zoom_level",default_value:j,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_x_pointer_padding",default_value:g,validation_type:"validatingDataType",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_pointer_padding",default_value:j,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_x_no_of_axis_value",default_value:g,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_y_no_of_axis_value",default_value:j,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_x_time_value_interval",default_value:g,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_y_time_value_interval",default_value:j,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"legends_text_color",default_value:g,validation_type:"validatingColor",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_x_pointer_color",default_value:g,validation_type:"validatingColor",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_pointer_color",default_value:j,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"axis_x_title_color",default_value:g,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"axis_y_title_color",default_value:j,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"axis_x_line_color",default_value:g,validation_type:"validatingColor",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_line_color",default_value:j,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"annotation_font_color",default_value:j,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"annotation_background_color",default_value:j,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"chart_grid_color",default_value:j,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"legends_display",default_value:g,validation_type:"validatingLegendsPosition",multiDimensionalCharts:!0,maps:!0},{config_name:"tooltip_mode",default_value:g,validation_type:"validatingTooltipMode",multiDimensionalCharts:!0,maps:!0},{config_name:"legends_text_weight",default_value:g,validation_type:"validatingFontWeight",condition2:d,multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_pointer_weight",default_value:j,validation_type:"validatingFontWeight",condition2:d,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_weight",default_value:g,validation_type:"validatingFontWeight",condition2:d,multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_title_weight",default_value:j,validation_type:"validatingFontWeight",condition2:d,multiDimensionalCharts:!0},{config_name:"axis_x_title_weight",default_value:g,validation_type:"validatingFontWeight",condition2:d,multiDimensionalCharts:!0},{config_name:"axis_y_position",default_value:j,validation_type:"validatingYAxisPointerPosition",multiDimensionalCharts:!0},{config_name:"axis_x_position",default_value:g,validation_type:"validatingXAxisPointerPosition",condition2:d,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_position",default_value:j,validation_type:"validatingYAxisPointerPosition",condition2:d,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_position",default_value:g,validation_type:"validatingXAxisPointerPosition",condition2:d,multiDimensionalCharts:!0},{config_name:"color_mode",default_value:g,validation_type:"validatingColorMode",condition2:d,multiDimensionalCharts:!0},{config_name:"border_between_chart_elements_style",default_value:g,condition2:d,all_charts:!0},{config_name:"clubdata_text",default_value:i,oneDimensionalCharts:!0},{config_name:"saturation_color",default_value:g,multiDimensionalCharts:!0,maps:!0},{config_name:"timeline_duration",default_value:k,maps:!0,condition1:e}];a.k=new PykCharts.Configuration(a);for(var m=a.k.validator(),n=0,o=l.length;o>n;n++){var p=l[n];if(p[c]||p.all_charts){var q=p.config_name,r=p.default_value[q],s=p.condition1?p.condition1(q):b[q];if(q in b)var t=p.condition2?p.condition2(b[q]):b[q];a[q]=s?t:r,p.validation_type&&m[p.validation_type](a[q],q,r)}}"maps"===c&&(a.axis_x_pointer_position=b.axis_x_pointer_position?b.axis_x_pointer_position:"top",m.validatingXAxisPointerPosition(a.axis_x_pointer_position,"axis_x_pointer_position","top")),"oneDimensionalCharts"===c?(a.color_mode=b.color_mode?b.color_mode:"shade",m.validatingColorMode(a.color_mode,"color_mode","shade",c)):"maps"===c&&(a.color_mode=b.color_mode?b.color_mode:"saturation",m.validatingColorMode(a.color_mode,"color_mode","saturation",c));for(var u=[{config_name:"interactive_enable",default_value:g,all_charts:!0},{config_name:"click_enable",default_value:g,all_charts:!0},{config_name:"tooltip_enable",default_value:g,all_charts:!0},{config_name:"export_enable",default_value:g,all_charts:!0},{config_name:"real_time_charts_last_updated_at_enable",default_value:h,all_charts:!0},{config_name:"clubdata_enable",default_value:i,oneDimensionalCharts:!0},{config_name:"pointer_overflow_enable",default_value:g,oneDimensionalCharts:!0},{config_name:"chart_onhover_highlight_enable",default_value:g,all_charts:!0},{config_name:"chart_grid_x_enable",default_value:j,multiDimensionalCharts:!0},{config_name:"chart_grid_y_enable",default_value:j,multiDimensionalCharts:!0},{config_name:"axis_x_enable",default_value:g,multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_enable",default_value:j,multiDimensionalCharts:!0},{config_name:"axis_onhover_highlight_enable",default_value:j,multiDimensionalCharts:!0},{config_name:"zoom_enable",default_value:j,multiDimensionalCharts:!0},{config_name:"annotation_enable",default_value:j,multiDimensionalCharts:!0},{config_name:"legends_enable",default_value:g,multiDimensionalCharts:!0,maps:!0},{config_name:"variable_circle_size_enable",default_value:j,multiDimensionalCharts:!0},{config_name:"title_family",default_value:g,all_charts:!0},{config_name:"subtitle_family",default_value:g,all_charts:!0},{config_name:"pointer_family",default_value:g,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"title_family",default_value:g,all_charts:!0},{config_name:"label_family",default_value:g,all_charts:!0},{config_name:"units_suffix",default_value:g,oneDimensionalCharts:!0},{config_name:"units_prefix",default_value:g,oneDimensionalCharts:!0},{config_name:"highlight",default_value:g,all_charts:!0},{config_name:"axis_x_title_family",default_value:g,multiDimensionalCharts:!0},{config_name:"axis_y_title_family",default_value:j,multiDimensionalCharts:!0},{config_name:"legends_text_family",default_value:g,multiDimensionalCharts:!0},{config_name:"axis_x_title",default_value:g,multiDimensionalCharts:!0},{config_name:"axis_y_title",default_value:g,multiDimensionalCharts:!0},{config_name:"map_code",default_value:k,maps:!0},{config_name:"click_enable",default_value:k,maps:!0},{config_name:"annotation_view_mode",default_value:j,multiDimensionalCharts:!0},{config_name:"loading_type",default_value:g,all_charts:!0},{config_name:"loading_source",default_value:g,all_charts:!0}],n=0,v=u.length;v>n;n++){var p=u[n];if(p[c]||p.all_charts){var q=p.config_name,r=p.default_value[q];a[q]=b[q]?b[q]:r}}switch(a.clubdata_always_include_data_points=PykCharts["boolean"](a.clubdata_enable)&&b.clubdata_always_include_data_points?b.clubdata_always_include_data_points:[],m.isArray(a.clubdata_always_include_data_points,"clubdata_always_include_data_points"),a.border_between_chart_elements_style){case"dotted":a.border_between_chart_elements_style="1,3";break;case"dashed":a.border_between_chart_elements_style="5,5";break;default:a.border_between_chart_elements_style="0"}if("oneDimensionalCharts"===c||"maps"===c)a.chart_color[0]&&a.k.validator().validatingColor(a.chart_color[0],"chart_color",g.chart_color);else for(var n=0;n<a.chart_color.length;n++)a.chart_color[n]&&a.k.validator().validatingColor(a.chart_color[n],"chart_color",g.chart_color);return a.k=new PykCharts.Configuration(a),a},PykCharts.oneD.bubble=function(a){var b=this;b.interval="";new PykCharts.Configuration.Theme({});this.execute=function(c){b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),b.chart_height=a.chart_height?a.chart_height:b.chart_width,b.k.validator().validatingDataType(b.chart_height,"chart_height",b.chart_width),b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("oned",a),b.compare_data=b.k.__proto__._groupBy("oned",a),b.k.remove_loading_bar(d),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",void b.render())},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("oned",a),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.refresh_data=b.k.__proto__._groupBy("oned",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data),d=[];b.compare_data=c[0];var e=c[1];e&&b.k.lastUpdatedAt("liveData"),b.new_data=b.optionalFeatures().clubData(),"shade"===b.color_mode&&(d=b.k.shadeColorConversion(b.shade_color,b.new_data.children.length),d.reverse(),b.new_data.children.forEach(function(a,b){a.color=d[b]})),b.optionalFeatures().createChart().label()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){var a=b.selector.substring(1,b.selector.length),c=a+"_svg",d=[];b.fillChart=new PykCharts.Configuration.fillChart(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#"+c,"bubble").emptyDiv(b.selector).subtitle(),b.new_data=b.optionalFeatures().clubData(),"shade"===b.color_mode&&(d=b.k.shadeColorConversion(b.shade_color,b.new_data.children.length),d.reverse(),b.new_data.children.forEach(function(a,b){a.color=d[b]})),b.optionalFeatures().svgContainer(c).createChart().label(),b.k.createFooter().lastUpdatedAt().credits().dataSource().liveData(b).tooltip()):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+c,"bubble").emptyDiv(b.selector),b.new_data={children:b.data},"shade"===b.color_mode&&(d=b.k.shadeColorConversion(b.shade_color,b.new_data.children.length),d.reverse(),b.new_data.children.forEach(function(a,b){a.color=d[b]})),b.optionalFeatures().svgContainer(c).createChart().label(),b.k.tooltip()),b.k.exportSVG(b,"#"+c,"bubble"),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b);var e=b.k.resize(b.svgContainer);b.k.__proto__._ready(e),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var c={svgContainer:function(a){return b.svgContainer=d3.select(b.selector).append("svg").attr({"class":"svgcontainer PykCharts-oneD",id:a,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height,width:b.chart_width,height:b.chart_height}),b.group=b.svgContainer.append("g").attr("id","bubgrp"),this},createChart:function(){var a=d3.layout.pack().sort(function(a,b){return b.weight-a.weight}).size([b.chart_width,b.chart_height]).value(function(a){return a.weight}).padding(20);b.sum=d3.sum(b.new_data.children,function(a){return a.weight});b.new_data.children.length;b.node=a.nodes(b.new_data);var c=b.group.selectAll(".bubble-node").data(b.node);return c.enter().append("g").attr("class","bubble-node").append("circle"),c.attr("class","bubble-node").select("circle").attr({"class":"bubble",id:function(a,b){return"bubble"+b},x:function(a){return a.x},y:function(a){return a.y},r:0,transform:function(a){return"translate("+a.x+","+a.y+")"},fill:function(a){return a.children?b.background_color:b.fillChart.selectColor(a)},"fill-opacity":function(a){return a.children?0:1},"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(a){return a.name}}).on({mouseover:function(a){a.children||"default"!==b.mode||(PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlight(b.selector+" .bubble",this,!0),a.tooltip=a.tooltip||"<table><thead><th colspan='2' class='tooltip-heading'>"+a.name+"</th></thead><tr><td class='tooltip-left-content'>"+b.k.appendUnits(a.weight)+"  <td class='tooltip-right-content'>("+(100*a.weight/b.sum).toFixed(1)+"%)</tr></table>",b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.tooltip))},mouseout:function(a){"default"===b.mode&&(b.mouseEvent.tooltipHide(a),PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlightHide(b.selector+" .bubble"))},mousemove:function(a){a.children||"default"!==b.mode||b.mouseEvent.tooltipPosition(a)},click:function(a){PykCharts["boolean"](b.click_enable)&&b.addEvents(a.name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr("r",function(a){return a.r}),c.exit().remove(),this},label:function(){function c(){e.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<1.7*a.r&&this.getBBox().height<2*a.r?a.children?" ":a.name:""})}function d(){f.text(function(a){return a.children?" ":b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<2*a.r*.55&&this.getBBox().height<2*a.r*.55?a.children?" ":(100*a.weight/b.sum).toFixed(1)+"%":""})}var e=b.group.selectAll(".name").data(b.node),f=b.group.selectAll(".weight").data(b.node);return e.enter().append("svg:text").attr("class","name"),f.enter().append("svg:text").attr("class","weight"),e.attr("class","name").attr({x:function(a){return a.x},y:function(a){return a.y-5}}),f.attr("class","weight").attr({x:function(a){return a.x},y:function(a){return+a.y+b.label_size}}),e.attr("text-anchor","middle").attr("fill",function(c){if("shade"===b.color_mode&&!c.children&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color}).style({"font-weight":b.label_weight,"font-size":b.label_size+"px","font-family":b.label_family}).text(""),setTimeout(c,b.transitions.duration()),f.attr({"text-anchor":"middle",fill:function(c){if("shade"===b.color_mode&&!c.children&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color},"pointer-events":"none"}).style({"font-family":b.label_family,"font-weight":b.label_weight,"font-size":b.label_size+"px"}).text(""),setTimeout(d,b.transitions.duration()),e.exit().remove(),f.exit().remove(),this},clubData:function(){var a,c=b.data.length;if(PykCharts["boolean"](b.clubdata_enable)){var d,e,f=[],g=0,h=[];if(c<=b.clubdata_maximum_nodes)return a={children:b.data};if(0!==b.clubdata_always_include_data_points.length){var i=b.clubdata_always_include_data_points.length;for(e=0;i>e;e++)f[e]=b.clubdata_always_include_data_points[e]}for(e=0;e<f.length;e++)for(d=0;c>d;d++)f[e].toUpperCase()===b.data[d].name.toUpperCase()&&h.push(b.data[d]);for(b.data.sort(function(a,b){return b.weight-a.weight});h.length<b.clubdata_maximum_nodes-1;){for(e=0;e<f.length;e++)b.data[g].name.toUpperCase()===f[e].toUpperCase()&&g++;h.push(b.data[g]),g++}var j=0;for(d=g;c>d;d++){for(e=0;e<h.length&&d<b.data.length;e++)b.data[d].name.toUpperCase()===h[e].name.toUpperCase()&&(j+=0,d++,e=-1);d<b.data.length&&(j+=b.data[d].weight)}for(var k=function(a,b){return b.weight-a.weight};h.length>b.clubdata_maximum_nodes;){h.sort(k);{h.pop()}}var l={name:b.clubdata_text,weight:j,color:b.clubData_color,tooltip:b.clubData_tooltipText,highlight:!1};h.length<b.clubdata_maximum_nodes&&h.push(l),h.sort(function(a,b){return a.weight-b.weight}),a={children:h},b.map1=a.children.map(function(a){return a.weight})}else b.data.sort(function(a,b){return a.weight-b.weight}),a={children:b.data};return a}};return c}},PykCharts.oneD.funnel=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),b.chart_height=a.chart_height?a.chart_height:b.chart_width;var e=(a.optional,c.oneDimensionalCharts);b.funnel_rect_width=a.funnel_rect_width?a.funnel_rect_width:e.funnel_rect_width,b.funnel_rect_height=a.funnel_rect_height?a.funnel_rect_height:e.funnel_rect_height,b.k.validator().validatingDataType(b.chart_height,"chart_height",b.chart_width).validatingDataType(b.funnel_rect_width,"funnel_rect_width",e.funnel_rect_width).validatingDataType(b.funnel_rect_height,"funnel_rect_height",e.funnel_rect_height);try{if(b.funnel_rect_width>=b.chart_width)throw"funnel_rect_width"}catch(f){b.funnel_rect_width=e.funnel_rect_width,console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.(Invalid value for attribute "funnel_rect_width")  Visit www.pykcharts.com/errors#warning_19')}b.stop||(b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("oned",a),b.compare_data=b.k.__proto__._groupBy("oned",a),b.k.remove_loading_bar(d),void b.render())},PykCharts["boolean"](a.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("oned",a),b.refresh_data=b.k.__proto__._groupBy("oned",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](a.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){var a=this,b=a.selector.substring(1,a.selector.length),c=b+"_svg";a.fillChart=new PykCharts.Configuration.fillChart(a),a.transitions=new PykCharts.Configuration.transition(a),"default"===a.mode&&a.k.title().backgroundColor(a).export(a,"#"+c,"funnel").emptyDiv(a.selector).subtitle(),a.k.tooltip(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a),"infographics"===a.mode&&(a.k.backgroundColor(a).export(a,"#"+c,"funnel").emptyDiv(a.selector),a.new_data=a.data),"default"===a.mode&&a.optionalFeatures(),a.optionalFeatures().svgContainer(c).createChart().label().ticks(),"default"===a.mode&&a.k.liveData(a).createFooter().lastUpdatedAt().credits().dataSource();var d=0;setTimeout(function(){a.ticks_text_width.length&&(d=d3.max(a.ticks_text_width,function(a){return a})),a.k.exportSVG(a,"#"+c,"funnel",void 0,void 0,d)},a.transitions.duration());var e=a.k.resize(a.svgContainer);a.k.__proto__._ready(e),window.addEventListener("resize",function(){return a.k.resize(a.svgContainer)})},this.funnelLayout=function(){var a,b,c,d=this,e={data:function(b){return 0===b.length||(a=b),this},size:function(a){return 2!==a.length||(b=a),this},mouth:function(a){return 2!==a.length||(c=a),this},coordinates:function(){for(var e=b[0],f=b[1],g=c[0],h=c[1],i=(e-g)/2,j=f-h,k=0,l=0,m=0,n=0,o=[],p=i/j,q=(e+g)/2*j,r=g*h,s=q+r,t=r/s*100,u=a.length-1;u>=0;u--){var v=d.percentageValues(a)[u];if(t>=v)m=v/t*h,k=f-m,o[u]=u===a.length-1?{values:[{x:(e-g)/2,y:k},{x:(e-g)/2,y:f},{x:(e-g)/2+g,y:f},{x:(e-g)/2+g,y:k}]}:{values:[{x:(e-g)/2,y:k},o[u+1].values[0],o[u+1].values[3],{x:(e-g)/2+g,y:k}]};else{var w=v/100*s-r,x=2*p,y=2*g,z=2*w;l=(-y+Math.sqrt(Math.pow(y,2)-4*x*-z))/(2*x),k=f-l-h;var A=2*p*l+g,B=(e-A)/2;if(0===n)o[u]=u===a.length-1?{values:[{x:B,y:k},{x:(e-g)/2,y:j},{x:(e-g)/2,y:f},{x:(e-g)/2+g,y:f},{x:(e-g)/2+g,y:j},{x:A+B,y:k}]}:{values:[{x:B,y:k},{x:(e-g)/2,y:j},o[u+1].values[0],o[u+1].values[3],{x:(e-g)/2+g,y:j},{x:A+B,y:k}]};else{var C;C=6===o[u+1].values.length?5:3,o[u]={values:[{x:B,y:k},o[u+1].values[0],o[u+1].values[C],{x:A+B,y:k}]}}n=1}}return o}};return e},this.percentageValues=function(a){var b=a.map(function(b){var c=d3.max(a,function(a){return a.weight});return b.weight/c*100});return b.sort(function(a,b){return b-a}),b},this.optionalFeatures=function(){var c={svgContainer:function(c){return b.svgContainer=d3.select(a.selector).append("svg").attr({width:b.chart_width+"px",height:b.chart_height+"px",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height,id:c,"class":"svgcontainer PykCharts-oneD"}),b.group=b.svgContainer.append("g").attr("id","funnel"),this},createChart:function(){var c=new PykCharts.Configuration.border(b);b.new_data=b.data.sort(function(a,b){return b.weight-a.weight}),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.length),b.new_data.forEach(function(a,b){a.color=shade_array[b]})),b.per_values=b.percentageValues(b.new_data),b.funnel=b.funnelLayout().data(b.new_data).size([b.chart_width,b.chart_height]).mouth([b.funnel_rect_width,b.funnel_rect_height]),b.coordinates=b.funnel.coordinates();var d=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});b.chart_data=b.group.selectAll(".fun-path").data(b.coordinates);var e=[{x:0,y:0},{x:b.chart_width,y:0},{x:0,y:0},{x:b.chart_width,y:0},{x:0,y:0},{x:b.chart_width,y:0}];return b.chart_data.enter().append("path").attr("class","fun-path"),b.chart_data.attr({"class":"fun-path",d:function(){return d(e)},fill:function(a,c){return a.color=b.new_data[c].color,b.fillChart.selectColor(b.new_data[c])},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:c.color(),"stroke-width":c.width(),"stroke-dasharray":c.style(),"stroke-opacity":1,"data-id":function(a,c){return b.new_data[c].name}}).on({mouseover:function(c,d){"default"===b.mode&&(PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlight(a.selector+" .fun-path",this),tooltip=b.data[d].tooltip||"<table><tr><th colspan='2' class='tooltip-heading'>"+b.new_data[d].name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(b.new_data[d].weight)+"<td class='tooltip-right-content'>("+b.per_values[d].toFixed(1)+"%) </tr></table>",b.mouseEvent.tooltipPosition(c),b.mouseEvent.tooltipTextShow(tooltip))},mouseout:function(c){"default"===b.mode&&(PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlightHide(a.selector+" .fun-path"),b.mouseEvent.tooltipHide(c))},mousemove:function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)},click:function(c,d){PykCharts["boolean"](a.click_enable)&&b.addEvents(b.new_data[d].name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr("d",function(a){return d(a.values)}),b.chart_data.exit().remove(),this},label:function(){function c(){b.chart_text.text(function(a,c){return b.per_values[c].toFixed(1)+"%"}).attr({"text-anchor":"middle","pointer-events":"none",fill:function(c){if("shade"===b.color_mode&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color}}).style({"font-weight":b.label_weight,"font-size":b.label_size+"px","font-family":b.label_family}).text(function(a,c){return this.getBBox().width<a.values[3].x-a.values[1].x&&this.getBBox().height<a.values[2].y-a.values[0].y?b.per_values[c].toFixed(1)+"%":""})}return b.chart_text=b.group.selectAll("text").data(b.coordinates),b.chart_text.enter().append("text"),b.chart_text.attr({y:function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+5:(a.values[0].y-a.values[2].y)/2+a.values[2].y+5},x:function(){return b.chart_width/2}}),b.chart_text.text(""),setTimeout(c,b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){function a(){e.text(function(a,c){return b.data[c].name}).text(function(a,c){return d[c]=this.getBBox().height,b.ticks_text_width.push(this.getBBox().width),this.getBBox().height<a.values[2].y-a.values[0].y?b.data[c].name:""}).style({"font-size":b.pointer_size+"px","text-anchor":"start",fill:b.pointer_color,"pointer-events":"none","font-family":b.pointer_family,"font-weight":b.pointer_weight})}function c(){h.attr("x2",function(a,b){return a.values[2].y-a.values[0].y>d[b]?4===a.values.length?(a.values[3].x+a.values[2].x)/2+12:a.values[4].x+12:4===a.values.length?(a.values[3].x+a.values[2].x)/2:a.values[4].x})}PykCharts["boolean"](b.pointer_overflow_enable)&&b.svgContainer.style("overflow","visible");var d=[];b.ticks_text_width=[];var e=b.group.selectAll(".ticks_label").data(b.coordinates);e.attr("class","ticks_label"),e.enter().append("text").attr({x:0,y:0});var f,g;e.attr("transform",function(a){return 4===a.values.length?(f=(a.values[3].x+a.values[2].x)/2+17,g=(a.values[0].y+a.values[2].y)/2+5):(f=a.values[4].x+17,g=a.values[4].y+5),"translate("+f+","+g+")"}),e.text(""),setTimeout(a,b.transitions.duration()),e.exit().remove();var h=b.group.selectAll(".funnel-ticks").data(b.coordinates);return h.enter().append("line").attr("class","funnel-ticks"),h.attr({x1:function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:a.values[4].x},y1:function(a){return 4===a.values.length?(a.values[0].y+a.values[2].y)/2:a.values[4].y},x2:function(a){return 4===a.values.length?(a.values[3].x+a.values[2].x)/2:a.values[4].x},y2:function(a){return 4===a.values.length?(a.values[0].y+a.values[2].y)/2:a.values[4].y},"stroke-width":b.pointer_thickness+"px",stroke:b.pointer_color}),setTimeout(c,b.transitions.duration()),h.exit().remove(),this}};return c}},PykCharts.oneD.percentageColumn=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(b){var d=this;d=new PykCharts.validation.processInputs(d,a,"oneDimensionalCharts"),d.chart_height=PykCharts["boolean"](a.chart_height)?a.chart_height:d.chart_width,d.percent_column_rect_width=a.percent_column_rect_width?a.percent_column_rect_width:c.oneDimensionalCharts.percent_column_rect_width,d.k.validator().validatingDataType(d.chart_height,"chart_height",d.chart_width).validatingDataType(d.percent_column_rect_width,"percent_column_rect_width",c.oneDimensionalCharts.percent_column_rect_width),d.stop||(d.k.storeInitialDivHeight(),d.percent_column_rect_width>100&&(d.percent_column_rect_width=100),d.percent_column_rect_width=2*d.k.__proto__._radiusCalculation(d.percent_column_rect_width,"percentageBar"),"default"===d.mode&&d.k.loading(),d.executeData=function(a){var b=d.k.validator().validatingJSON(a),c=d.selector.substring(1,d.selector.length);
return d.stop||b===!1?void d.k.remove_loading_bar(c):(d.data=d.k.__proto__._groupBy("oned",a),d.compare_data=d.k.__proto__._groupBy("oned",a),d.k.remove_loading_bar(c),d.clubdata_enable=d.data.length>d.clubdata_maximum_nodes?d.clubdata_enable:"no",void d.render())},PykCharts["boolean"](d.interactive_enable)?(d.k.dataFromPykQuery(b),d.k.dataSourceFormatIdentification(d.data,d,"executeData")):d.k.dataSourceFormatIdentification(a.data,d,"executeData"))},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("oned",a),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.refresh_data=b.k.__proto__._groupBy("oned",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData(),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.length),b.new_data.forEach(function(a,b){a.color=shade_array[b]})),b.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){var b=this,c=b.selector.substring(1,b.selector.length),d=c+"_svg";b.fillChart=new PykCharts.Configuration.fillChart(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode&&b.k.title().backgroundColor(b).export(b,"#"+d,"percentageColumn").emptyDiv(b.selector).subtitle(),"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+d,"percentageColumn").emptyDiv(b.selector),b.new_data=b.data),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"default"===b.mode&&(percent_column=b.optionalFeatures().clubData()),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.length),b.new_data.forEach(function(a,b){a.color=shade_array[b]})),b.optionalFeatures().svgContainer(d).createChart().label().ticks(),"default"===b.mode&&b.k.liveData(b).createFooter().lastUpdatedAt().credits().dataSource();var e=0;setTimeout(function(){b.ticks_text_width.length&&(e=d3.max(b.ticks_text_width,function(a){return a})),b.k.exportSVG(b,"#"+d,"percentageColumn",void 0,void 0,e+15),PykCharts["boolean"](a.chart_width)||(b.chart_width=b.percent_column_rect_width+10+e,b.svgContainer.attr("viewBox","0 0 "+b.chart_width+" "+b.chart_height));var c=b.k.resize(b.svgContainer);b.k.__proto__._ready(c)},b.transitions.duration()),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var c={createChart:function(){var a=new PykCharts.Configuration.border(b),c=b.new_data.map(function(a){return a.weight});c.sum=function(){for(var a=0,b=0;b<this.length;++b)a+=this[b];return a};var d=c.sum();return b.new_data.forEach(function(a,b){this[b].percentValue=100*a.weight/d},b.new_data),b.chart_data=b.group.selectAll(".per-rect").data(b.new_data),b.chart_data.enter().append("rect").attr("class","per-rect"),b.chart_data.attr({x:0,y:function(a,c){if(0===c)return 0;var d=0,e=b.new_data.slice(0,c);return e.forEach(function(a,b){d+=this[b].percentValue},e),d*b.chart_height/100},width:b.percent_column_rect_width,height:0,fill:function(a){return b.fillChart.selectColor(a)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:a.color(),"stroke-width":a.width(),"stroke-dasharray":a.style(),"data-id":function(a){return a.name}}).on({mouseover:function(a){"default"===b.mode&&(a.tooltip=a.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+a.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(a.weight)+"<td class='tooltip-right-content'>("+a.percentValue.toFixed(1)+"%)</tr></table>",PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlight(b.selector+" .per-rect",this),b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.tooltip))},mouseout:function(a){"default"===b.mode&&(PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlightHide(b.selector+" .per-rect"),b.mouseEvent.tooltipHide(a))},mousemove:function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)},click:function(a){PykCharts["boolean"](b.click_enable)&&b.addEvents(a.name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.percentValue*b.chart_height/100}),b.chart_data.exit().remove(),this},svgContainer:function(a){return b.svgContainer=d3.select(b.selector).append("svg").attr({width:b.chart_width,height:b.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height,id:a,"class":"svgcontainer PykCharts-oneD"}),b.group=b.svgContainer.append("g").attr("id","percentageColumn"),this},label:function(){function c(){b.chart_text.text(function(a){return a.percentValue.toFixed(1)+"%"}).text(function(a){return this.getBBox().width<.92*b.percent_column_rect_width&&this.getBBox().height<a.percentValue*b.chart_height/100?a.percentValue.toFixed(1)+"%":""})}b.chart_text=b.group.selectAll(".per-text").data(b.new_data);var d=0;return b.chart_text.enter().append("text").attr("class","per-text"),b.chart_text.attr({"class":"per-text",x:b.percent_column_rect_width/2,y:function(a,c){return d+=a.percentValue,0===c?(0+d*b.chart_height/100)/2+5:((d-a.percentValue)*b.chart_height/100+d*b.chart_height/100)/2+5}}),d=0,b.chart_text.text("").attr({fill:function(c){if("shade"===b.color_mode&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color},"text-anchor":"middle","pointer-events":"none"}).style({"font-size":b.label_size+"px","font-weight":b.label_weight,"font-family":b.label_family}),setTimeout(c,b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){function a(){i.text(function(a){return a.name}).text(function(a,c){return g[c]=this.getBBox().height,b.ticks_text_width[c]=this.getBBox().width,this.getBBox().height<a.percentValue*b.chart_height/100?a.name:""}),e=0,h.attr({x1:function(){return b.percent_column_rect_width},y1:function(a,c){return e+=a.percentValue,0===c?(0+e*b.chart_height/100)/2:((e-a.percentValue)*b.chart_height/100+e*b.chart_height/100)/2},x2:function(){return b.percent_column_rect_width},y2:function(a,c){return f+=a.percentValue,0===c?(0+f*b.chart_height/100)/2:((f-a.percentValue)*b.chart_height/100+f*b.chart_height/100)/2},"stroke-width":b.pointer_thickness+"px",stroke:b.pointer_color,x2:function(a,c){return a.percentValue*b.chart_height/100>g[c]?b.percent_column_rect_width+10:b.percent_column_rect_width}})}PykCharts["boolean"](b.pointer_overflow_enable)&&b.svgContainer.style("overflow","visible");var c,d,e=0,f=0,g=[];e=0,b.ticks_text_width=[];var h=b.group.selectAll(".per-ticks").data(b.new_data);h.enter().append("line").attr("class","per-ticks");var i=b.group.selectAll(".ticks_label").data(b.new_data);return i.enter().append("text").attr("class","ticks_label"),i.attr("class","ticks_label").attr("transform",function(a){return e+=a.percentValue,c=b.percent_column_rect_width+15,d=((e-a.percentValue)*b.chart_height/100+e*b.chart_height/100)/2+5,"translate("+c+","+d+")"}),i.text(function(){return""}).attr({"font-size":b.pointer_size,"text-anchor":"start",fill:b.pointer_color,"font-family":b.pointer_family,"font-weight":b.pointer_weight,"pointer-events":"none"}),setTimeout(a,b.transitions.duration()),i.exit().remove(),h.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](b.clubdata_enable)){var a=[];if(0!==b.clubdata_always_include_data_points.length){var c=b.clubdata_always_include_data_points.length;for(i=0;c>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubdata_maximum_nodes;){d.sort(g);{d.pop()}}var h={name:b.clubdata_text,weight:f,tooltip:b.clubdata_tooltip};d.sort(function(a,b){return b.weight-a.weight}),d.length<b.clubdata_maximum_nodes&&d.push(h),b.new_data=d}else b.data.sort(function(a,b){return b.weight-a.weight}),b.new_data=b.data;return this}};return c}},PykCharts.oneD.percentageBar=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(b){var d=this;d=new PykCharts.validation.processInputs(d,a,"oneDimensionalCharts"),d.percent_row_rect_height=a.percent_row_rect_height?a.percent_row_rect_height:c.oneDimensionalCharts.percent_row_rect_height,d.percent_row_rect_height>100&&(d.percent_row_rect_height=100),d.percent_row_rect_height=2*d.k.__proto__._radiusCalculation(d.percent_row_rect_height),d.chart_height=PykCharts["boolean"](a.chart_height)?a.chart_height:d.percent_row_rect_height+10+d.pointer_size,d.k.validator().validatingDataType(d.chart_height,"chart_height",d.chart_width/2).validatingDataType(d.percent_row_rect_height,"percent_row_rect_height",c.oneDimensionalCharts.percent_row_rect_height),d.stop||(d.k.storeInitialDivHeight(),"default"===d.mode&&d.k.loading(),d.executeData=function(a){var b=d.k.validator().validatingJSON(a),c=d.selector.substring(1,d.selector.length);return d.stop||b===!1?void d.k.remove_loading_bar(c):(d.data=d.k.__proto__._groupBy("oned",a),d.compare_data=d.k.__proto__._groupBy("oned",a),d.k.remove_loading_bar(c),d.clubdata_enable=d.data.length>d.clubdata_maximum_nodes?d.clubdata_enable:"no",void d.render())},PykCharts["boolean"](d.interactive_enable)?(d.k.dataFromPykQuery(b),d.k.dataSourceFormatIdentification(d.data,d,"executeData")):d.k.dataSourceFormatIdentification(a.data,d,"executeData"))},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("oned",a),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.refresh_data=b.k.__proto__._groupBy("oned",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData(),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.length),b.new_data.forEach(function(a,b){a.color=shade_array[b]})),b.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){var a=this,b=a.selector.substring(1,a.selector.length),c=b+"_svg";a.fillChart=new PykCharts.Configuration.fillChart(a),a.transitions=new PykCharts.Configuration.transition(a),"default"===a.mode&&a.k.title().backgroundColor(a).export(a,"#"+c,"percentageBar").emptyDiv(a.selector).subtitle(),"infographics"===a.mode&&(a.k.backgroundColor(a).export(a,"#"+c,"percentageBar").emptyDiv(a.selector),a.new_data=a.data,"shade"===a.color_mode&&(shade_array=a.k.shadeColorConversion(a.shade_color,a.new_data.length),a.new_data.forEach(function(a,b){a.color=shade_array[b]}))),a.k.tooltip(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a),"default"===a.mode&&(percent_bar=a.optionalFeatures().clubData(),"shade"===a.color_mode&&(shade_array=a.k.shadeColorConversion(a.shade_color,a.new_data.length),a.new_data.forEach(function(a,b){a.color=shade_array[b]}))),a.optionalFeatures().svgContainer(c).createChart().label().ticks(),"default"===a.mode&&a.k.liveData(a).createFooter().lastUpdatedAt().credits().dataSource();var d=0;setTimeout(function(){a.ticks_text_height&&(d=a.ticks_text_height+10),a.k.exportSVG(a,"#"+c,"percentageBar",void 0,void 0,0,d)},a.transitions.duration());var e=a.k.resize(a.svgContainer);a.k.__proto__._ready(e),window.addEventListener("resize",function(){return a.k.resize(a.svgContainer)})},this.optionalFeatures=function(){var c={createChart:function(){var a=new PykCharts.Configuration.border(b),c=b.new_data.map(function(a){return a.weight});c.sum=function(){for(var a=0,b=0;b<this.length;++b)a+=this[b];return a};var d=c.sum();return b.new_data.forEach(function(a,b){this[b].percentValue=100*a.weight/d},b.new_data),b.chart_data=b.group.selectAll(".per-rect").data(b.new_data),b.chart_data.enter().append("rect").attr("class","per-rect"),b.chart_data.attr({x:0,x:function(a,c){if(0===c)return 0;var d=0,e=b.new_data.slice(0,c);return e.forEach(function(a,b){d+=this[b].percentValue},e),d*b.chart_width/100},width:0,height:function(){return b.percent_row_rect_height},fill:function(a){return b.fillChart.selectColor(a)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:a.color(),"stroke-width":a.width(),"stroke-dasharray":a.style(),"data-id":function(a){return a.name}}).on({mouseover:function(a){"default"===b.mode&&(a.tooltip=a.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+a.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(a.weight)+"<td class='tooltip-right-content'>("+a.percentValue.toFixed(1)+"%)</tr></table>",PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlight(b.selector+" .per-rect",this),b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.tooltip))},mouseout:function(a){"default"===b.mode&&(PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlightHide(b.selector+" .per-rect"),b.mouseEvent.tooltipHide(a))},mousemove:function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)},click:function(a){PykCharts["boolean"](b.click_enable)&&b.addEvents(a.name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr("width",function(a){return a.percentValue*b.chart_width/100}),b.chart_data.exit().remove(),this},svgContainer:function(a){return b.svgContainer=d3.select(b.selector).append("svg").attr({width:b.chart_width,height:b.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height,id:a,"class":"svgcontainer PykCharts-oneD"}),b.group=b.svgContainer.append("g").attr("id","percentageBar"),this},label:function(){function c(){b.chart_text.text(function(a){return a.percentValue.toFixed(1)+"%"}).text(function(a){return this.getBBox().width<.92*(a.percentValue*b.chart_width/100)&&this.getBBox().height<b.percent_row_rect_height?a.percentValue.toFixed(1)+"%":""})}b.chart_text=b.group.selectAll(".per-text").data(b.new_data);var d=0;return b.chart_text.enter().append("text").attr("class","per-text"),b.chart_text.attr({"class":"per-text",y:b.percent_row_rect_height/2+5,x:function(a,c){return d+=a.percentValue,0===c?(0+d*b.chart_width/100)/2:((d-a.percentValue)*b.chart_width/100+d*b.chart_width/100)/2}}),d=0,b.chart_text.text("").attr({fill:function(c){if("shade"===b.color_mode&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color},"text-anchor":"middle","pointer-events":"none"}).style({"font-size":b.label_size+"px","font-weight":b.label_weight,"font-family":b.label_family}),setTimeout(c,b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){function a(){i.text(function(a){return a.name}).text(function(a,c){return g[c]=this.getBBox().width,b.ticks_text_height=this.getBBox().height,this.getBBox().width<a.percentValue*b.chart_width/100?a.name:""}),e=0,h.attr({y1:function(){return b.percent_row_rect_height},x1:function(a,c){return e+=a.percentValue,0===c?(0+e*b.chart_width/100)/2:((e-a.percentValue)*b.chart_width/100+e*b.chart_width/100)/2},y2:function(){return b.percent_row_rect_height},x2:function(a,c){return f+=a.percentValue,0===c?(0+f*b.chart_width/100)/2:((f-a.percentValue)*b.chart_width/100+f*b.chart_width/100)/2},"stroke-width":b.pointer_thickness+"px",stroke:b.pointer_color,y2:function(a,c){return a.percentValue*b.chart_width/100>g[c]?b.percent_row_rect_height+10:b.percent_row_rect_height}}).style("margin-top","10px")}PykCharts["boolean"](b.pointer_overflow_enable)&&b.svgContainer.style("overflow","visible");var c,d,e=0,f=0,g=[];b.ticks_text_height,e=0;var h=b.group.selectAll(".per-ticks").data(b.new_data);h.enter().append("line").attr("class","per-ticks");var i=b.group.selectAll(".ticks_label").data(b.new_data);return i.enter().append("text").attr("class","ticks_label"),i.attr("class","ticks_label").attr("transform",function(a){return e+=a.percentValue,d=b.percent_row_rect_height+b.pointer_size+10,c=((e-a.percentValue)*b.chart_width/100+e*b.chart_width/100)/2,"translate("+c+","+d+")"}),i.text(function(){return""}).attr({"font-size":b.pointer_size,"text-anchor":"middle",fill:b.pointer_color,"font-family":b.pointer_family,"font-weight":b.pointer_weight,"pointer-events":"none"}),setTimeout(a,b.transitions.duration()),i.exit().remove(),h.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](b.clubdata_enable)){var a=[];if(0!==b.clubdata_always_include_data_points.length){var c=b.clubdata_always_include_data_points.length;for(i=0;c>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubdata_maximum_nodes;){d.sort(g);{d.pop()}}var h={name:b.clubdata_text,weight:f,tooltip:b.clubdata_tooltip};d.sort(function(a,b){return b.weight-a.weight}),d.length<b.clubdata_maximum_nodes&&d.push(h),b.new_data=d}else b.data.sort(function(a,b){return b.weight-a.weight}),b.new_data=b.data;return this}};return c}},PykCharts.oneD.pie=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),a.chart_height?(b.chart_height=a.chart_height,b.calculation=void 0):(b.chart_height=b.chart_width,b.calculation="pie"),b.pie_radius_percent=a.pie_radius_percent?a.pie_radius_percent:c.oneDimensionalCharts.pie_radius_percent,b.k.validator().validatingDataType(b.chart_height,"chart_height",b.chart_width).validatingDataType(b.pie_radius_percent,"pie_radius_percent",c.oneDimensionalCharts.pie_radius_percent),b.stop||(b.k.storeInitialDivHeight(),b.innerRadiusPercent=0,b.height_translate=b.chart_height/2,b.pie_radius_percent>100&&(b.pie_radius_percent=100),"default"===b.mode&&b.k.loading(),b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);if(b.stop||d===!1)return void b.k.remove_loading_bar(e);b.data=b.k.__proto__._groupBy("oned",c),b.compare_data=b.k.__proto__._groupBy("oned",c),b.k.remove_loading_bar(e);var f=new PykCharts.oneD.pieFunctions(a,b,"pie");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",f.render()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))}},PykCharts.oneD.donut=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),a.chart_height?(b.chart_height=a.chart_height,b.calculation=void 0):(b.chart_height=b.chart_width,b.calculation="pie"),b.pie_radius_percent=a.donut_radius_percent?a.donut_radius_percent:c.oneDimensionalCharts.donut_radius_percent,b.innerRadiusPercent=a.donut_inner_radius_percent?a.donut_inner_radius_percent:c.oneDimensionalCharts.donut_inner_radius_percent,b.k.validator().validatingDataType(b.chart_height,"chart_height",b.chart_width).validatingDataType(b.pie_radius_percent,"donut_radius_percent",c.oneDimensionalCharts.donut_radius_percent).validatingDataType(b.innerRadiusPercent,"donut_inner_radius_percent",c.oneDimensionalCharts.donut_inner_radius_percent),!b.stop){b.k.storeInitialDivHeight(),b.pie_radius_percent>100&&(b.pie_radius_percent=100),b.innerRadiusPercent>100&&(b.innerRadiusPercent=100);try{if(b.innerRadiusPercent>=b.pie_radius_percent)throw b.innerRadiusPercent=c.oneDimensionalCharts.donut_inner_radius_percent,"donut_inner_radius_percent"}catch(e){b.k.warningHandling(e,"6")}b.stop||("default"===b.mode&&b.k.loading(),b.height_translate=b.chart_height/2,b.show_total_at_center=a.donut_show_total_at_center?a.donut_show_total_at_center.toLowerCase():c.oneDimensionalCharts.donut_show_total_at_center,b.show_total_at_center_size="donut_show_total_at_center_size"in a?a.donut_show_total_at_center_size:c.oneDimensionalCharts.donut_show_total_at_center_size,b.show_total_at_center_color=a.donut_show_total_at_center_color?a.donut_show_total_at_center_color:c.oneDimensionalCharts.donut_show_total_at_center_color,b.show_total_at_center_weight=a.donut_show_total_at_center_weight?a.donut_show_total_at_center_weight:c.oneDimensionalCharts.donut_show_total_at_center_weight,b.show_total_at_center_family=a.donut_show_total_at_center_family?a.donut_show_total_at_center_family:c.oneDimensionalCharts.donut_show_total_at_center_family,b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);if(b.stop||d===!1)return void b.k.remove_loading_bar(e);b.data=b.k.__proto__._groupBy("oned",c),b.compare_data=b.k.__proto__._groupBy("oned",c),b.k.remove_loading_bar(e);var f=new PykCharts.oneD.pieFunctions(a,b,"donut");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",f.render()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))}}},PykCharts.oneD.electionPie=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),a.chart_height||void 0===a.chart_height)try{if(void 0===a.chart_height)a.chart_height="";else if(isNaN(a.chart_height))throw a.chart_height="","chart_height"}catch(e){b.k.warningHandling(e)}PykCharts["boolean"](a.chart_height)?(b.chart_height=a.chart_height,b.calculation=void 0,b.height_translate=b.chart_height/2):(b.chart_height=b.chart_width/2,b.calculation="pie",b.height_translate=b.chart_height),b.pie_radius_percent=a.pie_radius_percent?a.pie_radius_percent:c.oneDimensionalCharts.pie_radius_percent;try{if(isNaN(b.pie_radius_percent))throw b.pie_radius_percent=c.oneDimensionalCharts.pie_radius_percent,"pie_radius_percent"}catch(e){b.k.warningHandling(e,"1")}b.stop||(b.k.storeInitialDivHeight(),b.pie_radius_percent>100&&(b.pie_radius_percent=100),"default"===b.mode&&b.k.loading(),b.innerRadiusPercent=0,b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);if(b.stop||d===!1)return void b.k.remove_loading_bar(e);b.data=b.k.__proto__._groupBy("oned",c),b.compare_data=b.k.__proto__._groupBy("oned",c),b.k.remove_loading_bar(e);var f=new PykCharts.oneD.pieFunctions(a,b,"election pie");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",f.render()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))}},PykCharts.oneD.electionDonut=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),a.chart_height||void 0===a.chart_height)try{if(void 0===a.chart_height)a.chart_height="";else if(isNaN(a.chart_height))throw a.chart_height="","chart_height"}catch(e){b.k.warningHandling(e)}if(PykCharts["boolean"](a.chart_height)?(b.chart_height=a.chart_height,b.calculation=void 0,b.height_translate=b.chart_height/2):(b.chart_height=b.chart_width/2,b.calculation="pie",b.height_translate=b.chart_height),b.pie_radius_percent=a.donut_radius_percent?a.donut_radius_percent:c.oneDimensionalCharts.donut_radius_percent,b.innerRadiusPercent=a.donut_inner_radius_percent&&a.donut_inner_radius_percent?a.donut_inner_radius_percent:c.oneDimensionalCharts.donut_inner_radius_percent,b.k.validator().validatingDataType(b.pie_radius_percent,"donut_radius_percent",c.oneDimensionalCharts.donut_radius_percent).validatingDataType(b.innerRadiusPercent,"donut_inner_radius_percent",c.oneDimensionalCharts.donut_inner_radius_percent),!b.stop){b.k.storeInitialDivHeight(),b.pie_radius_percent>100&&(b.pie_radius_percent=100),b.innerRadiusPercent>100&&(b.innerRadiusPercent=100);try{if(b.innerRadiusPercent>=b.pie_radius_percent)throw b.innerRadiusPercent=c.oneDimensionalCharts.donut_inner_radius_percent,"donut_inner_radius_percent"}catch(e){b.k.warningHandling(e,"6")}b.stop||("default"===b.mode&&b.k.loading(),b.show_total_at_center=a.donut_show_total_at_center?a.donut_show_total_at_center.toLowerCase():c.oneDimensionalCharts.donut_show_total_at_center,b.show_total_at_center_size="donut_show_total_at_center_size"in a?a.donut_show_total_at_center_size:c.oneDimensionalCharts.donut_show_total_at_center_size,b.show_total_at_center_color=a.donut_show_total_at_center_color?a.donut_show_total_at_center_color:c.oneDimensionalCharts.donut_show_total_at_center_color,b.show_total_at_center_weight=a.donut_show_total_at_center_weight?a.donut_show_total_at_center_weight:c.oneDimensionalCharts.donut_show_total_at_center_weight,b.show_total_at_center_family=a.donut_show_total_at_center_family?a.donut_show_total_at_center_family:c.oneDimensionalCharts.donut_show_total_at_center_family,b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);if(b.stop||d===!1)return void b.k.remove_loading_bar(e);b.data=b.k.__proto__._groupBy("oned",c),b.compare_data=b.k.__proto__._groupBy("oned",c),b.k.remove_loading_bar(e);var f=new PykCharts.oneD.pieFunctions(a,b,"election donut");b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",f.render()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))}}},PykCharts.oneD.pieFunctions=function(a,b,c){var d=b;d.refresh=function(b){d.executeRefresh=function(a){d.data=d.k.__proto__._groupBy("oned",a),d.clubdata_enable=d.data.length>d.clubdata_maximum_nodes?d.clubdata_enable:"no",d.refresh_data=d.k.__proto__._groupBy("oned",a);var b=d.k.checkChangeInData(d.refresh_data,d.compare_data),c=[];d.compare_data=b[0];var e=b[1];e&&d.k.lastUpdatedAt("liveData"),d.new_data=d.optionalFeatures().clubData(),d.optionalFeatures().createChart(c).label().ticks().centerLabel()},PykCharts["boolean"](d.interactive_enable)?(d.k.dataFromPykQuery(b),d.k.dataSourceFormatIdentification(d.data,d,"executeRefresh")):d.k.dataSourceFormatIdentification(a.data,d,"executeRefresh")},this.render=function(){d.count=1;var a=d.selector.substring(1,d.selector.length),b=a+"_svg",e=[];d.fillChart=new PykCharts.Configuration.fillChart(d),d.transitions=new PykCharts.Configuration.transition(d),"default"===d.mode.toLowerCase()?(d.k.title().backgroundColor(d).export(d,"#"+b,c).emptyDiv(d.selector).subtitle(),d.optionalFeatures().svgContainer(b),d.new_data=d.optionalFeatures().clubData(),d.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip(),d.optionalFeatures().set_start_end_angle().createChart(e).label().ticks().centerLabel(),d.k.liveData(d)):"infographics"===d.mode.toLowerCase()&&(d.new_data=d.data,d.k.backgroundColor(d).export(d,"#"+b,c).emptyDiv(d.selector),d.optionalFeatures().svgContainer(b).set_start_end_angle().createChart(e).label().ticks().centerLabel(),d.k.tooltip()),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d);var f=0,g=0;setTimeout(function(){d.ticks_text_width.length&&(f=d3.max(d.ticks_text_width,function(a){return a}),g=d.ticks_text_height),d.k.exportSVG(d,"#"+b,c,void 0,void 0,f+20,g+20)},d.transitions.duration());var h=d.k.resize(d.svgContainer);d.k.__proto__._ready(h),window.addEventListener("resize",function(){return d.k.resize(d.svgContainer)})},d.optionalFeatures=function(){var b={svgContainer:function(a){return d.svgContainer=d3.select(d.selector).append("svg").attr({width:d.chart_width,height:function(){return d.chart_height},preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+d.chart_width+" "+d.chart_height,id:a,"class":"svgcontainer PykCharts-oneD"}),d.group=d.svgContainer.append("g").attr({transform:"translate("+d.chart_width/2+","+d.height_translate+")",id:"pieGroup"}),this},createChart:function(){document.querySelector(d.selector+" #pieGroup").innerHTML=null;var a=new PykCharts.Configuration.border(d);if("shade"===d.color_mode&&(shade_array=d.k.shadeColorConversion(d.shade_color,d.new_data.length),d.new_data.forEach(function(a,b){a.color=shade_array[b]})),"pie"===c.toLowerCase()||"donut"===c.toLowerCase()){d.new_data.sort(function(a,b){return a.weight-b.weight});var b=d.new_data.pop();if(d.new_data.unshift(b),PykCharts["boolean"](d.clubdata_enable)&&"default"===d.mode){for(var e,f,g=0;g<d.new_data.length;g++)if(d.new_data[g].name===d.clubdata_text){e=g,f=d.new_data[g];break}if(e){if(d.new_data.splice(e,1),0===g){var b=d.new_data.pop();d.new_data.splice(0,0,b)}d.new_data.splice(1,0,f)}}}else if(("election pie"==c.toLowerCase()||"election donut"==c.toLowerCase())&&(d.new_data.sort(function(a,b){return b.weight-a.weight}),PykCharts["boolean"](d.clubdata_enable)&&"default"===d.mode)){for(var e,f,g=0;g<d.new_data.length;g++)if(d.new_data[g].name===d.clubdata_text){e=g,f=d.new_data[g];break}e&&(d.new_data.splice(e,1),d.new_data.push(f))}d.sum=0;for(var g=0,h=d.new_data.length;h>g;g++)d.sum+=d.new_data[g].weight;return d.inner_radius=d.k.__proto__._radiusCalculation(d.innerRadiusPercent,d.calculation),d.outer_radius=d.k.__proto__._radiusCalculation(d.pie_radius_percent,d.calculation),d.arc=d3.svg.arc().innerRadius(d.inner_radius).outerRadius(d.outer_radius),d.pie=d3.layout.pie().value(function(a){return a.weight}).sort(null).startAngle(d.start_angle).endAngle(d.end_angle),d.chart_data=d.group.selectAll("path").data(d.pie(d.new_data)),d.chart_data.enter().append("path"),d.chart_data.attr("class","pie"),d.chart_data.attr({fill:function(a){return d.fillChart.selectColor(a.data)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:a.color(),"stroke-width":a.width(),"stroke-dasharray":a.style(),"data-id":function(a){return a.data.name}}).on({mouseover:function(a){"default"===d.mode&&(a.data.tooltip=a.data.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+a.data.name+"</tr><tr><td class='tooltip-left-content'>"+d.k.appendUnits(a.data.weight)+"<td class='tooltip-right-content'>("+(100*a.data.weight/d.sum).toFixed(1)+"%) </tr></table>",PykCharts["boolean"](d.chart_onhover_highlight_enable)&&d.mouseEvent.highlight(d.selector+" .pie",this),d.mouseEvent.tooltipPosition(a),d.mouseEvent.tooltipTextShow(a.data.tooltip))},mouseout:function(a){"default"===d.mode&&(PykCharts["boolean"](d.chart_onhover_highlight_enable)&&d.mouseEvent.highlightHide(d.selector+" .pie"),d.mouseEvent.tooltipHide(a))},mousemove:function(a){"default"===d.mode&&d.mouseEvent.tooltipPosition(a)},click:function(a){PykCharts["boolean"](d.click_enable)&&d.addEvents(a.data.name,d3.select(this).attr("data-id"))
}}),d.chart_data.transition().delay(function(a,b){return d.transition_duration&&"default"===d.mode?b*d.transition_duration*1e3/d.new_data.length:0}).duration(d.transitions.duration()/d.new_data.length).attrTween("d",function(a){var b=d3.interpolate(a.startAngle,a.endAngle);return function(c){return a.endAngle=b(c),d.arc(a)}}),d.chart_data.exit().remove(),this},label:function(){function b(){d.chart_text.style({"font-weight":d.label_weight,"font-size":d.label_size+"px","font-family":d.label_family}).text(function(a){return(100*a.data.weight/d.sum).toFixed(1)+"%"}).attr({"text-anchor":"middle","pointer-events":"none",dy:5,fill:function(b){if("shade"===d.color_mode&&!a.label_color){var c=d.k.__proto__._colourBrightness(b.data.color);return"light"===c?"black":"white"}return d.label_color}}).text(function(a){return"pie"===c.toLowerCase()||"election pie"===c.toLowerCase()?this.getBBox().width<(a.endAngle-a.startAngle)*(d.outer_radius/2)?(100*a.data.weight/d.sum).toFixed(1)+"%":"":this.getBBox().width<Math.abs(a.endAngle-a.startAngle)*d.outer_radius*.9&&this.getBBox().height<.75*(d.outer_radius-d.inner_radius)?(100*a.data.weight/d.sum).toFixed(1)+"%":""}),d.chart_text.exit().remove()}return d.chart_text=d.group.selectAll("text").data(d.pie(d.new_data)),d.chart_text.enter().append("text").attr({"class":"pie-label",transform:function(a){return"translate("+d.arc.centroid(a)+")"}}),d.chart_text.attr("transform",function(a){return"translate("+d.arc.centroid(a)+")"}),d.chart_text.text(""),setTimeout(b,d.transitions.duration()),this},clubData:function(){if(PykCharts["boolean"](d.clubdata_enable)){var a=[];if(0!==d.clubdata_always_include_data_points.length){var b=d.clubdata_always_include_data_points.length;for(i=0;b>i;i++)a[i]=d.clubdata_always_include_data_points[i]}var c=[];for(i=0;i<a.length;i++)for(j=0;j<d.data.length;j++)a[i].toUpperCase()===d.data[j].name.toUpperCase()&&c.push(d.data[j]);d.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;c.length<d.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)d.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;c.push(d.data[e]),e++}var f=0;for(j=e;j<d.data.length;j++){for(i=0;i<c.length&&j<d.data.length;i++)d.data[j].name.toUpperCase()===c[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<d.data.length&&(f+=d.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};c.length>d.clubdata_maximum_nodes;){c.sort(g);{c.pop()}}var h={name:d.clubdata_text,weight:f,tooltip:d.clubdata_tooltip};c.sort(function(a,b){return b.weight-a.weight}),c.length<d.clubdata_maximum_nodes&&c.push(h),d.new_data=c}else d.data.sort(function(a,b){return b.weight-a.weight}),d.new_data=d.data;return d.new_data},ticks:function(){function a(){e.text(function(a){return a.data.name}).text(function(a,b){return d.ticks_text_width[b]=this.getBBox().width,d.ticks_text_height=this.getBBox().height,a.data.name}).attr({"text-anchor":function(a){var b=(a.endAngle-a.startAngle)/2+a.startAngle;return b>0&&2>b?"start":b>=1.5&&3.5>b?"middle":b>=3.5&&6>b?"end":b>=6?"middle":"election pie"===c||"election donut"===c&&-1>b?"end":0>b?"middle":void 0},dy:5,"pointer-events":"none"}).style({fill:d.pointer_color,"font-size":d.pointer_size+"px","font-weight":d.pointer_weight,"font-family":d.pointer_family}),e.exit().remove()}function b(){h.attr({x2:function(a){return 1*(d.outer_radius/1+12)*Math.cos((a.startAngle+a.endAngle)/2)},y2:function(a){return 1*(d.outer_radius/1+12)*Math.sin((a.startAngle+a.endAngle)/2)},transform:"rotate(-90)","stroke-width":d.pointer_thickness+"px",stroke:d.pointer_color}),h.exit().remove()}PykCharts["boolean"](d.pointer_overflow_enable)&&d.svgContainer.style("overflow","visible");d.ticks_text_width=[];var e=d.group.selectAll(".ticks_label").data(d.pie(d.new_data));e.attr("class","ticks_label"),e.enter().append("text").attr({x:0,y:0});var f,g;e.attr("transform",function(a){return a.endAngle-a.startAngle<.2?(f=1*(d.outer_radius+30)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),g=1*(d.outer_radius/1+20)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)):(f=1*(d.outer_radius+22)*Math.cos((a.startAngle+a.endAngle-Math.PI)/2),g=1*(d.outer_radius/1+24)*Math.sin((a.startAngle+a.endAngle-Math.PI)/2)),"translate("+f+","+g+")"}),e.text(""),setTimeout(a,d.transitions.duration());var h=d.group.selectAll("line").data(d.pie(d.new_data));return h.enter().append("line").attr("class","ticks"),h.attr({x1:function(a){return 1*d.outer_radius*Math.cos((a.startAngle+a.endAngle)/2)},y1:function(a){return 1*d.outer_radius*Math.sin((a.endAngle+a.startAngle)/2)},x2:function(a){return 1*d.outer_radius*Math.cos((a.startAngle+a.endAngle)/2)},y2:function(a){return 1*d.outer_radius*Math.sin((a.endAngle+a.startAngle)/2)}}),setTimeout(b,d.transitions.duration()),this},centerLabel:function(){function a(){e.text(function(){return d.k.appendUnits(d.sum)}).text(function(){return b=this.getBBox().height,d.k.appendUnits(d.sum)}).attr({"pointer-events":"none","text-anchor":"middle",y:function(){return"donut"===c?b/2:-.25*d.inner_radius},fill:d.show_total_at_center_color}).style({"font-family":d.show_total_at_center_family,"font-weight":d.show_total_at_center_weight,"font-size":d.show_total_at_center_size+"px"})}if(PykCharts["boolean"](d.show_total_at_center)&&("donut"===c||"election donut"===c)){var b,e=d.group.selectAll(d.selector+" .centerLabel").data([d.sum]);e.enter().append("text"),e.attr("class","centerLabel").text(""),setTimeout(a,d.transitions.duration()),e.exit().remove()}return this},set_start_end_angle:function(){return d.startAngle,d.endAngle,"pie"===c||"donut"===c?(d.start_angle=0*(Math.PI/180),d.end_angle=360*(Math.PI/180)):("election pie"===c||"election donut"===c)&&(d.start_angle=-90*(Math.PI/180),d.end_angle=90*(Math.PI/180)),this}};return b}},PykCharts.oneD.pyramid=function(a){var b=this;b.interval="";new PykCharts.Configuration.Theme({});this.execute=function(c){b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),b.chart_height=a.chart_height?a.chart_height:b.chart_width,b.k.validator().validatingDataType(b.chart_height,"chart_height",b.chart_width),b.stop||(b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("oned",a),b.data_length=b.data.length,b.compare_data=b.k.__proto__._groupBy("oned",a),b.k.remove_loading_bar(d),b.clubdata_enable=b.data_length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",void b.render())},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("oned",a),b.data_length=b.data.length,b.clubdata_enable=b.data_length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.refresh_data=b.k.__proto__._groupBy("oned",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.new_data=b.optionalFeatures().clubData(),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.length),shade_array.reverse(),b.new_data.forEach(function(a,b){a.color=shade_array[b]})),b.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){var a=b.selector.substring(1,b.selector.length),c=a+"_svg";b.fillChart=new PykCharts.Configuration.fillChart(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#"+c,"pyramid").emptyDiv(b.selector).subtitle(),b.new_data=b.optionalFeatures().clubData(),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.length),shade_array.reverse(),b.new_data.forEach(function(a,b){a.color=shade_array[b]})),b.optionalFeatures().svgContainer(c).createChart().label().ticks(),b.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip().liveData(b),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)):"infographics"===b.mode&&(b.new_data=b.data,"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.length),shade_array.reverse(),b.new_data.forEach(function(a,b){a.color=shade_array[b]})),b.k.backgroundColor(b).export(b,"#"+c,"pyramid").emptyDiv(b.selector),b.optionalFeatures().svgContainer(c).createChart().label().ticks(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b));var d=0;setTimeout(function(){b.ticks_text_width.length&&(d=d3.max(b.ticks_text_width,function(a){return a})),b.k.exportSVG(b,"#"+c,"pyramid",void 0,void 0,d)},b.transitions.duration());var e=b.k.resize(b.svgContainer);b.k.__proto__._ready(e),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},this.percentageValues=function(a){b.sum=d3.sum(a,function(a){return a.weight});var c=a.map(function(a){return a.weight/b.sum*100});return c.sort(function(a,b){return b-a}),c},this.pyramidLayout=function(){var a,c,d={data:function(b){return 0!==b.length&&(a=b),this},size:function(a){return 2===a.length&&(c=a),this},coordinates:function(){function d(a){return d3.sum(h,function(b,c){return c>=a?b:void 0})}for(var e=c[0],f=c[1],g=e/2/f,h=b.percentageValues(a),i=[],j=e*f/2,k=0,l=a.length;l>k;k++){var m=d(k),n=m/100*j,o=Math.sqrt(n/g),p=2*g*o,q=(e-p)/2;i[k]=0===k?{values:[{x:e/2,y:0},{x:q,y:o},{x:p+q,y:o}]}:{values:[i[k-1].values[1],{x:q,y:o},{x:p+q,y:o},i[k-1].values[2]]}}return i}};return d},this.optionalFeatures=function(){var c={svgContainer:function(a){return b.svgContainer=d3.select(b.selector).append("svg").attr({width:b.chart_width,height:b.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height,id:a,"class":"svgcontainer PykCharts-oneD"}),b.group=b.svgContainer.append("g").attr("id","pyrgrp"),this},createChart:function(){var a=new PykCharts.Configuration.border(b);b.pyramid=b.pyramidLayout().data(b.new_data).size([b.chart_width,b.chart_height]),b.coordinates=b.pyramid.coordinates(),b.coordinates[0].values[1]=b.coordinates[b.coordinates.length-1].values[1],b.coordinates[0].values[2]=b.coordinates[b.coordinates.length-1].values[2];for(var c=b.new_data.length-1,d=(b.new_data.length-1,[]),e=0,f=b.new_data.length;f>e;e++)0==e?d[e]=b.new_data[e].tooltip||"<table class='PykCharts'><tr><th colspan='2'  class='tooltip-heading'>"+b.new_data[e].name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(b.new_data[e].weight)+"<td class='tooltip-right-content'>("+(100*b.new_data[e].weight/b.sum).toFixed(1)+"%) </tr></table>":(d[e]=b.new_data[c].tooltip||"<table class='PykCharts'><tr><th colspan='2'  class='tooltip-heading'>"+b.new_data[c].name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(b.new_data[c].weight)+"<td class='tooltip-right-content'>("+(100*b.new_data[c].weight/b.sum).toFixed(1)+"%) </tr></table>",c--);var g,h=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y}),i=[{x:0,y:b.chart_height},{x:b.chart_width,y:b.chart_height},{x:0,y:b.chart_height},{x:b.chart_width,y:b.chart_height},{x:0,y:b.chart_height},{x:b.chart_width,y:b.chart_height}],c=b.new_data.length;return b.chart_data=b.group.selectAll(".pyr-path").data(b.coordinates),b.chart_data.enter().append("path"),b.chart_data.attr({"class":"pyr-path",d:function(){return h(i)},stroke:a.color(),"stroke-width":a.width(),"stroke-dasharray":a.style(),fill:function(a,d){return 0===d?(g=b.new_data[d],a.color=b.new_data[d].color):(c--,g=b.new_data[c],a.color=b.new_data[c].color),b.fillChart.selectColor(g)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(a,c){return b.new_data[c].name}}).on({mouseover:function(a,c){"default"===b.mode&&(PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlight(b.selector+" .pyr-path",this),b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(d[c]))},mouseout:function(a){"default"===b.mode&&(PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlightHide(b.selector+" .pyr-path"),b.mouseEvent.tooltipHide(a))},mousemove:function(a){"default"===b.mode&&b.mouseEvent.tooltipPosition(a)},click:function(a,c){PykCharts["boolean"](b.click_enable)&&b.addEvents(b.new_data[c].name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr("d",function(a){return h(a.values)}),b.chart_data.exit().remove(),this},label:function(){function c(){b.chart_text.text(function(a,c){return 0===c?(100*b.new_data[c].weight/b.sum).toFixed(1)+"%":(d--,(100*b.new_data[d].weight/b.sum).toFixed(1)+"%")}).text(function(a,c){return this.getBBox().width<a.values[2].x-a.values[1].x&&this.getBBox().height<Math.abs(a.values[1].y-a.values[0].y)?0===c?(100*b.new_data[c].weight/b.sum).toFixed(1)+"%":(e--,(100*b.new_data[e].weight/b.sum).toFixed(1)+"%"):""})}var d=b.new_data.length,e=b.new_data.length;return b.chart_text=b.group.selectAll("text").data(b.coordinates),b.chart_text.enter().append("text"),b.chart_text.attr({"text-anchor":"middle","pointer-events":"none",fill:function(c){if("shade"===b.color_mode&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color},y:function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+5:(a.values[0].y+b.coordinates[b.coordinates.length-1].values[1].y)/2+10},x:function(){return b.chart_width/2}}).text("").style({"font-weight":b.label_weight,"font-size":b.label_size+"px","font-family":b.label_family}),setTimeout(c,b.transitions.duration()),b.chart_text.exit().remove(),this},ticks:function(){function a(){d.text(function(a,c){return 0===c?b.new_data[c].name:(i--,b.new_data[i].name)}).text(function(a,c){return 0===c?(g[c]=this.getBBox().height,b.ticks_text_width[c]=this.getBBox().width,this.getBBox().height<a.values[1].y-a.values[0].y?b.new_data[c].name:""):(g[c]=this.getBBox().height,this.getBBox().height<a.values[0].y-a.values[1].y?(h--,b.new_data[h].name):"")}).style({fill:b.pointer_color,"font-size":b.pointer_size+"px","font-family":b.pointer_family,"font-weight":b.pointer_weight}).attr("text-anchor","start")}function c(){j.attr("x2",function(a,c){return Math.abs(a.values[0].y-a.values[1].y)>g[c]?3===a.values.length?(a.values[0].x+b.coordinates[b.coordinates.length-1].values[2].x)/2+12:(a.values[2].x+a.values[3].x)/2+12:3===a.values.length?(a.values[0].x+b.coordinates[b.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2})}PykCharts["boolean"](b.pointer_overflow_enable)&&b.svgContainer.style("overflow","visible");var d=b.group.selectAll(".ticks_label").data(b.coordinates);d.enter().append("text").attr({x:0,y:0,"class":"ticks_label"});var e,f,g=[];b.ticks_text_width=[];var h=b.new_data.length,i=b.new_data.length;d.attr("transform",function(a){return e=3===a.values.length?(a.values[0].x+b.coordinates[b.coordinates.length-1].values[2].x)/2+17:(a.values[2].x+a.values[3].x)/2+17,f=4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+b.coordinates[b.coordinates.length-1].values[1].y)/2,"translate("+e+","+(f+5)+")"}),d.text(""),setTimeout(a,b.transitions.duration()),d.exit().remove();var j=b.group.selectAll(".pyr-ticks").data(b.coordinates);return j.enter().append("line").attr("class","pyr-ticks"),j.attr({x1:function(a){return 3===a.values.length?(a.values[0].x+b.coordinates[b.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2},y1:function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+b.coordinates[b.coordinates.length-1].values[1].y)/2},x2:function(a){return 3===a.values.length?(a.values[0].x+b.coordinates[b.coordinates.length-1].values[2].x)/2:(a.values[2].x+a.values[3].x)/2},y2:function(a){return 4===a.values.length?(a.values[0].y-a.values[1].y)/2+a.values[1].y+2:(a.values[0].y+b.coordinates[b.coordinates.length-1].values[1].y)/2},"stroke-width":b.pointer_thickness+"px",stroke:b.pointer_color}),setTimeout(c,b.transitions.duration()),j.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](b.clubdata_enable)){var a=[];if(0!==b.clubdata_always_include_data_points.length){var c=b.clubdata_always_include_data_points.length;for(i=0;c>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var d=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&d.push(b.data[j]);b.data.sort(function(a,b){return b.weight-a.weight});for(var e=0;d.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[e].name.toUpperCase()===a[i].toUpperCase()&&e++;d.push(b.data[e]),e++}var f=0;for(j=e;j<b.data.length;j++){for(i=0;i<d.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===d[i].name.toUpperCase()&&(f+=0,j++,i=-1);j<b.data.length&&(f+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};d.length>b.clubdata_maximum_nodes;){d.sort(g);{d.pop()}}var h={name:b.clubdata_text,weight:f,tooltip:b.clubdata_tooltip};d.sort(function(a,b){return a.weight-b.weight}),d.length<b.clubdata_maximum_nodes&&d.push(h),b.new_data=d}else b.data.sort(function(a,b){return a.weight-b.weight}),b.new_data=b.data;return b.new_data}};return c}},PykCharts.oneD.treemap=function(a){var b=this;b.interval="";new PykCharts.Configuration.Theme({});this.execute=function(c){b=new PykCharts.validation.processInputs(b,a,"oneDimensionalCharts"),optional=a.optional,b.chart_height=a.chart_height?a.chart_height:b.chart_width,b.k.validator().validatingDataType(b.chart_height,"chart_height",b.chart_width),b.stop||(b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("oned",a),b.compare_data=b.k.__proto__._groupBy("oned",a),b.k.remove_loading_bar(d),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",void b.render())},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("oned",a),b.clubdata_enable=b.data.length>b.clubdata_maximum_nodes?b.clubdata_enable:"no",b.refresh_data=b.k.__proto__._groupBy("oned",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().clubData(),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.children.length),b.new_data.children.forEach(function(a,b){a.color=shade_array[b]})),b.optionalFeatures().createChart().label()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){var a=b.selector.substring(1,b.selector.length),c=a+"_svg";b.fillChart=new PykCharts.Configuration.fillChart(b),b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode&&b.k.title().backgroundColor(b).export(b,"#"+c,"treemap").emptyDiv(b.selector).subtitle(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+c,"treemap").emptyDiv(b.selector),b.new_data={children:b.data}),"default"===b.mode&&b.optionalFeatures().clubData(),"shade"===b.color_mode&&(shade_array=b.k.shadeColorConversion(b.shade_color,b.new_data.children.length),b.new_data.children.forEach(function(a,b){a.color=shade_array[b]})),b.optionalFeatures().svgContainer(c).createChart().label(),"default"===b.mode&&b.k.liveData(b).createFooter().lastUpdatedAt().credits().dataSource(),b.k.exportSVG(b,"#"+c,"treemap");var d=b.k.resize(b.svgContainer);b.k.__proto__._ready(d),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var c={svgContainer:function(a){return b.svgContainer=d3.select(b.selector).append("svg:svg").attr({width:b.chart_width,height:b.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height,id:a,"class":"svgcontainer PykCharts-oneD"}),b.group=b.svgContainer.append("g").attr("id","treemap"),this},createChart:function(){b.treemap=d3.layout.treemap().sort(function(a,b){return a.weight-b.weight}).size([b.chart_width,b.chart_height]).value(function(a){return a.weight}).sticky(!1),b.sum=d3.sum(b.new_data.children,function(a){return a.weight});var a;return b.node=b.treemap.nodes(b.new_data),a=b.new_data.children.length,b.chart_data=b.group.selectAll(".cell").data(b.node),b.chart_data.enter().append("svg:g").attr("class","cell").append("svg:rect").attr("class","treemap-rect"),b.chart_data.attr("class","cell").select("rect").attr({"class":"treemap-rect",id:function(a,b){return"rect"+b},x:function(a){return a.x},y:function(a){return a.y},width:function(a){return a.dx-1},height:0,fill:function(a){return a.children?"white":b.fillChart.selectColor(a)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(a){return a.name}}).on({mouseover:function(a){a.children||"default"!==b.mode||(a.tooltip=a.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+a.name+"</tr><tr><td class='tooltip-left-content'>"+b.k.appendUnits(a.weight)+"<td class='tooltip-right-content'>("+(100*a.weight/b.sum).toFixed(1)+"%)</tr></table>",PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlight(b.selector+" .treemap-rect",this),b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.tooltip))},mouseout:function(a){"default"===b.mode&&(b.mouseEvent.tooltipHide(a),PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlightHide(b.selector+" .treemap-rect"))},mousemove:function(a){a.children||"default"!==b.mode||b.mouseEvent.tooltipPosition(a)},click:function(a){PykCharts["boolean"](b.click_enable)&&b.addEvents(a.name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr("height",function(a){return a.dy-1}),b.chart_data.exit().remove(),this},label:function(){function c(){b.chart_text.text(function(a){return a.children?" ":a.name}).attr("pointer-events","none").text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":a.name:""})}function d(){b.chart_text1.text(function(a){return a.children?" ":b.k.appendUnits(a.weight)}).text(function(a){return this.getBBox().width<a.dx&&this.getBBox().height<a.dy-15?a.children?" ":(100*a.weight/b.sum).toFixed(1)+"%":""})}return b.chart_text=b.group.selectAll(".name").data(b.node),b.chart_text1=b.group.selectAll(".weight").data(b.node),b.chart_text.enter().append("svg:text").attr("class","name"),b.chart_text1.enter().append("svg:text").attr("class","weight"),b.chart_text.attr({"class":"name",x:function(a){return a.x+a.dx/2},y:function(a){return a.y+a.dy/2}}),b.chart_text1.attr({"class":"weight",x:function(a){return a.x+a.dx/2},y:function(a){return a.y+a.dy/2+b.label_size}}),b.chart_text.attr({"text-anchor":"middle",fill:function(c){if("shade"===b.color_mode&&!c.children&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color}}).style({"font-weight":b.label_weight,"font-size":b.label_size+"px","font-family":b.label_family}).text(""),setTimeout(c,b.transitions.duration()),b.chart_text1.attr({"text-anchor":"middle",fill:function(c){if("shade"===b.color_mode&&!c.children&&!a.label_color){var d=b.k.__proto__._colourBrightness(c.color);return"light"===d?"black":"white"}return b.label_color},"pointer-events":"none"}).style({"font-weight":b.label_weight,"font-size":b.label_size+"px","font-family":b.label_family}).text(""),setTimeout(d,b.transitions.duration()),b.chart_text.exit().remove(),b.chart_text1.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](b.clubdata_enable)){var a=[],c=0,d=0;if(b.data.length<=b.clubdata_maximum_nodes)return b.new_data={children:b.data},this;if(0!==b.clubdata_always_include_data_points.length){var e=b.clubdata_always_include_data_points.length;for(i=0;e>i;i++)a[i]=b.clubdata_always_include_data_points[i]}var f=[];for(i=0;i<a.length;i++)for(j=0;j<b.data.length;j++)a[i].toUpperCase()===b.data[j].name.toUpperCase()&&f.push(b.data[j]);for(b.data.sort(function(a,b){return b.weight-a.weight});f.length<b.clubdata_maximum_nodes-1;){for(i=0;i<a.length;i++)b.data[d].name.toUpperCase()===a[i].toUpperCase()&&d++;f.push(b.data[d]),d++}for(j=d;j<b.data.length;j++){for(i=0;i<f.length&&j<b.data.length;i++)b.data[j].name.toUpperCase()===f[i].name.toUpperCase()&&(c+=0,j++,i=-1);j<b.data.length&&(c+=b.data[j].weight)}for(var g=function(a,b){return b.weight-a.weight};f.length>b.clubdata_maximum_nodes;){f.sort(g);{f.pop()}}var h={name:b.clubdata_text,weight:c,color:b.clubData_color,tooltip:b.clubData_tooltip};f.length<b.clubdata_maximum_nodes&&f.push(h),b.new_data={children:f}}else b.new_data={children:b.data};return this}};return c}},PykCharts.other.pictograph=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(){b=new PykCharts.validation.processInputs(b,a,"other");var d=(a.optional,c.otherCharts);b.pictograph_show_all_images=a.pictograph_show_all_images?a.pictograph_show_all_images.toLowerCase():d.pictograph_show_all_images,b.pictograph_total_count_enable=a.pictograph_total_count_enable?a.pictograph_total_count_enable.toLowerCase():d.pictograph_total_count_enable,b.pictograph_current_count_enable=a.pictograph_current_count_enable?a.pictograph_current_count_enable.toLowerCase():d.pictograph_current_count_enable,b.pictograph_image_per_line=a.pictograph_image_per_line?a.pictograph_image_per_line:d.pictograph_image_per_line,b.pictograph_current_count_size=a.pictograph_current_count_size?a.pictograph_current_count_size:d.pictograph_current_count_size,b.pictograph_current_count_color=a.pictograph_current_count_color?a.pictograph_current_count_color:d.pictograph_current_count_color,b.pictograph_current_count_weight=a.pictograph_current_count_weight?a.pictograph_current_count_weight.toLowerCase():d.pictograph_current_count_weight,b.pictograph_current_count_family=a.pictograph_current_count_family?a.pictograph_current_count_family.toLowerCase():d.pictograph_current_count_family,b.pictograph_total_count_size=a.pictograph_total_count_size?a.pictograph_total_count_size:d.pictograph_total_count_size,b.pictograph_total_count_color=a.pictograph_total_count_color?a.pictograph_total_count_color:d.pictograph_total_count_color,b.pictograph_total_count_weight=a.pictograph_total_count_weight?a.pictograph_total_count_weight.toLowerCase():d.pictograph_total_count_weight,b.pictograph_total_count_family=a.pictograph_total_count_family?a.pictograph_total_count_family.toLowerCase():d.pictograph_total_count_family,b.pictograph_image_width=a.pictograph_image_width?a.pictograph_image_width:d.pictograph_image_width,b.pictograph_image_height=a.pictograph_image_height?a.pictograph_image_height:d.pictograph_image_height,b.pictograph_units_per_image=a.pictograph_units_per_image?a.pictograph_units_per_image:"",b.pictograph_units_per_image_text_family=a.pictograph_units_per_image_text_family?a.pictograph_units_per_image_text_family.toLowerCase():d.pictograph_units_per_image_text_family,b.pictograph_units_per_image_text_size=a.pictograph_units_per_image_text_size?a.pictograph_units_per_image_text_size:d.pictograph_units_per_image_text_size,b.pictograph_units_per_image_text_color=a.pictograph_units_per_image_text_color?a.pictograph_units_per_image_text_color:d.pictograph_units_per_image_text_color,b.pictograph_units_per_image_text_weight=a.pictograph_units_per_image_text_weight?a.pictograph_units_per_image_text_weight.toLowerCase():d.pictograph_units_per_image_text_weight,b.chart_height=a.chart_height?a.chart_height:b.chart_width,b.k.validator().validatingDataType(b.chart_height,"chart_height",b.chart_width).validatingDataType(b.pictograph_units_per_image_text_size,"pictograph_units_per_image_text_size",d.pictograph_units_per_image_text_size).validatingDataType(b.pictograph_current_count_size,"pictograph_current_count_size",d.pictograph_current_count_size).validatingDataType(b.pictograph_total_count_size,"pictograph_total_count_size",d.pictograph_total_count_size).validatingDataType(b.pictograph_image_width,"pictograph_image_width",d.pictograph_image_width).validatingDataType(b.pictograph_image_height,"pictograph_image_height",d.pictograph_image_height).validatingDataType(b.pictograph_image_per_line,"pictograph_image_per_line",d.pictograph_image_per_line).validatingFontWeight(b.pictograph_current_count_weight,"pictograph_current_count_weight",d.pictograph_current_count_weight).validatingFontWeight(b.pictograph_total_count_weight,"pictograph_total_count_weight",d.pictograph_total_count_weight).validatingFontWeight(b.pictograph_units_per_image_text_weight,"pictograph_units_per_image_text_weight",d.pictograph_units_per_image_text_weight).validatingColor(b.pictograph_current_count_color,"pictograph_current_count_color",d.pictograph_current_count_color).validatingColor(b.pictograph_total_count_color,"pictograph_total_count_color",d.pictograph_total_count_color).validatingColor(b.pictograph_units_per_image_text_color,"pictograph_units_per_image_text_color",d.pictograph_units_per_image_text_color),b.stop||(b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=a.sort(function(a,b){return b.weight-a.weight}),b.old_weight=0,b.compare_data=b.data,b.k.remove_loading_bar(d),void b.render())},b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},this.refresh=function(){b.executeRefresh=function(a){b.old_data=b.data,b.old_weight=b.weight;var c=b.k.validator().validatingJSON(a);if(!b.stop&&c!==!1){b.data=a.sort(function(a,b){return b.weight-a.weight}),b.refresh_data=b.data;var d=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=d[0];var e=d[1];e&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().labelText().enableLabel().createChart()}},b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){var a=b.selector.substring(1,b.selector.length),c=a+"_svg";b.transitions=new PykCharts.Configuration.transition(b),"default"===b.mode?b.k.title().backgroundColor(b).export(b,"#"+c,"pictograph").emptyDiv().subtitle().liveData(b):b.k.backgroundColor(b).export(b,"#"+c,"pictograph").emptyDiv(),b.optionalFeatures().svgContainer(c).labelText().enableLabel(),PykCharts["boolean"](b.pictograph_units_per_image)&&b.optionalFeatures().appendUnits(),b.optionalFeatures().createChart(),"default"===b.mode&&b.k.createFooter().lastUpdatedAt().credits().dataSource(),b.k.exportSVG(b,"#"+c,"pictograph");var d=b.k.resize(b.svgContainer);b.k.__proto__._ready(d),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},this.optionalFeatures=function(){var a={svgContainer:function(a){return b.svgContainer=d3.select(b.selector).append("svg").attr({width:b.chart_width,id:a,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height}),b.group=b.svgContainer.append("g").attr("id","pictograph_image_group"),b.group1=b.svgContainer.append("g").attr("transform","translate(0,0)"),PykCharts["boolean"](b.pictograph_units_per_image)&&(b.group2=b.svgContainer.append("g").attr("id","units-per-image")),this
},createChart:function(){var a=0,c=0;b.optionalFeatures().showTotal();var d=0;b.textWidth||(b.textWidth=0),b.totalTxtWeight||(b.totalTxtWeight=0);var e=b.textWidth+b.totalTxtWeight+25;b.total_unit_width>e&&(e=b.total_unit_width+10),b.group.attr("transform","translate("+e+",0)");for(var f=1;f<=b.weight;f++){f<=b.data[1].weight?(!b.old_data||b.old_data&&f>b.old_data[1].weight)&&(b.group.append("image").attr({"xlink:href":b.data[1].image,id:"current_image"+f,x:c*(b.pictograph_image_width+1),y:a*(b.pictograph_image_height+10),width:0,height:b.pictograph_image_height+"px"}).transition().duration(b.transitions.duration()).attr("width",b.pictograph_image_width+"px"),setTimeout(function(){var a=d3.selectAll("#total_image"+f);a&&a.remove()},b.transitions.duration())):(f>b.old_weight&&b.weight>b.old_weight||b.old_data&&f<=b.old_data[1].weight)&&b.group.append("image").attr({"xlink:href":b.data[0].image,id:"total_image"+f,x:c*(b.pictograph_image_width+1),y:a*(b.pictograph_image_height+10),width:0,height:b.pictograph_image_height+"px"}).transition().duration(b.transitions.duration()).attr("width",b.pictograph_image_width+"px"),d++,c++,d>=b.pictograph_image_per_line&&(a++,c=0,d=0);var g=b.group.node().getBBox().height;f===+b.weight&&0!=g?(b.chart_height=g,b.svgContainer.attr({height:g,viewBox:"0 0 "+b.chart_width+" "+g})):b.svgContainer.attr({height:g,viewBox:"0 0 "+b.chart_width+" "+b.chart_height})}return setTimeout(function(){if(b.old_data&&b.old_data[1].weight>b.data[1].weight)for(var a=b.old_data[1].weight;a>b.data[1].weight;a--){var c=d3.selectAll("#current_image"+a);c&&c.remove()}if(b.old_data&&b.old_data[0].weight>b.data[0].weight)for(var a=b.old_data[0].weight;a>b.data[0].weight;a--){var d=d3.selectAll("#total_image"+a);d&&d.remove()}},b.transitions.duration()),b.pictograph_image_width*b.pictograph_image_per_line+e>b.chart_width&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px","Your Lable text size and image width exceeds the chart conatiner width"),this},showTotal:function(){return b.weight=PykCharts["boolean"](b.pictograph_show_all_images)?b.data[0].weight:b.data[1].weight,this},enableLabel:function(){if(PykCharts["boolean"](b.pictograph_total_count_enable)){var a=d3.selectAll(b.selector+" .PykCharts-current-text");a.length>0&&a.remove(),b.textWidth||(b.textWidth=0);{b.data[0].weight/b.pictograph_image_per_line}b.group1.append("text").attr({"class":"PykCharts-current-text","font-family":b.pictograph_total_count_family,"font-size":b.pictograph_total_count_size,"font-weight":b.pictograph_total_count_weight,fill:b.pictograph_total_count_color}).text("/"+b.data[0].weight).text(function(){return b.textHeight=this.getBBox().height,b.totalTxtWeight=this.getBBox().width,"/"+b.data[0].weight}).attr({x:b.textWidth+5,y:function(){return b.textHeight-10}})}return this},labelText:function(){if(PykCharts["boolean"](b.pictograph_current_count_enable)){var a=d3.selectAll(b.selector+" .PykCharts-total-text");a.length>0&&a.remove();{b.data[0].weight/b.pictograph_image_per_line}b.group1.append("text").attr({x:0,"class":"PykCharts-total-text","font-family":b.pictograph_current_count_family,"font-size":b.pictograph_current_count_size,"font-weight":b.pictograph_current_count_weight,fill:b.pictograph_current_count_color}).text(b.data[1].weight).text(function(){return b.textHeight=this.getBBox().height,b.textWidth=this.getBBox().width,b.data[1].weight}).attr("y",function(){return b.textHeight-10})}return this},appendUnits:function(){b.textHeight||(b.textHeight=0);var a,c,d,e;return b.group2.attr("transform","translate(0,"+(b.textHeight+15)+")"),b.group2.append("text").attr({x:0,"class":"PykCharts-unit-text","font-family":b.pictograph_units_per_image_text_family,"font-size":b.pictograph_units_per_image_text_size,"font-weight":b.pictograph_units_per_image_text_weight,fill:b.pictograph_units_per_image_text_color}).text(function(){return"1 "}).text(function(){return e=this.getBBox().height,a=this.getBBox().width,"1 "}).attr({dy:0,y:e-5}),b.group2.append("image").attr({"xlink:href":b.data[1].image,id:"unit-image",x:a+2+"px",y:0,height:e+"px",width:e+"px"}),c=d3.select(b.selector+" #unit-image").attr("width"),b.group2.append("text").attr({x:function(){return parseFloat(c)+a+4},"class":"PykCharts-unit-text","font-family":b.pictograph_units_per_image_text_family,"font-size":b.pictograph_units_per_image_text_size,"font-weight":b.pictograph_units_per_image_text_weight,fill:b.pictograph_units_per_image_text_color}).text(function(){return"= "+b.pictograph_units_per_image}).text(function(){return d=this.getBBox().width,"= "+b.pictograph_units_per_image}).attr("y",function(){return e-5}),b.total_unit_width=a+parseFloat(c)+d+4,this}};return a}},PykCharts.multiD={};var theme=new PykCharts.Configuration.Theme({});PykCharts.multiD.configuration=function(a){var b=(new PykCharts.Configuration.fillChart(a),{opacity:function(b,c,d){if(PykCharts["boolean"](a.variable_circle_size_enable))return.8;var e=d3.scale.linear().domain(d3.extent(d,function(a){return a.weight})).range([.3,1]);return e(b?b:Math.min.apply(null,c))},legendsPosition:function(a,b,c,d,e){var f,g=0,h=0;if("vertical"===a.legends_display){a.legendsGroup.attr("height",30*c.length+20),a.legendsGroup_height=0,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,k=function(){return 36},l=function(){return 20};var i=function(a,b){return 24*b+12},j=function(a,b){return 24*b+23}}else if("horizontal"===a.legends_display){a.legendsGroup_height=50,temp_i=g,final_rect_x=0,final_text_x=0,legend_text_widths=[],sum_text_widths=0,temp_text=temp_rect=0,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var k=function(a,b){return legend_text_widths[b]=this.getBBox().width,legend_start_x=16,final_text_x=0===b?legend_start_x:legend_start_x+temp_text,temp_text=temp_text+legend_text_widths[b]+30,final_text_x};j=30,rect_parameter1value=13,rect_parameter2value=13;var l=function(a,b){return final_rect_x=0===b?0:temp_rect,temp_rect=temp_rect+legend_text_widths[b]+30,final_rect_x};i=18}if("scatter"===b)if("yes"===a.panels_enable){var m=[];m.push(a.map_group_data[0][e]),f=a.legendsGroup.selectAll("rect").data(m),a.legends_text=a.legendsGroup.selectAll(".legends_text").data(m)}else f=a.legendsGroup.selectAll("rect").data(a.map_group_data[0]),a.legends_text=a.legendsGroup.selectAll(".legends_text").data(a.map_group_data[0]);else f=a.legendsGroup.selectAll(".legends-rect").data(c),a.legends_text=a.legendsGroup.selectAll(".legends_text").data(c);a.legends_text.enter().append("text"),a.legends_text.attr("class","legends_text").attr("pointer-events","none").text(function(a){switch(b){case"groupColumn":case"groupBar":return a;case"spiderWeb":case"scatter":return a.group;case"stackedArea":return a.name}}).attr("fill",a.legends_text_color).attr("font-family",a.legends_text_family).style("font-size",a.legends_text_size+"px").attr("font-weight",a.legends_text_weight).attr(text_parameter1,k).attr(text_parameter2,j),f.enter().append("rect"),f.attr("class","legends-rect").attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,l).attr(rect_parameter4,i).attr("fill",function(c,e){switch(b){case"groupColumn":case"groupBar":return"color"===a.color_mode?d[e]:a.saturation_color;case"spiderWeb":case"scatter":return a.fillChart.colorPieW(c);case"stackedArea":return a.fillColor.colorPieMS(c,a.type)}}).attr("fill-opacity",function(c,d){switch(b){case"groupColumn":case"groupBar":if("saturation"===a.color_mode)return(d+1)/a.no_of_groups;break;case"spiderWeb":return.6;case"scatter":return 1;case"stackedArea":if("saturation"===a.color_mode)return(d+1)/a.new_data.length}});var h,n=a.legendsGroup.node().getBBox().width;a.legendsGroup_width="vertical"===a.legends_display?n+20:0,h="scatter"===b?"vertical"===a.legends_display?a.w-a.legendsGroup_width:PykCharts["boolean"](a.panels_enable)?a.chart_margin_left:a.chart_width-n-20:"vertical"===a.legends_display?a.chart_width-a.legendsGroup_width:a.chart_width-n-20,n<a.chart_width&&a.legendsGroup.attr("transform","translate("+h+",10)"),a.legendsGroup.style("visibility","visible"),a.legends_text.exit().remove(),f.exit().remove()},mapGroup:function(b){for(var c=[],d={},e=[],f=[],g={},h=[],i=0,j=!0,k=!0,l=0;l<b.length;l++)e[l]=b[l].group;f=a.k.__proto__._unique(e);for(var l=0;l<f.length;l++)g[f[l]]=[];for(var m in g)for(var n=0;n<b.length;n++)m===b[n].group&&g[m].push(b[n]);for(var m in g)for(var l=0;l<g[m].length;l++)h.push(g[m][l]);if(b=h,b.forEach(function(b){b.group?j=!0:(j=!1,a.chart_color?(j=!1,b.color=a.chart_color[0]):b.color?(k=!1,b.color=b.color):(k=!1,b.color=a.default_color[0]))}),l=0,j){b.forEach(function(e){!d[e.group]&&e.color?(d[e.group]=e,e.color=0!==a.chart_color.length&&PykCharts["boolean"](a.chart_color[i])?a.chart_color[i]:e.color?e.color:a.default_color,l<b.length-2&&e.group!==b[l+1].group&&i++,c.push(e)):l<b.length-2&&e.group!==b[l+1].group&&i++,l++}),i=0,l=0,b.forEach(function(e){d[e.group]?l<b.length-2&&e.group!==b[l+1].group&&i++:(d[e.group]=e,e.color=0!==a.chart_color.length&&PykCharts["boolean"](a.chart_color[i])?a.chart_color[i]:a.default_color,l<b.length-2&&e.group!==b[l+1].group&&i++,c.push(e)),l++});var o=[];i=0,c.forEach(function(a){o.push(a)});for(var p=o.length,q=b.length,l=0;p>l;l++)for(var n=0;q>n;n++)b[n].group===o[l].group&&(b[n].color=o[l].color);return[o,j]}return[b,j]}});return b},PykCharts.multiD.bubbleSizeCalculation=function(a,b,c){var d=function(d){if(d&&PykCharts["boolean"](a.variable_circle_size_enable)){var e=d3.scale.linear().domain(d3.extent(b,function(a){return a.weight})).range(c);return e(d)}return a.bubbleRadius};return d},PykCharts.multiD.sortDataByGroup=function(a){return a.sort(function(a,b){return a.group<b.group?-1:a.group>b.group?1:void 0}),a},PykCharts.annotation=function(a){a.k.annotation=function(b,c,d,e){var f=a.legendsGroup_height?a.legendsGroup_height:0;if("onclick"===a.annotation_view_mode){var g=d3.select(b).selectAll(".PykCharts-annotation-circle").data(c),h=d3.select(b).selectAll(".PykCharts-annotation-text").data(c);g.enter().append("circle").attr("class","PykCharts-annotation-circle"),g.attr("r",0),setTimeout(function(){g.attr("cx",function(b){return parseInt(d(b.x))+a.extra_left_margin+a.chart_margin_left}).attr("cy",function(b){return parseInt(e(b.y))-15+a.chart_margin_top+f}).attr("r","7").style("cursor","pointer").on("click",function(b){d3.selectAll(".pyk-tooltip").style("display","none"),a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(b.annotation)}).on("mouseover",function(b){a.mouseEvent.tooltipHide(b,a.panels_enable,"multilineChart")}).attr("fill",a.annotation_background_color)},a.transitions.duration()),g.exit().remove()}else if("onload"===a.annotation_view_mode){var i=[],j=[],k=d3.select(b).selectAll(".annotation-rect").data(c);k.enter().append("rect").attr("class","annotation-rect");var h=d3.select(b).selectAll(".annotation-text").data(c);h.enter().append("text").attr("class","annotation-text"),h.text(function(){return""}),k.attr("width",0).attr("height",0),setTimeout(function(){h.attr("x",function(b){return parseInt(d(b.x)-5)+a.extra_left_margin+a.chart_margin_left}).attr("y",function(b){return parseInt(e(b.y)-18+a.chart_margin_top+f)}).attr("text-anchor","middle").style("font-size","12px").text(function(a){return a.annotation}).text(function(a,b){return i[b]=this.getBBox().width+20,j[b]=this.getBBox().height+10,a.annotation}).attr("fill",a.annotation_font_color).style("pointer-events","none"),k.attr("x",function(b,c){return parseInt(d(b.x)-5)+a.extra_left_margin+a.chart_margin_left-i[c]/2}).attr("y",function(b,c){return parseInt(e(b.y)-10+a.chart_margin_top)+f-j[c]}).attr("width",function(a,b){return i[b]}).attr("height",function(a,b){return j[b]}).attr("fill",a.annotation_background_color).style("pointer-events","none")},a.transitions.duration()),h.exit().remove(),k.exit().remove()}return this}},PykCharts.crossHair=function(a){a.k.crossHair=function(b,c,d,e,f){if(PykCharts["boolean"](a.crosshair_enable)&&"default"===a.mode)for(PykCharts.Configuration.cross_hair_v=b.append("line").attr({"class":"line-cursor",id:"cross-hair-v"}),PykCharts.Configuration.cross_hair_h=b.append("line").attr({"class":"line-cursor",id:"cross-hair-h"}).style("display","none"),j=0;c>j;j++)PykCharts.Configuration.focus_circle=b.append("g").attr({"class":"focus",id:"f_circle"+j}).style("display","none"),PykCharts.Configuration.focus_circle.append("circle").attr({fill:function(){return e.colorPieMS(d[j],f)},id:"focus-circle"+j,r:"6"});return this}},PykCharts.grid=function(a){a.k.yGrid=function(b,c,d,e){a.chart_width,a.chart_height;if(PykCharts["boolean"](a.chart_grid_y_enable)){var f=PykCharts.Configuration.makeYGrid(a,d,e);c.selectAll(a.selector+" g.y.grid-line").style("stroke",function(){return a.chart_grid_color}).call(f)}return this},a.k.xGrid=function(b,c,d,e){a.chart_width,a.chart_height;if(PykCharts["boolean"](a.chart_grid_x_enable)){var f=PykCharts.Configuration.makeXGrid(a,d,e);c.selectAll(a.selector+" g.x.grid-line").style("stroke",function(){return a.chart_grid_color}).call(f)}return this}},PykCharts.Configuration.makeXGrid=function(a,b,c){c||(c=0);var d=d3.svg.axis().scale(b).orient("bottom").ticks(a.axis_x_no_of_axis_value).tickFormat("").tickSize(a.chart_height-a.chart_margin_top-a.chart_margin_bottom-c).outerTickSize(0);return d3.selectAll(a.selector+" .x.axis .tick text").attr("font-size",a.axis_x_pointer_size+"px").style({"font-weight":a.axis_x_pointer_weight,"font-family":a.axis_x_pointer_family}),d},configuration.makeYGrid=function(a,b,c){var d;c||(c=0),d=PykCharts["boolean"](a.panels_enable)?a.w-a.chart_margin_left-a.chart_margin_right-c:a.chart_width-a.chart_margin_left-a.chart_margin_right-c;var e=d3.svg.axis().scale(b).orient("left").ticks(a.axis_y_no_of_axis_value).tickSize(-d).tickFormat("").outerTickSize(0);return d3.selectAll(a.selector+" .y.axis .tick text").attr("font-size",a.axis_y_pointer_size+"px").style({"font-weight":a.axis_y_pointer_weight,"font-family":a.axis_y_pointer_family}),e},PykCharts.scaleFunction=function(a){var b=a.k.__proto__._isNumber;a.k.scaleIdentification=function(a,b,c,d){var e;switch(a){case"ordinal":return e=d3.scale.ordinal().domain(b).rangeRoundBands(c,d);case"linear":return e=d3.scale.linear().domain(b).range(c);case"time":return e=d3.time.scale().domain(b).range(c)}},a.k.ordinalXAxisTickFormat=function(b,c){for(var d,e,f=d3.selectAll(a.selector+" g.x.axis .tick text")[0],g=f.length,h=0,i=2*c,j=0;g>j;j++)h=f[j].getBBox().width>h?f[j].getBBox().width:h;i>=h+10?e=1:i>=.75*h&&h>i?e=2:i>=.65*h&&.75*h>i?e=3:i>=.55*h&&.65*h>i?e=4:i>=.35*h&&.55*h>i?e=5:(20>=i||.35*h>i)&&(e=0);for(var j=0;g>j;j++)d=f[j].__data__,0===e?(d="",d3.selectAll(a.selector+" .x.axis .tick").remove()):i>=f[j].getBBox().width+10&&1===e||(i>=.75*f[j].getBBox().width&&i<f[j].getBBox().width&&2===e?d=d.substr(0,5)+"..":i>=.65*f[j].getBBox().width&&i<.75*f[j].getBBox().width&&3===e?d=d.substr(0,4)+"..":4===e?d=d.substr(0,3):5===e&&(d=d.substr(0,2))),d3.select(f[j]).text(d);return xaxistooltip=d3.selectAll(a.selector+" g.x.axis .tick text").data(b),"default"===a.mode&&xaxistooltip.on("mouseover",function(b){a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(b)}).on("mousemove",function(b){a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(b)}).on("mouseout",function(b){a.mouseEvent.tooltipHide(b)}),this},a.k.ordinalYAxisTickFormat=function(b){var c,d=d3.selectAll(a.selector+" g.y.axis .tick text")[0],e=d.length;for(i=0;e>i;i++)c=d[i].textContent,d[i].getBBox().width>.9*a.chart_margin_left&&(c=c.substr(0,3)+".."),d3.select(d[i]).text(c);return yaxistooltip=d3.selectAll(a.selector+" g.y.axis .tick text").data(b),"default"===a.mode&&yaxistooltip.on("mouseover",function(b){a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(b)}).on("mousemove",function(b){a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(b)}).on("mouseout",function(b){a.mouseEvent.tooltipHide(b)}),this},a.k.xAxis=function(b,c,d,e,f,g,h,i,j){if(PykCharts["boolean"](a.axis_x_enable)){{a.chart_width,a.chart_height}void 0===h&&(h=0),d3.selectAll(a.selector+" .x.axis").attr("fill",function(){return j&&void 0!=j.axis_x_pointer_color&&""!=j.axis_x_pointer_color?j.axis_x_pointer_color:a.axis_x_pointer_color}),"bottom"===a.axis_x_position&&c.attr("transform","translate(0,"+(a.chart_height-a.chart_margin_top-a.chart_margin_bottom-h)+")");var k=PykCharts.Configuration.makeXAxis(a,d);g&&g.length&&k.tickValues(g),c.style("stroke",function(){return a.axis_x_line_color}).call(k),"string"===a.axis_x_data_format&&"no"===a.panels_enable&&a.k.ordinalXAxisTickFormat(f,e),d3.selectAll(a.selector+" .x.axis .tick text").attr("font-size",a.axis_x_pointer_size).style({"font-weight":a.axis_x_pointer_weight,"font-family":a.axis_x_pointer_family}),i&&"string"!==a.axis_x_data_format&&d3.selectAll(a.selector+" .x.axis .domain").remove()}return this},a.k.yAxis=function(b,c,d,e,f,g,h,i,j){if(PykCharts["boolean"](a.axis_y_enable)){g||(g=0);var k=(a.chart_width,a.chart_height,PykCharts["boolean"](a.panels_enable)?a.w:a.chart_width);"right"===a.axis_y_position&&c.attr("transform","translate("+(k-a.chart_margin_left-a.chart_margin_right-g)+",0)"),d3.selectAll(a.selector+" .y.axis").attr("fill",function(){return j&&void 0!=j.axis_y_pointer_color&&""!=j.axis_y_pointer_color?j.axis_y_pointer_color:a.axis_y_pointer_color});var l=PykCharts.Configuration.makeYAxis(a,d,i);f&&f.length&&l.tickValues(f);{new PykCharts.Configuration.mouseEvent(a)}c.style("stroke",function(){return a.axis_y_line_color}).call(l),"string"===a.axis_y_data_format&&"no"===a.panels_enable&&a.k.ordinalYAxisTickFormat(e),d3.selectAll(a.selector+" .y.axis .tick text").attr("font-size",a.axis_y_pointer_size).style({"font-weight":a.axis_y_pointer_weight,"font-family":a.axis_y_pointer_family}),h&&"string"!==a.axis_y_data_format&&d3.selectAll(a.selector+" .y.axis .domain").remove()}return this},a.k.xAxisTitle=function(b,c,d){if(a.axis_x_title){var e,f=PykCharts["boolean"](a.panels_enable)?a.w:a.chart_width;c||(c=0),d||(d=0),PykCharts["boolean"](a.axis_x_enable)||b.attr("transform","translate(0,"+(a.chart_height-a.chart_margin_top-a.chart_margin_bottom-c)+")"),"bottom"===a.axis_x_position?e=a.chart_margin_bottom:"top"===a.axis_x_position&&(e=-a.chart_margin_top+a.axis_x_title_size),b.append("text").attr({"class":"x-axis-title",x:(f-a.chart_margin_left-a.chart_margin_right-d)/2,y:e}).style({"text-anchor":"middle",fill:a.axis_x_title_color,"font-weight":a.axis_x_title_weight,"font-size":a.axis_x_title_size}).text(a.axis_x_title)}return this},a.k.yAxisTitle=function(b){if(a.axis_y_title){{var c,d;PykCharts["boolean"](a.panels_enable)?a.w:a.chart_width}"left"===a.axis_y_position?(c=-(a.chart_margin_left-a.axis_y_title_size),d=0):"right"===a.axis_y_position&&(c=a.chart_margin_right-a.axis_y_title_size,d="0.71em"),b.append("text").attr({"class":"y-axis-title",x:-((a.chart_height-a.chart_margin_bottom-a.chart_margin_top)/2),transform:"rotate(-90)",y:c,dy:d}).style({fill:a.axis_y_title_color,"font-weight":a.axis_y_title_weight,"font-family":a.axis_y_title_family,"font-size":a.axis_y_title_size,"text-anchor":"middle"}).text(a.axis_y_title)}return this},a.k.isOrdinal=function(b,c,d,e,f){return".x.axis"===c&&PykCharts["boolean"](a.axis_x_enable)?(b.select(c).call(PykCharts.Configuration.makeXAxis(a,d)),"string"===a.axis_x_data_format&&"no"===a.panels_enable&&a.k.ordinalXAxisTickFormat(e,f)):".x.grid"===c?b.select(c).call(PykCharts.Configuration.makeXGrid(a,d)):".y.axis"===c&&PykCharts["boolean"](a.axis_y_enable)?(b.select(c).call(PykCharts.Configuration.makeYAxis(a,d)),"string"===a.axis_y_data_format&&"no"===a.panels_enable&&a.k.ordinalyAxisTickFormat(e)):".y.grid"===c&&b.select(c).call(PykCharts.Configuration.makeYGrid(a,d)),this},a.k.xAxisDataFormatIdentification=function(a){return b(a[0].x)||!isNaN(a[0].x)?"number":isNaN(new Date(a[0].x).getTime())?"string":"time"},a.k.yAxisDataFormatIdentification=function(a){return b(a[0].y)||!isNaN(a[0].y)?"number":isNaN(new Date(a[0].y).getTime())?"string":"time"},a.k.processXAxisTickValues=function(){var c=[],d=[],e=a.axis_x_pointer_values.length;if(e)for(var f=0;e>f;f++)"number"===a.axis_x_data_format?!b(a.axis_x_pointer_values[f])&&isNaN(a.axis_x_pointer_values[f])||""==a.axis_x_pointer_values[f]||c.push(parseFloat(a.axis_x_pointer_values[f])):"time"===a.axis_x_data_format&&(isNaN(new Date(a.axis_x_pointer_values[f]).getTime())||c.push(a.axis_x_pointer_values[f]));if(c.length){var g=c.length;if("time"===a.axis_x_data_format)for(var f=0;g>f;f++)d.push(a.k.dateConversion(c[f]));else d=c}return d},a.k.processYAxisTickValues=function(){var c=a.axis_y_pointer_values.length,d=[];if(c)for(var e=0;c>e;e++)"number"===a.axis_y_data_format&&(!b(a.axis_y_pointer_values[e])&&isNaN(a.axis_y_pointer_values[e])||""==a.axis_y_pointer_values[e]||d.push(a.axis_y_pointer_values[e]));return d}};var configuration=PykCharts.Configuration;configuration.makeXAxis=function(c,d){var e=(PykCharts.Configuration(c),d3.svg.axis().scale(d).tickSize(c.axis_x_pointer_length).outerTickSize(c.axis_x_outer_pointer_length).tickFormat(function(a){return"yes"===c.panels_enable&&"string"===c.axis_x_data_format?a.substr(0,2):a}).tickPadding(c.axis_x_pointer_padding).orient(c.axis_x_pointer_position));if(d3.selectAll(c.selector+" .x.axis .tick text").attr("font-size",c.axis_x_pointer_size+"px").style({"font-weight":c.axis_x_pointer_weight,"font-family":c.axis_x_pointer_family}),"time"===c.axis_x_data_format&&PykCharts["boolean"](c.axis_x_time_value_datatype)){switch(c.axis_x_time_value_datatype){case"month":a=d3.time.month,b="%b";break;case"date":a=d3.time.day,b="%d";break;case"year":a=d3.time.year,b="%Y";break;case"hours":a=d3.time.hour,b="%H";break;case"minutes":a=d3.time.minute,b="%M"}e.ticks(a,c.axis_x_time_value_interval).tickFormat(d3.time.format(b))}else"number"===c.axis_x_data_format&&e.ticks(c.axis_x_no_of_axis_value);return e},configuration.makeYAxis=function(a,b,c){var d=(PykCharts.Configuration(a),d3.svg.axis().scale(b).orient(a.axis_y_pointer_position).tickSize(a.axis_y_pointer_length).outerTickSize(a.axis_y_outer_pointer_length).tickPadding(a.axis_y_pointer_padding).tickFormat(function(a){return c?c(a):a}));return d3.selectAll(a.selector+" .y.axis .tick text").attr("font-size",a.axis_y_pointer_size+"px").style({"font-weight":a.axis_y_pointer_weight,"font-family":a.axis_y_pointer_family}),"number"===a.axis_y_data_format&&d.ticks(a.axis_y_no_of_axis_value),d},PykCharts.crossHairMovement=function(a){var b=this,c=PykCharts.Configuration.mouseEvent(a);return b.tooltip=configuration.tooltipp,b.cross_hair_v=configuration.cross_hair_v,b.cross_hair_h=configuration.cross_hair_h,b.focus_circle=configuration.focus_circle,b.pt_circle=configuration.pt_circle,b.start_pt_circle=configuration.start_pt_circle,c.crossHairPosition=function(b,c,d,e,f,g,h,j,k,l,m){if((PykCharts["boolean"](a.crosshair_enable)||PykCharts["boolean"](a.tooltip_enable)||PykCharts["boolean"](a.axis_onhover_highlight_enable))&&"default"===a.mode){var n=a.k.__proto__._offset,o=document.querySelector(a.selector+" #"+e[0][0][0].parentNode.parentNode.id),p=0,q=0;PykCharts["boolean"](k)?(p=1,height_percentge=1):(p=parseFloat(d3.select(o).style("width"))/a.chart_width,q=parseFloat(d3.select(o).style("height"))/a.chart_height);var r=a.legendsGroup_height?a.legendsGroup_height:0,s=(a.chart_margin_left+f)*p+n(o).left,t=n(o).top,u=b.length,v=a.chart_margin_left,w=(a.chart_margin_right,a.chart_margin_top),x=a.chart_margin_bottom,y=(a.chart_width,a.chart_height),z=parseInt(PykCharts.getEvent().target.id.substr(PykCharts.getEvent().target.id.length-1,1)),A=PykCharts.getEvent().pageX-s,B=PykCharts.getEvent().pageY-t-w,C=[];if("string"===a.axis_x_data_format)C=c.range();else for(temp=c.range(),pad=(temp[1]-temp[0])/(b[0].data.length-1),len=b[0].data.length,strt=0,i=0;len>i;i++)C[i]=strt,strt+=pad;var D,E,F,G,H,I,J,K,L=d.range(),M=(L.length,[]),N=[],O=C.length;for(D=0;O>D;D++){if(D+1>=O)return!1;if(I===C[D]&&J===C[D+1]&&K===L[0])return!1;if(A>=p*C[D]&&A<=p*C[D+1]&&B<L[0]+r){switch(J=p*C[D],I=p*C[D+1],K=L[0],F=J-A,G=A-I,F>=G?(E=b[0].data[D].x,M.push(b[0].data[D].y),tooltipText=b[0].data[D].tooltip||b[0].data[D].y):(E=b[0].data[D+1].x,M.push(b[0].data[D+1].y),tooltipText=b[0].data[D+1].tooltip||b[0].data[D+1].y),H=c(E)+f+v,N=d(tooltipText)+w,h){case"multi_series_line":var P=[];d3.selectAll(a.selector+" #pyk-tooltip").classed({"pyk-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var Q=b[0].data.length,R="";M=[];for(var S=0;u>S;S++)for(var T=0;Q>T;T++)cond="time"===a.axis_x_data_format?Date.parse(E)===Date.parse(b[S].data[T].x):b[S].data[T].x===E,cond&&(M.push(b[S].data[T].y),P.push(d(b[S].data[T].y)+w),R+="<tr><td>"+b[S].name+"</td><td><b>"+(b[S].data[T].tooltip||b[S].data[T].y)+"</b></td></tr>");H+=6,tooltipText="<table><thead><th colspan='2'>"+E+"</th></thead><tbody>"+R+"</tbody></table>",PykCharts["boolean"](a.tooltip_enable)&&(this.tooltipPosition(tooltipText,H,B,60,-15,z,p,q,h),this.tooltipTextShow(tooltipText)),a.crosshair_enable?this.crossHairShowMultipleline(H,w,H,y-x,H,P,b):null;break;case"panels_of_line":H+=5;for(var Q=b[0].data.length,U=y,V=0,W=0,S=0;u>S;S++)for(var X=n(document.querySelector(a.selector)),Y=n(document.querySelector(a.selector+" #"+l+"-"+S)),Z=Y.left-X.left,T=(Y.top-X.top,0);Q>T;T++)cond="time"===a.axis_x_data_format?Date.parse(E)===Date.parse(b[S].data[T].x):b[S].data[T].x===E,cond&&(M.push(b[S].data[T].y),tooltipText=b[S].data[T].tooltip||b[S].data[T].y,S%m==0&&0!=S&&(++V,W=U*V),N=d(b[S].data[T].y)+w,this.tooltipPosition(tooltipText,H+Z-15-30,N+W,-15,-15,S,p,q,h),this.tooltipTextShow(tooltipText,h,S),a.crosshair_enable?this.crossHairShowPanelOfLine(H,w,H,y-x,H,N,S,l):null);break;case"lineChart":case"areaChart":PykCharts["boolean"](a.tooltip_enable)&&("fixed"===a.tooltip_mode.toLowerCase()?this.tooltipPosition(tooltipText,-a.chart_margin_left,N,-14,23,z,p,q,h):"moving"===a.tooltip_mode.toLowerCase()&&this.tooltipPosition(tooltipText,H-a.chart_margin_left+10,N-5,0,-45,z,p,q,h),this.tooltipTextShow(tooltipText)),a.crosshair_enable?this.crossHairShowLineArea(H,w,H,y-x,H,N):null;break;case"stackedAreaChart":var P=[];d3.selectAll(a.selector+" #pyk-tooltip").classed({"pyk-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var Q=b[0].data.length,R="";M=[];for(var S=0;u>S;S++)for(var T=0;Q>T;T++)cond="time"===a.axis_x_data_format?Date.parse(E)===Date.parse(b[S].data[T].x):b[S].data[T].x===E,cond&&(M.push(b[S].data[T].y),P.push(d(b[S].data[T].y+b[S].data[T].y0)+w+a.legendsGroup_height),R+="<tr><td>"+b[S].name+"</td><td><b>"+(b[S].data[T].tooltip||b[S].data[T].y)+"</b></td></tr>");H+=6,tooltipText="<table><thead><th colspan='2'>"+E+"</th></thead><tbody>"+R+"</tbody></table>",PykCharts["boolean"](a.tooltip_enable)&&(z=1,this.tooltipPosition(tooltipText,H,B,60,70,z,p,q),this.tooltipTextShow(tooltipText)),a.crosshair_enable?this.crossHairShowStackedArea(H,w+r,H,y-x,H,P,b):null}PykCharts["boolean"](k)||(this.axisHighlightShow(M,a.selector+" .y.axis",g),this.axisHighlightShow(E,a.selector+" .x.axis",g))}}}},c.crossHairShowLineArea=function(c,d,e,f,g,h){return PykCharts["boolean"](a.crosshair_enable)&&(d3.selectAll(a.selector+" .line-cursor").style("display","block"),d3.select(a.selector+" #cross-hair-v").attr({x1:c,y1:d,x2:e,y2:f}),d3.select(a.selector+" #cross-hair-h").attr({x1:a.chart_margin_left,y1:h,x2:a.chart_width-a.chart_margin_right,y2:h}),b.focus_circle.style("display","block").attr("transform","translate("+g+","+h+")")),this},c.crossHairShowMultipleline=function(c,d,e,f,g,h,i){if(PykCharts["boolean"](a.crosshair_enable)){b.cross_hair_v.style("display","block"),d3.select(a.selector+" #cross-hair-v").attr({x1:c-5,y1:d,x2:e-5,y2:f});for(var j=0;j<i.length;j++)d3.select(a.selector+" #f_circle"+j).style("display","block").attr("transform","translate("+(g-3)+","+h[j]+")")}return this},c.crossHairShowPanelOfLine=function(b,c,d,e,f,g,h,i){return PykCharts["boolean"](a.crosshair_enable)&&(d3.selectAll(a.selector+" .line-cursor").style("display","block"),d3.selectAll(a.selector+" #cross-hair-v").attr({x1:b-5,y1:c,x2:d-5,y2:e}),d3.select(a.selector+" #"+i+"-"+h+" #cross-hair-h").attr({x1:a.chart_margin_left,y1:g,x2:a.w-a.chart_margin_right,y2:g}),d3.select(a.selector+" #"+i+"-"+h+" .focus").style("display","block").attr("transform","translate("+(f-5)+","+g+")")),this},c.crossHairShowStackedArea=function(b,c,d,e,f,g,h){if(PykCharts["boolean"](a.crosshair_enable)){d3.selectAll(a.selector+" .line-cursor").style("display","block"),d3.selectAll(a.selector+" #cross-hair-v").attr({x1:b-5,y1:c,x2:d-5,y2:e});for(var i=0;i<h.length;i++)d3.select(a.selector+" #f_circle"+i).style("display","block").attr("transform","translate("+(f-3)+","+g[i]+")")}return this},c.crossHairHide=function(c){return PykCharts["boolean"](a.crosshair_enable)&&(b.cross_hair_v.style("display","none"),"lineChart"===c||"areaChart"===c?(b.cross_hair_h.style("display","none"),b.focus_circle.style("display","none")):("multilineChart"===c||"stackedAreaChart"===c)&&(d3.selectAll(a.selector+" .line-cursor").style("display","none"),d3.selectAll(a.selector+" .focus").style("display","none"))),this},c.tooltipPosition=function(c,d,e,f,g,h,i,j,k){if(PykCharts["boolean"](a.tooltip_enable)||PykCharts["boolean"](a.annotation_enable)||"string"===a.axis_x_data_format||"string"===a.axis_y_data_format){if(void 0!==d){var l=a.k.__proto__._offset,m=a.selector.substr(1,a.selector.length),n=document.getElementById(m),o=(document.querySelector("#tooltip-svg-container-"+h+"-pyk-tooltip"+m)?parseFloat(d3.select("#tooltip-svg-container-"+h+"-pyk-tooltip"+m).style("width")):0,document.querySelector("#tooltip-svg-container-"+h+"-pyk-tooltip"+m)?parseFloat(d3.select("#tooltip-svg-container-"+h+"-pyk-tooltip"+m).style("height")):0),p=d3.select("#tooltip-svg-container-"+h+"-pyk-tooltip"+m),q=l(n).left,r=l(n).top;if("lineChart"===k||"areaChart"===k)var s=e*j;else var s=e-o/2*j;p.style({display:"block",top:s+r+"px",left:(d+a.chart_margin_left)*i+q+"px"})}else b.tooltip.style({display:"block",top:PykCharts.getEvent().pageY-20+"px",left:PykCharts.getEvent().pageX+30+"px"});return b.tooltip}},c.tooltipTextShow=function(c,d,e){var f=a.selector.substr(1,a.selector.length);return PykCharts["boolean"](a.tooltip_enable)||PykCharts["boolean"](a.annotation_enable)||"string"===a.axis_x_data_format||"string"===a.axis_y_data_format?("panels_of_line"===d?d3.selectAll("#tooltip-svg-container-"+e+"-pyk-tooltip"+f).html(c):b.tooltip.html(c),this):void 0},c.tooltipHide=function(c,d,e){return PykCharts["boolean"](a.tooltip_enable)||PykCharts["boolean"](a.annotation_enable)||"string"===a.axis_x_data_format||"string"===a.axis_y_data_format?"yes"===d&&"multilineChart"===e?d3.selectAll(".pyk-tooltip").style("display","none"):b.tooltip.style("display","none"):void 0},c},PykCharts.multiD.line=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.crossHair(b),PykCharts.annotation(b),PykCharts.scaleFunction(b),PykCharts.grid(b),!b.stop){b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading();{var e=c.multiDimensionalCharts,f=c.stylesheet;a.optional}b.pointer_overflow_enable=a.pointer_overflow_enable?a.pointer_overflow_enable.toLowerCase():f.pointer_overflow_enable,b.crosshair_enable=a.crosshair_enable?a.crosshair_enable.toLowerCase():e.crosshair_enable,b.curvy_lines_enable=a.curvy_lines_enable?a.curvy_lines_enable.toLowerCase():e.curvy_lines_enable,b.interpolate=PykCharts["boolean"](b.curvy_lines_enable)?"cardinal":"linear",b.panels_enable="no",b.executeData=function(c){{var d=b.k.validator().validatingJSON(c);b.selector.substring(1,b.selector.length)}b.stop||d===!1||(b.data=b.k.__proto__._groupBy("line",c),b.axis_y_data_format="number",b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"string"===b.axis_x_data_format?b.data_sort_enable="no":(b.data_sort_enable="yes",b.data_sort_type="time"===b.axis_x_data_format?"date":"numerically",b.data_sort_order="ascending"),PykCharts.multiD.lineFunctions(a,b,"line"))
},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}}},PykCharts.multiD.multiSeriesLine=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.crossHair(b),PykCharts.annotation(b),PykCharts.scaleFunction(b),PykCharts.grid(b),!b.stop){b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading();{var e=c.multiDimensionalCharts,f=c.stylesheet;a.optional}b.pointer_overflow_enable=a.pointer_overflow_enable?a.pointer_overflow_enable.toLowerCase():f.pointer_overflow_enable,b.crosshair_enable=a.crosshair_enable?a.crosshair_enable.toLowerCase():e.crosshair_enable,b.curvy_lines_enable=a.curvy_lines_enable?a.curvy_lines_enable.toLowerCase():e.curvy_lines_enable,b.interpolate=PykCharts["boolean"](b.curvy_lines_enable)?"cardinal":"linear",b.panels_enable="no",b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);return b.stop||d===!1?void b.k.remove_loading_bar(e):(b.data=b.k.__proto__._groupBy("line",c),b.axis_y_data_format="number",b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"string"===b.axis_x_data_format?b.data_sort_enable="no":(b.data_sort_enable="yes",b.data_sort_type="time"===b.axis_x_data_format?"date":"numerically",b.data_sort_order="ascending"),void PykCharts.multiD.lineFunctions(a,b,"multi_series_line"))},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}}},PykCharts.multiD.panelsOfLine=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.crossHair(b),PykCharts.annotation(b),PykCharts.scaleFunction(b),PykCharts.grid(b),!b.stop){b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading();{var e=c.multiDimensionalCharts,f=c.stylesheet;a.optional}b.pointer_overflow_enable=a.pointer_overflow_enable?a.pointer_overflow_enable.toLowerCase():f.pointer_overflow_enable,b.crosshair_enable=a.crosshair_enable?a.crosshair_enable.toLowerCase():e.crosshair_enable,b.curvy_lines_enable=a.curvy_lines_enable?a.curvy_lines_enable.toLowerCase():e.curvy_lines_enable,b.interpolate=PykCharts["boolean"](b.curvy_lines_enable)?"cardinal":"linear",b.panels_enable="yes",b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);return b.stop||d===!1?void b.k.remove_loading_bar(e):(b.data=b.k.__proto__._groupBy("line",c),b.axis_y_data_format="number",b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"string"===b.axis_x_data_format?b.data_sort_enable="no":(b.data_sort_enable="yes",b.data_sort_type="time"===b.axis_x_data_format?"date":"numerically",b.data_sort_order="ascending"),void PykCharts.multiD.lineFunctions(a,b,"panels_of_line"))},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}}},PykCharts.multiD.lineFunctions=function(a,b,c){var d=b,e=d.selector.substring(1,d.selector.length);d.compare_data=d.data,d.data_length=d.data.length,d.k.remove_loading_bar(e),d.dataTransformation=function(){for(d.group_arr=[],d.new_data=[],d.ticks=[],d.x_arr=[],j=0;j<d.data_length;j++)d.group_arr[j]=d.data[j].name;d.uniq_group_arr=d.k.__proto__._unique(d.group_arr),d.uniq_color_arr=[];for(var a=d.uniq_group_arr.length,b=0;b<d.data_length;b++)d.x_arr[b]=d.data[b].x;var c=d.k.__proto__._unique(d.x_arr);for(b=0;a>b;b++)if(d.chart_color[b])d.uniq_color_arr[b]=d.chart_color[b];else{for(l=0;l<d.data_length;l++)if(d.uniq_group_arr[b]===d.data[l].name&&d.data[l].color){d.uniq_color_arr[b]=d.data[l].color;break}PykCharts["boolean"](d.uniq_color_arr[b])||(d.uniq_color_arr[b]=d.default_color[0])}for(d.flag=0,b=0;a>b;b++)for(d.new_data[b]={name:d.uniq_group_arr[b],data:[],color:d.uniq_color_arr[b]},l=0;l<d.data_length;l++)d.uniq_group_arr[b]===d.data[l].name&&d.new_data[b].data.push({x:d.data[l].x,y:d.data[l].y,tooltip:d.data[l].tooltip,annotation:d.data[l].annotation||""});d.new_data_length=d.new_data.length;for(var e=c.length,f=0;f<d.new_data_length;f++){for(var g=d.k.__proto__._unique(d.x_arr),h=d.new_data[f].data.length,i=0;h>i;i++)for(var b=0;e>b;b++)if(d.new_data[f].data[i].x==g[b]){g[b]=void 0;break}for(var k=0;e>k;k++)if(void 0!=g[k]){var m={x:g[k],y:0,tooltip:0,annotation:""};d.new_data[f].data.splice(k,0,m)}}for(var b=0;b<d.new_data_length;b++)d.new_data[b].data=d.k.__proto__._sortData(d.new_data[b].data,"x","name",d)},d.calculatePanelInRow=function(){var a,b=parseInt(d.k._getHighestParentsAttribute(d.selector,"width"));a=b?b:d3.select("body").style("width"),d.no_of_containers_in_row=Math.floor(parseInt(a)/d.chart_width),d.no_of_containers_in_row>d.new_data.length&&(d.no_of_containers_in_row=d.new_data.length),a<d.chart_width&&(d.no_of_containers_in_row=1)},d.render=function(){var b=d.selector.substring(1,d.selector.length);if(d.container_id=b+"_svg",d.dataLineGroup=[],d.clicked,d.multid=new PykCharts.multiD.configuration(d),d.fillColor=new PykCharts.Configuration.fillChart(d,null,a),d.transitions=new PykCharts.Configuration.transition(d),PykCharts["boolean"](d.panels_enable)&&(d.calculatePanelInRow(),d.new_width=d.no_of_containers_in_row*d.chart_width),"default"===d.mode){if(d.k.title(d.new_width),PykCharts["boolean"](d.panels_enable)){if(d.w=d.chart_width,d.chart_height=d.chart_height,d.chart_margin_left=d.chart_margin_left,d.chart_margin_right=d.chart_margin_right,d.k.backgroundColor(d).export(d,d.container_id+"-","lineChart",d.panels_enable,d.new_data,d.new_width).emptyDiv(d.selector).subtitle(d.new_width),d3.select(d.selector).append("div").attr("id","panels_of_line_main_div"),d.k.liveData(d),d.optionalFeature().chartType(),d.reducedWidth=d.w-d.chart_margin_left-d.chart_margin_right,d.reducedHeight=d.chart_height-d.chart_margin_top-d.chart_margin_bottom,d.fill_data=[],"time"===d.axis_x_data_format){for(i=0;i<d.new_data_length;i++)d.new_data[i].data.forEach(function(a){a.x=d.k.dateConversion(a.x)});d.data.forEach(function(a){a.x=d.k.dateConversion(a.x)})}d.renderPanelOfLines()}else{d.k.backgroundColor(d).export(d,"#"+d.container_id+"-1","lineChart").emptyDiv(d.selector).subtitle(),d.w=d.chart_width,d.reducedWidth=d.w-d.chart_margin_left-d.chart_margin_right,d.reducedHeight=d.chart_height-d.chart_margin_top-d.chart_margin_bottom;var e=d.selector.substr(1,d.selector.length);if(d3.selectAll("#tooltip-svg-container-1-pyk-tooltip"+e).remove(),d.k.liveData(d).makeMainDiv(d.selector,1).tooltip(!0,d.selector,1,d.flag),d.optionalFeature().chartType(),"time"===d.axis_x_data_format){for(i=0;i<d.new_data_length;i++)d.new_data[i].data.forEach(function(a){a.x=d.k.dateConversion(a.x)});d.data.forEach(function(a){a.x=d.k.dateConversion(a.x)})}try{if("multilineChart"===d.type&&"line"===c)throw"Invalid data in the JSON"}catch(f){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+d.selector+'."'+f+'"  Visit www.pykcharts.com/errors#error_6')}d.renderLineChart()}d.k.createFooter(d.new_width).lastUpdatedAt().credits().dataSource(),PykCharts["boolean"](d.annotation_enable)&&d.annotation()}else if("infographics"===d.mode)if(PykCharts["boolean"](d.panels_enable)){if(d.k.backgroundColor(d).export(d,"#"+d.container_id+"-","lineChart",d.panels_enable,d.new_data,d.new_width).emptyDiv(d.selector),d3.select(d.selector).append("div").attr("id","panels_of_line_main_div"),d.optionalFeature().chartType(),d.w=d.chart_width,d.chart_height=d.chart_height,"time"===d.axis_x_data_format){for(i=0;i<d.new_data_length;i++)d.new_data[i].data.forEach(function(a){a.x=d.k.dateConversion(a.x)});d.data.forEach(function(a){a.x=d.k.dateConversion(a.x)})}d.reducedWidth=d.w-d.chart_margin_left-d.chart_margin_right,d.reducedHeight=d.chart_height-d.chart_margin_top-d.chart_margin_bottom,d.fill_data=[],d.renderPanelOfLines()}else{if(d.k.backgroundColor(d).export(d,"#"+d.container_id+"-0","lineChart").emptyDiv(d.selector),d.w=d.chart_width,d.reducedWidth=d.w-d.chart_margin_left-d.chart_margin_right,d.reducedHeight=d.chart_height-d.chart_margin_top-d.chart_margin_bottom,d.k.makeMainDiv(d.selector,1),d.optionalFeature().chartType(),"time"===d.axis_x_data_format){for(i=0;i<d.new_data_length;i++)d.new_data[i].data.forEach(function(a){a.x=d.k.dateConversion(a.x)});d.data.forEach(function(a){a.x=d.k.dateConversion(a.x)})}try{if("multilineChart"===d.type&&"line"===c)throw"Invalid data in the JSON"}catch(f){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+d.selector+'."'+f+'"  Visit www.pykcharts.com/errors#error_6')}d.renderLineChart()}if(PykCharts["boolean"](d.panels_enable)){var g=d.k.resize(null,d.new_width);d.k.__proto__._ready(g),window.addEventListener("resize",function(){return d.calculatePanelInRow(),d.k.resize(null,d.new_width)})}else{var g=d.k.resize(d.svgContainer);d.k.__proto__._ready(g),window.addEventListener("resize",function(){return d.k.resize(d.svgContainer)})}},d.refresh=function(b){d.executeRefresh=function(a){d.data=d.k.__proto__._groupBy("line",a),d.data_length=d.data.length;var b=d.k.checkChangeInData(d.data,d.compare_data);d.compare_data=b[0];var c=b[1];if(d.dataTransformation(),(c||PykCharts["boolean"](d.zoom_enable)&&d.count>1&&d.count<=d.zoom_level||d.transition_duration)&&(d.k.lastUpdatedAt("liveData"),d.mouseEvent.tooltipHide(null,d.panels_enable,d.type),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis")),d.optionalFeature().hightLightOnload(),"time"===d.axis_x_data_format){for(var e=0;e<d.new_data_length;e++)d.new_data[e].data.forEach(function(a){a.x=d.k.dateConversion(a.x)});d.data.forEach(function(a){a.x=d.k.dateConversion(a.x)})}if(PykCharts["boolean"](d.panels_enable)){for(var e=0;e<d.previous_length;e++){var f=document.querySelector(d.selector+" #panels_of_line_main_div #chart-container-"+e);f.parentNode.removeChild(f)}d.renderPanelOfLines()}"multilineChart"!==d.type||PykCharts["boolean"](d.panels_enable)||(document.querySelector(d.selector+" #chart-container-1").innerHTML=null,d.renderLineChart()),"lineChart"===d.type&&(d.optionalFeature().createChart("liveData").ticks(),d.k.xAxis(d.svgContainer,d.xGroup,d.xScale,d.extra_left_margin,d.xdomain,d.x_tick_values).yAxis(d.svgContainer,d.yGroup,d.yScale,d.ydomain,d.y_tick_values).yGrid(d.svgContainer,d.group,d.yScale).xGrid(d.svgContainer,d.group,d.xScale),PykCharts["boolean"](d.annotation_enable)&&d.annotation())},PykCharts.boolean(d.interactive_enable)?(d.k.dataFromPykQuery(b),d.k.dataSourceFormatIdentification(d.data,d,"executeRefresh")):d.k.dataSourceFormatIdentification(a.data,d,"executeRefresh")},d.optionalFeature=function(){var a=d.selector.substring(1,d.selector.length),b={chartType:function(){for(var a=0;a<d.data_length;a++)for(var b=a+1;b<d.data_length;b++)if(d.data[a].x===d.data[b].x){d.type="multilineChart";break}return d.type=d.type||"lineChart",this},hightLightOnload:function(){if("multilineChart"===d.type&&d.new_data_length>0&&d.highlight)for(var a=0;a<d.uniq_group_arr.length;a++)d.new_data[a].highlight=d.highlight.toLowerCase()===d.uniq_group_arr[a].toLowerCase()?!0:!1;return this},svgContainer:function(b){var c=document.getElementById(a);return"multilineChart"!==d.type||c.classList.contains("PykCharts-line-chart")?"lineChart"!==d.type||c.classList.contains("PykCharts-line-chart")||(c.className+=" PykCharts-twoD PykCharts-line-chart"):c.className+=" PykCharts-twoD PykCharts-line-chart PykCharts-multi-series2D",d.svgContainer=d3.select(d.selector+" #chart-container-"+b).append("svg:svg").attr({id:d.container_id+"-"+b,width:d.w,height:d.chart_height,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+d.w+" "+d.chart_height}),PykCharts["boolean"](d.pointer_overflow_enable)&&!PykCharts["boolean"](d.panels_enable)&&d.svgContainer.style("overflow","visible"),this},createGroups:function(a){return d.group=d.svgContainer.append("g").attr({id:d.type+"-svg",transform:"translate("+d.chart_margin_left+","+d.chart_margin_top+")"}),PykCharts["boolean"](d.chart_grid_y_enable)&&d.group.append("g").attr({id:"ygrid","class":"y grid-line"}),PykCharts["boolean"](d.chart_grid_x_enable)&&d.group.append("g").attr({id:"xgrid","class":"x grid-line"}),d.clip=d.svgContainer.append("svg:clipPath").attr("id","clip"+a+d.selector).append("svg:rect").attr({width:d.reducedWidth,height:d.reducedHeight}),d.chartBody=d.svgContainer.append("g").attr({id:"clipPath","clip-path":"url(#clip"+a+d.selector+")",transform:"translate("+d.chart_margin_left+","+d.chart_margin_top+")"}),this},axisContainer:function(){return(PykCharts["boolean"](d.axis_x_enable)||d.axis_x_title)&&(d.xGroup=d.group.append("g").attr({id:"xaxis","class":"x axis"})),(PykCharts["boolean"](d.axis_y_enable)||d.axis_y_title)&&(d.yGroup=d.group.append("g").attr({id:"yaxis","class":"y axis"})),this},createChart:function(a,b){function c(a){d.dataLineGroup[a].transition().duration(d.transitions.duration()).attrTween("d",function(){var b=d3.scale.quantile().domain([0,1]).range(d3.range(1,u.length+1));return function(c){return d.chart_path(d.new_data[a].data.slice(0,b(c)))}})}function e(a){d.dataLineGroup[a].transition().duration(d.transitions.duration()).attrTween("d",function(){var b=d3.scale.quantile().domain([0,1]).range(d3.range(1,u.length+1));return function(c){return d.chart_path(d.new_data[a].data.slice(0,b(c)))}})}function f(){d.dataLineGroup[0].transition().duration(d.transitions.duration()).attrTween("d",function(){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,u.length+1));return function(b){return d.chart_path(u.slice(0,a(b)))}})}d.previous_length=d.new_data.length,d.x_tick_values=d.k.processXAxisTickValues(),d.y_tick_values=d.k.processYAxisTickValues();var g,h,i,k,l,m,o,p,q,r=[];if("number"===d.axis_y_data_format?(max=d3.max(d.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),min=d3.min(d.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),l=[min,max],h=d.k.__proto__._domainBandwidth(l,2),p=d3.min(d.y_tick_values),q=d3.max(d.y_tick_values),h[0]>p&&(h[0]=p),h[1]<q&&(h[1]=q),i=[d.reducedHeight,0],d.yScale=d.k.scaleIdentification("linear",h,i)):"string"===d.axis_y_data_format?(d.new_data[0].data.forEach(function(a){h.push(a.y)}),i=[0,d.reducedHeight],d.yScale=d.k.scaleIdentification("ordinal",h,i,0)):"time"===d.axis_y_data_format&&(h=d3.extent(d.data,function(a){return new Date(a.x)}),p=d3.min(d.y_tick_values,function(a){return new Date(a)}),q=d3.max(d.y_tick_values,function(a){return new Date(a)}),new Date(h[0])>new Date(p)&&(h[0]=p),new Date(h[1])<new Date(q)&&(h[1]=max__tick_value),i=[d.reducedHeight,0],d.yScale=d.k.scaleIdentification("time",h,i)),d.xdomain=[],"number"===d.axis_x_data_format?(max=d3.max(d.new_data,function(a){return d3.max(a.data,function(a){return+a.x})}),min=d3.min(d.new_data,function(a){return d3.min(a.data,function(a){return+a.x})}),g=[min,max],r=d.k.__proto__._domainBandwidth(g,2),m=d3.min(d.x_tick_values),o=d3.max(d.x_tick_values),r[0]>m&&(r[0]=m),r[1]<o&&(r[1]=o),k=[0,d.reducedWidth],d.xScale=d.k.scaleIdentification("linear",r,k),d.extra_left_margin=0,d.new_data[0].data.forEach(function(a){d.xdomain.push(+a.x)})):"string"===d.axis_x_data_format?(d.new_data[0].data.forEach(function(a){r.push(a.x)}),k=[0,d.reducedWidth],d.xScale=d.k.scaleIdentification("ordinal",r,k,0),d.extra_left_margin=d.xScale.rangeBand()/2,d.xdomain=d.xScale.domain()):"time"===d.axis_x_data_format&&(max=d3.max(d.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(d.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),r=[min,max],k=[0,d.reducedWidth],m=d3.min(d.x_tick_values,function(a){return a=d.k.dateConversion(a)}),o=d3.max(d.x_tick_values,function(a){return a=d.k.dateConversion(a)}),r[0]>m&&(r[0]=m),r[1]<o&&(r[1]=o),d.xScale=d.k.scaleIdentification("time",r,k),d.extra_left_margin=0,d.new_data[0].data.forEach(function(a){d.xdomain.push(a.x)})),d.count=1,d.zoom_event=d3.behavior.zoom(),"string"!==d.axis_y_data_format&&"string"!==d.axis_x_data_format?d.zoom_event.x(d.xScale).y(d.yScale).scale(d.count).on("zoom",d.zoomed):d.zoom_event.y(d.yScale).scale(d.count).on("zoom",d.zoomed),PykCharts["boolean"](d.zoom_enable)&&"default"===d.mode){PykCharts["boolean"](d.panels_enable)?(n=d.new_data_length,j=0):(n=2,j=1);for(var s=j;n>s;s++)d3.selectAll(d.selector+" #"+d.container_id+"-"+s).call(d.zoom_event),d3.selectAll(d.selector+" #"+d.container_id+"-"+s).on("wheel.zoom",null).on("mousewheel.zoom",null)}d.chart_path=d3.svg.line().x(function(a){return d.xScale(a.x)}).y(function(a){return d.yScale(a.y)}).interpolate(d.interpolate);var t="lineChart"===d.type?"lineChart":"yes"===d.panels_enable?"panels_of_line":"multi_series_line";if(d.chartPathClass="lineChart"===d.type?"line":"multi-line","liveData"===a&&"lineChart"===d.type){for(var s=0;s<d.new_data_length;s++){var u=d.new_data[s].data,v=d.type+"-svg-"+s;d.svgContainer.select(d.selector+" #"+v).datum(d.new_data[s].data).attr("transform","translate("+d.extra_left_margin+",0)").style("stroke",function(){return d.new_data[s].highlight&&"multilineChart"===d.type&&!d.clicked?d.highlightLine(this,null):d.clicked?d.highlightLine(d.selected,null,d.previous_color):d3.select(this).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}),d.fillColor.colorPieMS(d.new_data[s],d.type)}).attr("data-id",function(a,b){return d.new_data[b]}),c(s),d3.selectAll(d.selector+" text#"+(d.type+"-svg-"+s)).style("fill",function(){return d.fillColor.colorPieMS(d.new_data[s],d.type)})}"default"===d.mode&&d.svgContainer.on("mouseout",function(){d.mouseEvent.tooltipHide(),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis")}).on("mousemove",function(){d.mouseEvent.crossHairPosition(d.new_data,d.xScale,d.yScale,d.dataLineGroup,d.extra_left_margin,d.xdomain,t,d.tooltipMode,null,d.container_id)})}else{if(d.clk=!0,PykCharts["boolean"](d.panels_enable))u=d.new_data[b].data,v=d.type+d.svgContainer.attr("id"),d.dataLineGroup[0]=d.chartBody.append("path"),d.dataLineGroup[0].datum(d.new_data1.data).attr({"class":"lines-hover "+d.chartPathClass,id:v,transform:"translate("+d.extra_left_margin+",0)","stroke-opacity":function(){return"saturation"===d.color_mode?(b+1)/d.new_data.length:1},"path-stroke-opacity":function(){return d3.select(this).attr("stroke-opacity")},"data-id":function(a,b){return d.new_data[b]}}).style("stroke",function(){return d.new_data[b].highlight&&d.highlightLine(this,null),d.fillColor.colorPieMS(d.new_data[b],d.type)}).on({click:function(){"default"===d.mode&&(d.clicked=!0,d.highlightLine(PykCharts.getEvent().target,d.clicked,d.previous_color))},mouseover:function(){this===d.selected||"saturation"!==d.color_mode&&!d.hover||"default"!==d.mode||(d.previous_color=d3.select(this).attr("stroke-opacity"),d.click_color=d3.select(this).style("stroke"),d3.select(this).classed({"multi-line-hover":!0,"multi-line":!1}).style("stroke","orange"))},mouseout:function(){this===d.selected||"saturation"!==d.color_mode&&!d.hover||"default"!==d.mode||d3.select(this).classed({"multi-line-hover":!1,"multi-line":!0}).style("stroke",function(){return d.new_data[b].highlight&&d.highlightLine(this,null,d.previous_color),d.click_color}).attr("stroke-opacity",function(){return"saturation"===d.color_mode?d.previous_color:1})}}),f(b);else for(var s,s=0;s<d.new_data_length;s++){var v=d.type+"-svg-"+s;d.dataLineGroup[s]=d.chartBody.append("path");var u=d.new_data[s].data;d.dataLineGroup[s].datum(d.new_data[s].data).attr({"class":"lines-hover "+d.chartPathClass,id:v,transform:"translate("+d.extra_left_margin+",0)","stroke-opacity":function(){return"saturation"===d.color_mode?(s+1)/d.new_data.length:1},"path-stroke-opacity":function(){return d3.select(this).attr("stroke-opacity")}}).style("stroke",function(){return d.new_data[s].highlight&&d.highlightLine(this,null),d.fillColor.colorPieMS(d.new_data[s],d.type)}),e(s)}"lineChart"===d.type&&"default"===d.mode?d.svgContainer.on("mouseout",function(){d.mouseEvent.tooltipHide(),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis")}).on("mousemove",function(){d.mouseEvent.crossHairPosition(d.new_data,d.xScale,d.yScale,d.dataLineGroup,d.extra_left_margin,d.xdomain,t,d.tooltipMode,null,d.container_id)}):"multilineChart"===d.type&&"default"===d.mode&&d.svgContainer.on("mouseout",function(){d.mouseEvent.tooltipHide(null,d.panels_enable,d.type),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis")}).on("mousemove",function(){var a=[];a[0]=d3.select(d.selector+" #"+this.id+" .lines-hover"),d.mouseEvent.crossHairPosition(d.new_data,d.xScale,d.yScale,a,d.extra_left_margin,d.xdomain,t,d.tooltipMode,d.panels_enable,d.container_id,d.no_of_containers_in_row)})}return this},ticks:function(){function a(){d.ticks.text(function(a){return a.name}).text(function(a,b){return d.ticks_text_width[b]=this.getBBox().width,a.name}).attr({dx:5,dy:5}).style({"font-size":d.pointer_size+"px","font-weight":function(a){return a.highlight?"bold":d.pointer_weight},"font-family":d.pointer_family,visibility:"visible",fill:function(a,b){return d.fillColor.colorPieMS(d.new_data[b],d.type)},"pointer-events":"none"})}if(PykCharts["boolean"](d.pointer_size))if(PykCharts["boolean"](d.panels_enable)){var b=d.type+d.svgContainer.attr("id");"bottom"!==d.axis_x_position||"left"!==d.axis_y_position&&"right"!==d.axis_y_position?"top"!==d.axis_x_position||"left"!==d.axis_y_position&&"right"!==d.axis_y_position||(d.ticks[0]=d.svgContainer.append("text").attr({id:b,x:d.w-d.chart_margin_left,y:d.chart_height-d.chart_margin_bottom,dy:10,"text-anchor":"end"}).style({"font-size":d.pointer_size+"px","font-weight":d.pointer_weight,"font-family":d.pointer_family,fill:function(){return d.fillColor.colorPieMS(d.new_data1,d.type)}}).html(d.new_data1.name)):d.ticks[0]=d.svgContainer.append("text").attr({id:b,x:d.chart_margin_left,y:d.chart_margin_top,dy:-5}).style({"font-size":d.pointer_size+"px","font-weight":d.pointer_weight,"font-family":d.pointer_family,fill:function(){return d.fillColor.colorPieMS(d.new_data1,d.type)}}).html(d.new_data1.name)}else d.ticks_text_width=[],tickPosition=function(a,b){var c,e;return"left"===d.axis_y_position?(c=d.xScale(d.new_data[b].data[d.new_data[b].data.length-1].x)+d.extra_left_margin+d.chart_margin_left,e=d.yScale(d.new_data[b].data[d.new_data[b].data.length-1].y)+d.chart_margin_top):"right"===d.axis_y_position&&(c=d.xScale(d.new_data[b].data[0].x)+d.extra_left_margin+d.chart_margin_left-10,e=d.yScale(d.new_data[b].data[0].y)+d.chart_margin_top),text_x=c,text_y=e,text_rotate=0,"translate("+text_x+","+text_y+") rotate("+text_rotate+")"},orient=function(){return"left"===d.axis_y_position?"start":"right"===d.axis_y_position?"end":void 0},d.ticks=d.svgContainer.selectAll(".legend-heading").data(d.new_data),d.ticks.enter().append("text"),d.ticks.attr({id:function(a,b){return d.type+"-svg-"+b},"class":"legend-heading",transform:tickPosition,"text-anchor":orient}),d.ticks.text(function(){return""}),setTimeout(a,d.transitions.duration()),d.ticks.exit().remove();return this}};return b},d.zoomed=function(){if(PykCharts["boolean"](d.panels_enable))for(var a=0;a<d.new_data_length;a++){var b=d.type;currentContainer=d3.selectAll("#"+d.container_id+"-"+a),d.k.isOrdinal(currentContainer,".x.axis",d.xScale,d.xdomain,d.extra_left_margin),d.k.isOrdinal(currentContainer,".x.grid",d.xScale),d.k.isOrdinal(currentContainer,".y.axis",d.yScale,d.ydomain),d.k.isOrdinal(currentContainer,".y.grid",d.yScale),currentContainer.select("#"+b+d.container_id+"-"+a).attr({"class":"lines-hover "+d.chartPathClass,d:d.chart_path})}else{PykCharts["boolean"](d.pointer_overflow_enable)&&d.svgContainer.style("overflow","hidden"),d.k.isOrdinal(d.svgContainer,".x.axis",d.xScale,d.xdomain,d.extra_left_margin),d.k.isOrdinal(d.svgContainer,".x.grid",d.xScale),d.k.isOrdinal(d.svgContainer,".y.axis",d.yScale,d.ydomain),d.k.isOrdinal(d.svgContainer,".y.grid",d.yScale);for(var a=0;a<d.new_data_length;a++){var b=d.type+"-svg-"+a;d.svgContainer.select(d.selector+" #"+b).attr({"class":"lines-hover "+d.chartPathClass,d:d.chart_path})}}"dblclick"===PykCharts.getEvent().sourceEvent.type&&d.count++,d.mouseEvent.tooltipHide(),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis"),d.count===d.zoom_level+1&&d.zoomOut(),PykCharts["boolean"](d.annotation_enable)&&d.annotation(),d.optionalFeature().ticks()},d.zoomOut=function(){if(PykCharts["boolean"](d.pointer_overflow_enable)&&!PykCharts["boolean"](d.panels_enable)&&d.svgContainer.style("overflow","visible"),PykCharts["boolean"](d.panels_enable)){for(var a=0;a<d.previous_length;a++){var b=document.querySelector(d.selector+" #panels_of_line_main_div #chart-container-"+a);b.parentNode.removeChild(b)}d.renderPanelOfLines()}"lineChart"===d.type?d.optionalFeature().createChart("liveData"):"multilineChart"!==d.type||PykCharts["boolean"](d.panels_enable)||(document.querySelector(d.selector+" #chart-container-1").innerHTML=null,d.renderLineChart()),d.k.isOrdinal(d.svgContainer,".x.axis",d.xScale,d.xdomain,d.extra_left_margin),d.k.isOrdinal(d.svgContainer,".x.grid",d.xScale),d.k.isOrdinal(d.svgContainer,".y.axis",d.yScale,d.ydomain),d.k.isOrdinal(d.svgContainer,".y.grid",d.yScale)},d.onBrush=function(a,b){d.addEvents(a,b)},d.highlightLine=function(a,b,c){d.selected_line=a,d.selected_line_data=d.selected_line.__data__,d.selected_line_data_len=d.selected_line_data.length,d.deselected=d.selected,d.selected=a,"multilineChart"!==d.type||"saturation"!==d.color_mode&&!d.hover||d3.select(d.selected).style("stroke",function(){return d.click_color}),b&&(d3.select(d.selected).classed("multi-line")?(d3.selectAll(d.selector+" path.multi-line").attr("stroke-opacity",.3),"color"===d.color_mode&&d3.selectAll(d.selector+" .legend-heading").style("opacity",.3),d3.select(d.selector+" text#"+d.selected.id).style("opacity",1).style("font-weight","bold"),d3.selectAll(".lines-hover").attr("stroke-opacity",.3).classed({"multi-line-selected":!1,"multi-line":!0}),d3.select(d.selected).attr("stroke-opacity",1).classed({"multi-line-selected":!0,"multi-line":!1})):("color"===d.color_mode?d3.selectAll(d.selector+" path.multi-line").attr("stroke-opacity",c):d3.selectAll(d.selector+" path.multi-line").attr("stroke-opacity",function(){return d3.select(this).attr("path-stroke-opacity")}),d3.selectAll(d.selector+" .legend-heading").style("opacity",1),d3.select(d.selector+" text#"+d.selected.id).style({opacity:1,"font-weight":"normal"}),d3.select(d.selected).attr("stroke-opacity",c).classed({"multi-line-selected":!1,"multi-line":!0})))},d.annotation=function(){function a(a,b){function c(){f.attr("class","PykCharts-annotation-line").attr("d",function(a){var b=[{x:parseInt(d.xScale(a.x)-.5*e)+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-e+d.chart_margin_top)},{x:parseInt(d.xScale(a.x)+.5*e)+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-e+d.chart_margin_top)},{x:parseInt(d.xScale(a.x))+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)+d.chart_margin_top)}];return d.line(b)}).attr("fill",d.annotation_background_color)}var f=d3.select(d.selector+" #"+d.container_id+"-"+b).selectAll(d.selector+" .PykCharts-annotation-line").data(a);f.enter().append("path"),f.attr("d",function(a){var b=[{x:parseInt(d.xScale(a.x))+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-e+d.chart_margin_top)},{x:parseInt(d.xScale(a.x))+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-e+d.chart_margin_top)}];return d.line(b)}),setTimeout(c,d.transitions.duration()),f.exit().remove()}if(d.line=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y}),PykCharts["boolean"](d.panels_enable)){if(PykCharts["boolean"](d.panels_enable))for(var b=0;b<d.new_data_length;b++){var c=[],e=12;d.new_data[b].data.map(function(a){a.annotation&&c.push({annotation:a.annotation,x:a.x,y:a.y})}),a(c,b),d.k.annotation(d.selector+" #"+d.container_id+"-"+b,c,d.xScale,d.yScale)}}else{for(var e=12,c=[],b=0;b<d.new_data_length;b++)d.new_data[b].data.map(function(a){a.annotation&&c.push({annotation:a.annotation,x:a.x,y:a.y})});a(c,1),d.k.annotation(d.selector+" #svg-1",c,d.xScale,d.yScale)}},d.renderPanelOfLines=function(){for(var a=0;a<d.new_data_length;a++){var b=d.selector.substr(1,d.selector.length);d3.selectAll("#tooltip-svg-container-"+a+"-pyk-tooltip"+b).remove(),d.k.makeMainDiv(d.selector+" #panels_of_line_main_div",a).tooltip(!0,d.selector,a),d.new_data1=d.new_data[a],d.fill_data[0]=d.new_data1,d.optionalFeature().svgContainer(a).createGroups(a),d.k.crossHair(d.svgContainer,1,d.fill_data,d.fillColor,d.type),d.mouseEvent=new PykCharts.crossHairMovement(d),d.optionalFeature().createChart(null,a).ticks(a).axisContainer(),d.k.xAxis(d.svgContainer,d.xGroup,d.xScale,d.extra_left_margin,d.xdomain,d.x_tick_values).yAxis(d.svgContainer,d.yGroup,d.yScale,d.ydomain,d.y_tick_values).xAxisTitle(d.xGroup).yAxisTitle(d.yGroup),"default"===d.mode&&d.k.yGrid(d.svgContainer,d.group,d.yScale).xGrid(d.svgContainer,d.group,d.xScale)}d.k.exportSVG(d,d.container_id+"-","lineChart",d.panels_enable,d.new_data),d.k.emptyDiv(d.selector)},d.renderLineChart=function(){function a(){PykCharts["boolean"](d.pointer_size)&&(b=d3.max(d.ticks_text_width,function(a){return a})),d.k.exportSVG(d,"#"+d.container_id+"-1","lineChart",void 0,void 0,b)}d.optionalFeature().svgContainer(1).createGroups(1).hightLightOnload(),d.k.crossHair(d.svgContainer,d.new_data_length,d.new_data,d.fillColor,d.type),d.mouseEvent=new PykCharts.crossHairMovement(d),d.optionalFeature().createChart().ticks().axisContainer(),d.k.xAxis(d.svgContainer,d.xGroup,d.xScale,d.extra_left_margin,d.xdomain,d.x_tick_values).yAxis(d.svgContainer,d.yGroup,d.yScale,d.ydomain,d.y_tick_values).xAxisTitle(d.xGroup).yAxisTitle(d.yGroup),PykCharts.boolean(d.interactive_enable)&&(d.brush=new PykCharts.Configuration.renderBrush(d,d.xScale,d.group,d.reducedHeight)),"default"===d.mode&&d.k.yGrid(d.svgContainer,d.group,d.yScale).xGrid(d.svgContainer,d.group,d.xScale);var b=0;setTimeout(a,d.transitions.duration())},d.dataTransformation(),d.render()},PykCharts.multiD.area=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.crossHair(b),PykCharts.annotation(b),PykCharts.scaleFunction(b),PykCharts.grid(b),b.k.storeInitialDivHeight(),!b.stop){"default"===b.mode&&b.k.loading();{var e=c.multiDimensionalCharts;c.stylesheet,a.optional}b.crosshair_enable=a.crosshair_enable?a.crosshair_enable.toLowerCase():e.crosshair_enable,b.curvy_lines_enable=a.curvy_lines_enable?a.curvy_lines_enable.toLowerCase():e.curvy_lines_enable,b.panels_enable="no",b.interpolate=PykCharts["boolean"](b.curvy_lines_enable)?"cardinal":"linear",b.w=b.chart_width-b.chart_margin_left-b.chart_margin_right,b.h=b.chart_height-b.chart_margin_top-b.chart_margin_bottom,b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);
return b.stop||d===!1?void b.k.remove_loading_bar(e):(b.data=b.k.__proto__._groupBy("area",c),b.axis_y_data_format="number",b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),b.compare_data=b.data,b.data_length=b.data.length,b.k.remove_loading_bar(e),"string"===b.axis_x_data_format?b.data_sort_enable="no":(b.data_sort_enable="yes",b.data_sort_type="time"===b.axis_x_data_format?"date":"numerically",b.data_sort_order="ascending"),PykCharts.multiD.areaFunctions(a,b,"area"),b.dataTransformation(),void b.render())},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}}},PykCharts.multiD.stackedArea=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){if(b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.crossHair(b),PykCharts.annotation(b),PykCharts.scaleFunction(b),PykCharts.grid(b),!b.stop){b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading();{var e=c.multiDimensionalCharts;c.stylesheet,a.optional}b.crosshair_enable=a.crosshair_enable?a.crosshair_enable.toLowerCase():e.crosshair_enable,b.curvy_lines_enable=a.curvy_lines_enable?a.curvy_lines_enable.toLowerCase():e.curvy_lines_enable,b.panels_enable="no",b.interpolate=PykCharts["boolean"](b.curvy_lines_enable)?"cardinal":"linear",b.w=b.chart_width-b.chart_margin_left-b.chart_margin_right,b.h=b.chart_height-b.chart_margin_top-b.chart_margin_bottom,b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);return b.stop||d===!1?void b.k.remove_loading_bar(e):(b.data=b.k.__proto__._groupBy("area",c),b.axis_y_data_format="number",b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),b.compare_data=b.data,b.data_length=b.data.length,b.k.remove_loading_bar(e),"string"===b.axis_x_data_format?b.data_sort_enable="no":(b.data_sort_enable="yes",b.data_sort_type="time"===b.axis_x_data_format?"date":"numerically",b.data_sort_order="ascending"),PykCharts.multiD.areaFunctions(a,b,"stacked_area"),b.dataTransformation(),void b.render())},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}}},PykCharts.multiD.areaFunctions=function(a,b,c){var d=b;d.dataTransformation=function(){d.group_arr=[],d.new_data=[],d.ticks=[],d.x_arr=[];for(var a=0;a<d.data_length;a++)d.group_arr[a]=d.data[a].name;d.uniq_group_arr=d.k.__proto__._unique(d.group_arr),d.uniq_color_arr=[];for(var b=d.uniq_group_arr.length,c=0;c<d.data_length;c++)d.x_arr[c]=d.data[c].x;d.uniq_x_arr=d.k.__proto__._unique(d.x_arr);for(var c=0;b>c;c++)if(d.chart_color[c])d.uniq_color_arr[c]=d.chart_color[c];else{for(var e=0;e<d.data_length;e++)if(d.uniq_group_arr[c]===d.data[e].name&&d.data[e].color){d.uniq_color_arr[c]=d.data[e].color;break}PykCharts["boolean"](d.uniq_color_arr[c])||(d.uniq_color_arr[c]=d.default_color[0])}d.flag=0;for(var c=0;b>c;c++){d.new_data[c]={name:d.uniq_group_arr[c],data:[],color:d.uniq_color_arr[c]};for(var e=0;e<d.data_length;e++)d.uniq_group_arr[c]===d.data[e].name&&d.new_data[c].data.push({x:d.data[e].x,y:d.data[e].y,tooltip:d.data[e].tooltip,annotation:d.data[e].annotation||""})}d.new_data_length=d.new_data.length;for(var f=d.uniq_x_arr.length,g=0;g<d.new_data_length;g++){for(var h=d.k.__proto__._unique(d.x_arr),i=d.new_data[g].data.length,j=0;i>j;j++)for(var c=0;f>c;c++)if(d.new_data[g].data[j].x===h[c]){h[c]=void 0;break}for(var k=0;f>k;k++)if(void 0!=h[k]){var l={x:h[k],y:0,tooltip:0,annotation:""};d.new_data[g].data.splice(k,0,l)}}for(var c=0;c<d.new_data_length;c++)d.new_data[c].data=d.k.__proto__._sortData(d.new_data[c].data,"x","name",d)},d.render=function(){var b=d.selector.substring(1,d.selector.length);d.container_id=b+"_svg",d.dataLineGroup=[],d.dataLineGroupBorder=[],d.multid=new PykCharts.multiD.configuration(d),d.fillColor=new PykCharts.Configuration.fillChart(d,null,a),d.transitions=new PykCharts.Configuration.transition(d),d.border=new PykCharts.Configuration.border(d),d.xdomain=[],d.optional_feature().chartType();try{if("stackedAreaChart"===d.type&&"area"===c)throw"Invalid data in the JSON"}catch(e){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+d.selector+'."'+e+'"  Visit www.pykcharts.com/errors#error_7')}if("time"===d.axis_x_data_format)for(var f=0;f<d.new_data_length;f++)d.new_data[f].data.forEach(function(a){a.x=d.k.dateConversion(a.x),d.xdomain.push(a.x)}),d.data.forEach(function(a){a.x=d.k.dateConversion(a.x)});if("default"===d.mode){var g=d.selector.substr(1,d.selector.length);d3.selectAll("#tooltip-svg-container-1-pyk-tooltip"+g).remove(),d.k.title().backgroundColor(d).export(d,"#"+d.container_id+"-1","areaChart").liveData(d).emptyDiv(d.selector).subtitle().makeMainDiv(d.selector,1).tooltip(!0,d.selector,1),d.renderChart(),d.k.xAxis(d.svgContainer,d.xGroup,d.xScale,d.extra_left_margin,d.xdomain,d.x_tick_values,d.legendsGroup_height).yAxis(d.svgContainer,d.yGroup,d.yScale,d.ydomain,d.y_tick_values,d.legendsGroup_width).yGrid(d.svgContainer,d.group,d.yScale,d.legendsGroup_width).xGrid(d.svgContainer,d.group,d.xScale,d.legendsGroup_height).xAxisTitle(d.xGroup,d.legendsGroup_height,d.legendsGroup_width).yAxisTitle(d.yGroup).createFooter().lastUpdatedAt().credits().dataSource(),PykCharts["boolean"](d.annotation_enable)&&d.annotation()}else"infographics"===d.mode&&(d.k.backgroundColor(d).export(d,"#"+d.container_id+"-1","areaChart").emptyDiv(d.selector).makeMainDiv(d.selector,1),d.optional_feature().svgContainer(1).legendsContainer().createGroups(1).createChart().axisContainer(),d.k.xAxis(d.svgContainer,d.xGroup,d.xScale,d.extra_left_margin,d.xdomain,d.x_tick_values,d.legendsGroup_height).yAxis(d.svgContainer,d.yGroup,d.yScale,d.ydomain,d.y_tick_values,d.legendsGroup_width).xAxisTitle(d.xGroup,d.legendsGroup_height,d.legendsGroup_width).yAxisTitle(d.yGroup));PykCharts.boolean(d.interactive_enable)&&(d.brush=new PykCharts.Configuration.renderBrush(d,d.xScale,d.group,d.h)),d.k.exportSVG(d,"#"+d.container_id+"-1","areaChart"),d.mouseEvent=new PykCharts.crossHairMovement(d);var h=d.k.resize(d.svgContainer);d.k.__proto__._ready(h),window.addEventListener("resize",function(){return d.k.resize(d.svgContainer)})},d.refresh=function(b){d.xdomain=[],d.executeRefresh=function(a){d.data=d.k.__proto__._groupBy("area",a),d.data_length=d.data.length,d.dataTransformation();var b=d.k.checkChangeInData(d.data,d.compare_data);d.compare_data=b[0];var c=b[1];if((c||PykCharts["boolean"](d.zoom_enable)&&d.count>1&&d.count<=d.zoom_level||d.transition_duration)&&(d.k.lastUpdatedAt("liveData"),d.mouseEvent.tooltipHide(),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis")),"time"===d.axis_x_data_format)for(var e=0;e<d.new_data_length;e++)d.new_data[e].data.forEach(function(a){a.x=d.k.dateConversion(a.x),d.xdomain.push(a.x)}),d.data.forEach(function(a){a.x=d.k.dateConversion(a.x)});"stackedAreaChart"===d.type?(document.querySelector(d.selector+" #chart-container-1").innerHTML=null,d.renderChart()):d.optional_feature().createChart("liveData"),d.k.xAxis(d.svgContainer,d.xGroup,d.xScale,d.extra_left_margin,d.xdomain,d.x_tick_values,d.legendsGroup_height).yAxis(d.svgContainer,d.yGroup,d.yScale,d.ydomain,d.y_tick_values,d.legendsGroup_width).yGrid(d.svgContainer,d.group,d.yScale,d.legendsGroup_width).xGrid(d.svgContainer,d.group,d.xScale,d.legendsGroup_height),PykCharts["boolean"](d.annotation_enable)&&d.annotation()},PykCharts.boolean(d.interactive_enable)?(d.k.dataFromPykQuery(b),d.k.dataSourceFormatIdentification(d.data,d,"executeRefresh")):d.k.dataSourceFormatIdentification(a.data,d,"executeRefresh")},d.optional_feature=function(){var a=d.selector.substring(1,d.selector.length),b={chartType:function(){for(var a=1;a<d.data_length;a++)if(d.data[0].x===d.data[a].x){d.type="stackedAreaChart";break}return d.type=d.type||"areaChart",this},svgContainer:function(b){var c=document.getElementById(a);return c.classList.contains("PykCharts-line-chart")||(c.className+=" PykCharts-twoD PykCharts-line-chart PykCharts-multi-series2D"),d.svgContainer=d3.select(d.selector+" #chart-container-"+b).append("svg:svg").attr({id:d.container_id+"-"+b,width:d.chart_width,height:d.chart_height,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+d.chart_width+" "+d.chart_height}),this},createGroups:function(a){return d.group=d.svgContainer.append("g").attr({id:d.type+"-group",transform:"translate("+d.chart_margin_left+","+(d.chart_margin_top+d.legendsGroup_height)+")"}),PykCharts["boolean"](d.chart_grid_y_enable)&&d.group.append("g").attr({id:"ygrid","class":"y grid-line"}),PykCharts["boolean"](d.chart_grid_x_enable)&&d.group.append("g").attr({id:"xgrid","class":"x grid-line"}),d.clip=d.svgContainer.append("svg:clipPath").attr("id","clip"+a+d.selector).append("svg:rect").attr({width:d.w-d.legendsGroup_width,height:d.h-d.legendsGroup_height}),d.chartBody=d.svgContainer.append("g").attr({id:"clipPath","clip-path":"url(#clip"+a+d.selector+" )",transform:"translate("+d.chart_margin_left+","+(d.chart_margin_top+d.legendsGroup_height)+")"}),d.stack_layout=d3.layout.stack().values(function(a){return a.data}),this},legendsContainer:function(){return PykCharts["boolean"](d.legends_enable)&&"stackedAreaChart"===d.type&&"default"===d.mode?d.legendsGroup=d.svgContainer.append("g").attr("id","stackedArea-legends").style("visibility","visible").attr("transform","translate(0,10)"):(d.legendsGroup_height=0,d.legendsGroup_width=0),this},axisContainer:function(){return(PykCharts["boolean"](d.axis_x_enable)||d.axis_x_title)&&(d.xGroup=d.group.append("g").attr({id:"xaxis","class":"x axis"})),(PykCharts["boolean"](d.axis_y_enable)||d.axis_y_title)&&(d.yGroup=d.group.append("g").attr({id:"yaxis","class":"y axis"})),this},createChart:function(a){function b(a){d.dataLineGroup[a].transition().duration(d.transitions.duration()).attrTween("d",function(){var b=d3.scale.quantile().domain([0,1]).range(d3.range(1,s.length+1));return function(c){return d.chart_path(d.new_data[a].data.slice(0,b(c)))}})}function e(a){d.dataLineGroupBorder[a].transition().duration(d.transitions.duration()).attrTween("d",function(){var b=d3.scale.quantile().domain([0,1]).range(d3.range(1,d.layers[a].data.length+1));return function(c){return d.chart_path_border(d.layers[a].data.slice(0,b(c)))}})}function f(a){d.dataLineGroup[a].transition().duration(d.transitions.duration()).attrTween("d",function(){var b=d3.scale.quantile().domain([0,1]).range(d3.range(1,s.length+1));return function(c){return d.chart_path(d.new_data[a].data.slice(0,b(c)))}})}function g(a){d.dataLineGroupBorder[a].transition().duration(d.transitions.duration()).attrTween("d",function(){var b=d3.scale.quantile().domain([0,1]).range(d3.range(1,d.layers[a].data.length+1));return function(c){return d.chart_path_border(d.layers[a].data.slice(0,b(c)))}})}d.legend_text=[],d.layers=d.stack_layout(d.new_data);var h,i,j,k,l,m,n,o,p,q=[];if(d.count=1,d.x_tick_values=d.k.processXAxisTickValues(),d.y_tick_values=d.k.processYAxisTickValues(),"number"===d.axis_y_data_format?(max=d3.max(d.layers,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,l=[min,max],i=d.k.__proto__._domainBandwidth(l,1),j=[d.h-d.legendsGroup_height,0],o=d3.min(d.y_tick_values),p=d3.max(d.y_tick_values),i[0]>o&&(i[0]=o),i[1]<p&&(i[1]=p),d.yScale=d.k.scaleIdentification("linear",i,j)):"string"===d.axis_y_data_format?(d.new_data[0].data.forEach(function(a){i.push(a.y)}),j=[0,d.h],d.yScale=d.k.scaleIdentification("ordinal",i,j,0)):"time"===d.axis_y_data_format&&(d.layers.data.forEach(function(a){a.y0=new Date(a.y0),a.y=new Date(a.y)}),max=d3.max(d.layers,function(a){return d3.max(a.data,function(a){return a.y0+a.y})}),min=0,i=[min,max],j=[d.h,0],o=d3.min(d.y_tick_values,function(a){return new Date(a)}),p=d3.max(d.y_tick_values,function(a){return new Date(a)}),new Date(i[0])>new Date(o)&&(i[0]=o),new Date(i[1])<new Date(p)&&(i[1]=p),d.yScale=d.k.scaleIdentification("time",i,j)),"number"===d.axis_x_data_format?(max=d3.max(d.new_data,function(a){return d3.max(a.data,function(a){return+a.x})}),min=d3.min(d.new_data,function(a){return d3.min(a.data,function(a){return+a.x})}),h=[min,max],q=d.k.__proto__._domainBandwidth(h,2),k=[0,d.w-d.legendsGroup_width],m=d3.min(d.x_tick_values),n=d3.max(d.x_tick_values),q[0]>m&&(q[0]=m),q[1]<n&&(q[1]=n),d.xScale=d.k.scaleIdentification("linear",q,k),d.extra_left_margin=0,d.new_data[0].data.forEach(function(a){d.xdomain.push(+a.x)})):"string"===d.axis_x_data_format?(d.new_data[0].data.forEach(function(a){q.push(a.x)}),k=[0,d.w-d.legendsGroup_width],d.xScale=d.k.scaleIdentification("ordinal",q,k,0),d.extra_left_margin=d.xScale.rangeBand()/2,d.xdomain=d.xScale.domain()):"time"===d.axis_x_data_format&&(max=d3.max(d.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),min=d3.min(d.new_data,function(a){return d3.min(a.data,function(a){return a.x})}),q=[min,max],k=[0,d.w-d.legendsGroup_width],m=d3.min(d.x_tick_values,function(a){return d.k.dateConversion(a)}),n=d3.max(d.x_tick_values,function(a){return d.k.dateConversion(a)}),new Date(q[0])>new Date(m)&&(q[0]=m),new Date(q[1])<new Date(n)&&(q[1]=n),d.xScale=d.k.scaleIdentification("time",q,k),d.extra_left_margin=0,d.new_data[0].data.forEach(function(a){d.xdomain.push(a.x)})),d.ydomain=d.yScale.domain(),d.zoom_event=d3.behavior.zoom(),"string"!==d.axis_y_data_format&&"string"!==d.axis_x_data_format?d.zoom_event.x(d.xScale).y(d.yScale).scale(d.count).on("zoom",d.zoomed):d.zoom_event.y(d.yScale).scale(d.count).on("zoom",d.zoomed),PykCharts["boolean"](d.zoom_enable)&&"default"===d.mode&&(d.svgContainer.call(d.zoom_event),d.svgContainer.on({"wheel.zoom":null,"mousewheel.zoom":null})),d.chart_path=d3.svg.area().x(function(a){return d.xScale(a.x)}).y0(function(a){return d.yScale(a.y0)}).y1(function(a){return d.yScale(a.y0+a.y)}).interpolate(d.interpolate),d.chart_path_border=d3.svg.line().x(function(a){return d.xScale(a.x)}).y(function(a){return d.yScale(a.y0+a.y)}).interpolate(d.interpolate),d.chartPathClass="areaChart"===d.type?"area":"stacked-area","liveData"===a){for(var r=0;r<d.new_data_length;r++){var s=d.new_data[r].data;c=d.chartPathClass+r,d.svgContainer.select("#"+c).datum(d.layers[r].data).attr("transform","translate("+d.extra_left_margin+",0)").style({stroke:d.border.color(),"stroke-width":d.border.width(),"stroke-dasharray":d.border.style()}),b(r),d.svgContainer.select("#border-stacked-area"+r).datum(d.layers[r].data).attr("transform","translate("+d.extra_left_margin+",0)"),e(r)}"areaChart"===d.type&&d.svgContainer.on("mouseout",function(){d.mouseEvent.tooltipHide(),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis")}).on("mousemove",function(){d.mouseEvent.crossHairPosition(d.new_data,d.xScale,d.yScale,d.dataLineGroup,d.extra_left_margin,d.xdomain,d.type,d.tooltip_mode)})}else{for(var r=0;r<d.new_data_length;r++){var s=d.new_data[r].data;c=d.chartPathClass+r,d.dataLineGroup[r]=d.chartBody.append("path"),d.dataLineGroup[r].datum(d.layers[r].data).attr({"class":d.chartPathClass,id:c,"fill-opacity":function(){return"stackedAreaChart"===d.type&&"saturation"===d.color_mode?(r+1)/d.new_data.length:void 0},"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},transform:"translate("+d.extra_left_margin+",0)","data-id":function(a,b){return d.new_data[b]}}).style("fill",function(){return d.fillColor.colorPieMS(d.new_data[r],d.type)}),f(r),d.dataLineGroupBorder[r]=d.chartBody.append("path"),d.dataLineGroupBorder[r].datum(d.layers[r].data).attr({"class":"area-border",id:"border-stacked-area"+r,transform:"translate("+d.extra_left_margin+",0)"}).style({stroke:d.border.color(),"stroke-width":d.border.width(),"stroke-dasharray":d.border.style(),"pointer-events":"none"}),g(r)}d.svgContainer.on("mouseout",function(){d.mouseEvent.tooltipHide(),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis")}).on("mousemove",function(){if("areaChart"===d.type)d.mouseEvent.crossHairPosition(d.new_data,d.xScale,d.yScale,d.dataLineGroup,d.extra_left_margin,d.xdomain,d.type,d.tooltip_mode);else if("stackedAreaChart"===d.type){var a=[];a[0]=d3.select(d.selector+" #"+this.id+" .stacked-area"),d.mouseEvent.crossHairPosition(d.new_data,d.xScale,d.yScale,a,d.extra_left_margin,d.xdomain,d.type,d.tooltipMode,d.color_from_data,"no")}})}return d3.selectAll(d.selector+" ."+d.chartPathClass).on({mouseover:function(){"default"===d.mode&&d.mouseEvent.highlight(d.selector+" ."+d.chartPathClass,this)},mouseout:function(){"default"===d.mode&&d.mouseEvent.highlightHide(d.selector+" ."+d.chartPathClass)}}),this},legends:function(){return PykCharts["boolean"](d.legends_enable)&&"stackedAreaChart"===d.type&&"default"===d.mode&&d.multid.legendsPosition(d,"stackedArea",d.new_data),this}};return b},d.zoomed=function(){for(d.k.isOrdinal(d.svgContainer,".x.axis",d.xScale,d.xdomain,d.extra_left_margin),d.k.isOrdinal(d.svgContainer,".x.grid",d.xScale),d.k.isOrdinal(d.svgContainer,".y.axis",d.yScale,d.ydomain),d.k.isOrdinal(d.svgContainer,".y.grid",d.yScale),i=0;i<d.new_data_length;i++)c=d.chartPathClass+i,d.svgContainer.select(d.selector+" #"+c).attr({"class":d.chartPathClass,d:d.chart_path}),d.svgContainer.select(d.selector+" #border-stacked-area"+i).attr({"class":"area-border",d:d.chart_path_border});"dblclick"===PykCharts.getEvent().sourceEvent.type&&d.count++,d.mouseEvent.tooltipHide(),d.mouseEvent.crossHairHide(d.type),d.mouseEvent.axisHighlightHide(d.selector+" .x.axis"),d.mouseEvent.axisHighlightHide(d.selector+" .y.axis"),d.count===d.zoom_level+1&&d.zoomOut(),PykCharts["boolean"](d.annotation_enable)&&d.annotation()},d.zoomOut=function(){d.optional_feature().createChart("liveData"),d.k.isOrdinal(d.svgContainer,".x.axis",d.xScale,d.xdomain,d.extra_left_margin),d.k.isOrdinal(d.svgContainer,".x.grid",d.xScale),d.k.isOrdinal(d.svgContainer,".y.axis",d.yScale,d.ydomain),d.k.isOrdinal(d.svgContainer,".y.grid",d.yScale)},d.onBrush=function(a,b){d.addEvents(a,b)},d.annotation=function(){function a(){e.attr("class","PykCharts-annotation-line").attr("d",function(a){var c=[{x:parseInt(d.xScale(a.x)-.5*b)+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-b+d.chart_margin_top+d.legendsGroup_height)},{x:parseInt(d.xScale(a.x)+.5*b)+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-b+d.chart_margin_top+d.legendsGroup_height)},{x:parseInt(d.xScale(a.x))+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)+d.chart_margin_top+d.legendsGroup_height)}];return d.line(c)}).attr("fill",d.annotation_background_color)}d.line=d3.svg.line().interpolate("linear-closed").x(function(a){return a.x}).y(function(a){return a.y});var b=12,c=[];if("areaChart"===d.type)d.new_data[0].data.map(function(a){a.annotation&&c.push({annotation:a.annotation,x:a.x,y:a.y})});else if("stackedAreaChart"===d.type&&"default"===d.mode)for(i=0;i<d.new_data_length;i++)d.new_data[i].data.map(function(a){a.annotation&&c.push({annotation:a.annotation,x:a.x,y:a.y+a.y0})});var e=d.svgContainer.selectAll(" .PykCharts-annotation-line").data(c);e.enter().append("path"),e.attr("d",function(a){var c=[{x:parseInt(d.xScale(a.x))+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-b+d.chart_margin_top+d.legendsGroup_height)},{x:parseInt(d.xScale(a.x))+d.extra_left_margin+d.chart_margin_left,y:parseInt(d.yScale(a.y)-b+d.chart_margin_top+d.legendsGroup_height)}];return d.line(c)}),setTimeout(a,d.transitions.duration()),e.exit().remove(),d.k.annotation(d.selector+" #"+d.container_id+"-1",c,d.xScale,d.yScale)},d.renderChart=function(){d.optional_feature().svgContainer(1).legendsContainer().legends().createGroups(1).createChart().axisContainer(),d.k.crossHair(d.svgContainer,d.new_data_length,d.new_data,d.fillColor,d.type)}},PykCharts.multiD.bar=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({}),d=c.multiDimensionalCharts;this.execute=function(c){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.scaleFunction(b),b.data_sort_enable=a.data_sort_enable?a.data_sort_enable.toLowerCase():d.data_sort_enable,b.data_sort_type=PykCharts["boolean"](b.data_sort_enable)&&a.data_sort_type?a.data_sort_type.toLowerCase():d.data_sort_type,b.data_sort_order=PykCharts["boolean"](b.data_sort_enable)&&a.data_sort_order?a.data_sort_order.toLowerCase():d.data_sort_order;try{if("ascending"!==b.data_sort_order&&"descending"!==b.data_sort_order)throw b.data_sort_order=d.data_sort_order,"data_sort_order"}catch(e){b.k.warningHandling(e,"9")}b.stop||(b.k.storeInitialDivHeight(),b.panels_enable="no","default"===b.mode&&b.k.loading(),b.multiD=new PykCharts.multiD.configuration(b),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("bar",a),b.compare_data=b.k.__proto__._groupBy("bar",a),b.axis_x_data_format="number",b.axis_y_data_format=b.k.yAxisDataFormatIdentification(b.data),"time"===b.axis_y_data_format&&(b.axis_y_data_format="string"),b.k.remove_loading_bar(d),void b.render())},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},this.transformData=function(){var c=[],d=[];if(b.optionalFeatures().sort(),void 0!=a.chart_color&&0!=a.chart_color.length)b.chart_color[0]=a.chart_color[0];else for(var e=0,f=b.data.length;f>e;e++)if(void 0!=b.data[e].color&&""!=b.data[e].color){b.chart_color[0]=b.data[e].color,(void 0==a.axis_y_pointer_color||""==a.axis_y_pointer_color)&&(b.axis_y_pointer_color=b.chart_color[0]);break}b.data.forEach(function(a){a.x="number"===b.axis_x_data_format?parseFloat(a.x):a.x,a.name=a.y,a.color=b.chart_color[0]});for(var g=0,f=b.data.length;f>g;g++)c[g]=b.data[g].group;d=b.k.__proto__._unique(c),b.no_of_groups=d.length},this.render=function(){var c=b.selector.substring(1,b.selector.length),d=c+"_svg";b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.Configuration.mouseEvent(a),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),b.transformData();try{if(b.no_of_groups>1)throw"Invalid data in the JSON"}catch(e){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+b.selector+'. "'+e+'"  Visit www.pykcharts.com/errors#error_9')}b.map_group_data=b.multiD.mapGroup(b.data),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#"+d,"barChart").emptyDiv(b.selector).subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).createGroups(),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createColumn().axisContainer().ticks(),b.k.xAxis(b.svgContainer,b.xgroup,b.xScale,b.extra_left_margin,b.x_domain,b.x_tick_values).xAxisTitle(b.xgroup).yAxisTitle(b.ygroup),"string"!==b.axis_y_data_format?(b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values,null,"bar",null,b),b.optionalFeatures().newYAxis()):b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values,null,null,null,b)):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+d,"barChart").emptyDiv(b.selector).makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).createGroups(),b.k.liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createColumn().axisContainer().ticks(),b.k.xAxis(b.svgContainer,b.xgroup,b.xScale,b.extra_left_margin,b.x_domain,b.x_tick_values).xAxisTitle(b.xgroup).yAxisTitle(b.ygroup),"string"!==b.axis_y_data_format?(b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values,null,"bar",null,b),b.optionalFeatures().newYAxis()):b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values,null,null,null,b)),b.k.exportSVG(b,"#"+d,"barChart");var f=b.k.resize(b.svgContainer);b.k.__proto__._ready(f),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer,"")})},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("bar",a),b.refresh_data=b.k.__proto__._groupBy("bar",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];b.transformData(),"time"===b.axis_x_data_format&&b.data.forEach(function(a){a.x=b.k.dateConversion(a.x)}),b.map_group_data=b.multiD.mapGroup(b.data),d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().createColumn().ticks(),b.k.xAxis(b.svgContainer,b.xgroup,b.xScale,b.extra_left_margin,b.x_domain,b.x_tick_values),"string"!==b.axis_y_data_format?(b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values,null,"bar"),b.optionalFeatures().newYAxis()):b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values)},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.optionalFeatures=function(){var a=b.selector.substring(1,b.selector.length),c={svgContainer:function(c,d){return document.getElementById(a).className+=" PykCharts-twoD",b.svgContainer=d3.select(b.selector+" #chart-container-"+d).append("svg:svg").attr({width:b.chart_width,height:b.chart_height,id:c,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height}),this},createGroups:function(){return b.group=b.svgContainer.append("g").attr({id:"bar-group",transform:"translate("+b.chart_margin_left+","+b.chart_margin_top+")"}),PykCharts.boolean(b.chart_grid_y_enable)&&b.group.append("g").attr({id:"ygrid","class":"y grid-line"}),this},newYAxis:function(){if(PykCharts["boolean"](b.axis_y_enable)){"right"===b.axis_y_position&&gsvg.attr("transform","translate("+(b.chart_width-b.chart_margin_left-b.chart_margin_right)+",0)");var a=d3.svg.axis().scale(b.yScale).orient(b.axis_y_pointer_position).tickSize(0).outerTickSize(b.axis_y_outer_pointer_length);b.new_yAxisgroup.style("stroke",function(){return b.axis_y_line_color}).call(a),d3.selectAll(b.selector+" .y.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this},axisContainer:function(){return(PykCharts.boolean(b.axis_x_enable)||b.axis_x_title)&&(b.xgroup=b.group.append("g").attr({id:"xaxis","class":"x axis"}).style("stroke","none")),(PykCharts.boolean(b.axis_y_enable)||b.axis_y_title)&&(b.ygroup=b.group.append("g").attr({id:"yaxis","class":"y axis"}),b.new_yAxisgroup=b.group.append("g").attr({id:"new-yaxis","class":"y new-axis"}).style("stroke","blue")),this},createColumn:function(){b.x_tick_values=b.k.processXAxisTickValues(),b.y_tick_values=b.k.processYAxisTickValues(),b.reducedWidth=b.chart_width-b.chart_margin_left-b.chart_margin_right,b.reducedHeight=b.chart_height-b.chart_margin_top-b.chart_margin_bottom;var a,c,d,e,f,g,h,i,j=(b.chart_height-b.chart_margin_top-b.chart_margin_bottom,[]),k=[];"number"===b.axis_y_data_format?(e=[0,d3.max(b.data,function(a){return a.y})],k=b.k._domainBandwidth(e,1),c=[b.chart_height-b.chart_margin_top-b.chart_margin_bottom,0],h=d3.min(b.y_tick_values),i=d3.max(b.y_tick_values),k[0]>h&&(k[0]=h),k[1]<i&&(k[1]=i),b.data.sort(function(a,b){return a.y-b.y}),b.yScale1=b.k.scaleIdentification("linear",k,c),y_data1=b.data.map(function(a){return a.y}),y_range1=[0,b.chart_height-b.chart_margin_top-b.chart_margin_bottom],b.yScale=b.k.scaleIdentification("ordinal",y_data1,y_range1,.3),b.extra_top_margin=b.yScale.rangeBand()/2):"string"===b.axis_y_data_format&&(k=b.data.map(function(a){return a.y}),c=[0,b.chart_height-b.chart_margin_top-b.chart_margin_bottom],b.yScale=b.k.scaleIdentification("ordinal",k,c,.3),b.extra_top_margin=b.yScale.rangeBand()/2),"number"===b.axis_x_data_format&&(a=[0,d3.max(b.data,function(a){return+a.x})],j=b.k._domainBandwidth(a,1),d=[0,b.reducedWidth],f=d3.min(b.x_tick_values),g=d3.max(b.x_tick_values),j[0]>f&&(j[0]=f),j[1]<g&&(j[1]=g),b.xScale=b.k.scaleIdentification("linear",j,d),b.extra_left_margin=0),b.x_domain=b.xScale.domain(),b.y_domain=b.yScale.domain(),b.bar=b.group.selectAll(".bar-rect").data(b.data),b.bar.enter().append("g").attr("class","bar-rect").append("svg:rect"),b.bar.attr("class","bar-rect").select("rect").attr({"class":"hbar",y:function(a){return b.yScale(a.y)},x:0,height:function(a){return b.yScale.rangeBand(a.y)},width:0,fill:function(a){return b.fillColor.colorPieMS(a)},stroke:b.border.color(),"stroke-width":b.border.width(),"stroke-dasharray":b.border.style(),"data-id":function(a){return a.name}}).on({mouseover:function(a){"default"===b.mode&&(PykCharts.boolean(b.chart_onhover_highlight_enable)&&b.mouseEvent1.highlight(b.selector+" .hbar",this),PykCharts["boolean"](b.tooltip_enable)&&(b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.tooltip?a.tooltip:a.x)))},mouseout:function(a){"default"===b.mode&&(PykCharts.boolean(b.chart_onhover_highlight_enable)&&b.mouseEvent1.highlightHide(b.selector+" .hbar"),PykCharts["boolean"](b.tooltip_enable)&&b.mouseEvent.tooltipHide(a),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis"))},mousemove:function(a){"default"===b.mode&&(PykCharts["boolean"](b.tooltip_enable)&&b.mouseEvent.tooltipPosition(a),b.mouseEvent.axisHighlightShow([a.y],b.selector+" .y.axis",b.y_domain))},click:function(a){PykCharts["boolean"](b.click_enable)&&b.addEvents(a.name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr("width",function(a){return b.xScale(a.x)}),b.bar.exit().remove();var l=d3.transform(d3.select(d3.selectAll(b.selector+" .bar-rect")[0][b.data.length-1]).attr("transform")),m=(l.translate[0],l.translate[1]);return c=[b.reducedHeight-m-b.yScale.rangeBand()/2,m+b.yScale.rangeBand()/2],b.yScale1=b.k.scaleIdentification("linear",k,c),this},ticks:function(){function a(){c.attr({x:function(a){return b.xScale(a.x)},y:function(a){return b.yScale(a.name)+b.yScale.rangeBand(a.y)/2},dx:4,dy:4}).text(function(a){return a.x})}if(b.pointer_size){var c=b.group.selectAll(".ticks_label").data(b.data);c.enter().append("text"),c.attr("class","ticks_label").attr("fill",b.pointer_color).style({"font-weight":b.pointer_weight,"font-size":b.pointer_size+"px","font-family":b.pointer_family}).text(""),setTimeout(a,b.transitions.duration())}return this},sort:function(){if("string"===b.axis_y_data_format){try{if("alphabetically"!==b.data_sort_type&&"numerically"!==b.data_sort_type)throw b.data_sort_type=d.data_sort_type,"data_sort_type"}catch(a){b.k.warningHandling(a,"8")}var c="";switch(b.data_sort_type){case"alphabetically":case"date":c="y";break;case"numerically":c="x"}b.data=b.k.__proto__._sortData(b.data,c,"group",b,"notApplicable")}}};return c}},PykCharts.multiD.groupedBar=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({}),d=c.multiDimensionalCharts;this.execute=function(c){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.scaleFunction(b),b.data_sort_enable=a.data_sort_enable?a.data_sort_enable.toLowerCase():d.data_sort_enable,b.data_sort_type=PykCharts["boolean"](b.data_sort_enable)&&a.data_sort_type?a.data_sort_type.toLowerCase():d.data_sort_type,b.data_sort_order=PykCharts["boolean"](b.data_sort_enable)&&a.data_sort_order?a.data_sort_order.toLowerCase():d.data_sort_order;
try{if("ascending"!==b.data_sort_order&&"descending"!==b.data_sort_order)throw b.data_sort_order=d.data_sort_order,"data_sort_order"}catch(e){b.k.warningHandling(e,"9")}b.stop||(b.k.storeInitialDivHeight(),b.panels_enable="no","default"===b.mode&&b.k.loading(),b.multiD=new PykCharts.multiD.configuration(b),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("bar",a),b.compare_data=b.k.__proto__._groupBy("bar",a),b.axis_x_data_format="number",b.axis_y_data_format=b.k.yAxisDataFormatIdentification(b.data),"time"===b.axis_y_data_format&&(b.axis_y_data_format="string"),b.k.remove_loading_bar(d),void b.render())},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},b.dataTransformation=function(){PykCharts["boolean"](b.data_sort_enable)&&(b.data=b.optionalFeatures().sort(b.data,"group")),b.group_arr=[],b.new_data=[],b.data_length=b.data.length;for(var a=0;a<b.data_length;a++)b.group_arr[a]=b.data[a].y;b.uniq_group_arr=b.k.__proto__._unique(b.group_arr);for(var c=b.uniq_group_arr.length,d=0;c>d;d++){b.new_data[d]={name:b.uniq_group_arr[d],data:[]};for(var e=0;e<b.data_length;e++)b.uniq_group_arr[d]===b.data[e].y&&b.new_data[d].data.push({x:b.data[e].x,name:b.data[e].group,tooltip:b.data[e].tooltip,color:b.data[e].color})}if(b.new_data_length=b.new_data.length,!PykCharts["boolean"](b.data_sort_enable))for(var f=0;f<b.new_data_length;f++)b.new_data[f].data=b.optionalFeatures().sort(b.new_data[f].data,"name")},b.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("bar",a),b.refresh_data=b.k.__proto__._groupBy("bar",a),b.dataTransformation(),b.optionalFeatures().mapColors();var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().createChart().legends().ticks().highlightRect(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height),"string"!==b.axis_y_data_format?(b.k.yAxis(b.svgContainer,b.yGroup,b.yScale1,b.ydomain,b.y_tick_values,b.legendsGroup_width,"groupbar"),b.optionalFeatures().newYAxis()):b.k.yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain,b.y_tick_values,b.legendsGroup_width)},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},b.render=function(){var b=this,c=b.selector.substring(1,b.selector.length),d=c+"_svg";b.dataTransformation(),b.optionalFeatures().mapColors(),b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.Configuration.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#"+d,"groupbarChart").emptyDiv(b.selector).subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).legendsContainer(1),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().legends().createGroups(1).createChart().axisContainer().highlightRect().ticks(),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup),"string"!==b.axis_y_data_format?(b.k.yAxis(b.svgContainer,b.yGroup,b.yScale1,b.ydomain,b.y_tick_values,b.legendsGroup_width,"groupbar"),b.optionalFeatures().newYAxis()):b.k.yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain,b.y_tick_values,b.legendsGroup_width)):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+d,"groupbarChart").emptyDiv(b.selector).makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).legendsContainer(1).createGroups(1).createChart().axisContainer().highlightRect(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup),"string"!==b.axis_y_data_format?(b.k.yAxis(b.svgContainer,b.yGroup,b.yScale1,b.ydomain,b.y_tick_values,b.legendsGroup_width,"groupbar"),b.optionalFeatures().newYAxis()):b.k.yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain,b.y_tick_values,b.legendsGroup_width)),b.k.exportSVG(b,"#"+d,"groupbarChart");var e=b.k.resize(b.svgContainer);b.k.__proto__._ready(e),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},b.optionalFeatures=function(){var a=this,b=a.selector.substring(1,a.selector.length),c={svgContainer:function(c,d){return document.getElementById(b).className+=" PykCharts-twoD",a.svgContainer=d3.select(a.selector+" #chart-container-"+d).append("svg:svg").attr({width:a.chart_width,height:a.chart_height,id:c,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+a.chart_width+" "+a.chart_height}),this},createGroups:function(){return a.group=a.svgContainer.append("g").attr({id:"groupedBar-group",transform:"translate("+a.chart_margin_left+","+(a.chart_margin_top+a.legendsGroup_height)+")"}),this},legendsContainer:function(){return PykCharts.boolean(a.legends_enable)&&"default"===a.mode?a.legendsGroup=a.svgContainer.append("g").attr({id:"groupedBar-legends","class":"legends",transform:"translate(0,10)"}).style("visibility","hidden"):(a.legendsGroup_height=0,a.legendsGroup_width=0),this},axisContainer:function(){return(PykCharts.boolean(a.axis_x_enable)||a.axis_x_title)&&(a.xGroup=a.group.append("g").attr({"class":"x axis",id:"xaxis"}).style("stroke","black")),(PykCharts.boolean(a.axis_y_enable)||a.axis_y_title)&&(a.yGroup=a.group.append("g").attr({"class":"y axis",id:"yaxis"}).style("stroke","blue"),a.new_yAxisgroup=a.group.append("g").attr({"class":"y new-axis",id:"new-yaxis"}).style("stroke","blue")),this},createChart:function(){a.reduced_width=a.chart_width-a.chart_margin_left-a.chart_margin_right-a.legendsGroup_width,a.reduced_height=a.chart_height-a.chart_margin_top-a.chart_margin_bottom-a.legendsGroup_height,a.getuniqueGroups=a.data.map(function(a){return a.group}),a.getuniqueGroups=a.k.__proto__._unique(a.getuniqueGroups),a.getuniqueGroups.sort(function(a,b){return a>b?1:-1}),a.x_tick_values=a.k.processXAxisTickValues(),a.y_tick_values=a.k.processYAxisTickValues();var b,c,d,e,f,g,h,i,j,k=[];"number"===a.axis_y_data_format?(max=d3.max(a.new_data,function(a){return a.name}),min=d3.min(a.new_data,function(a){return a.name}),f=[min,max],c=f,i=d3.min(a.y_tick_values),j=d3.max(a.y_tick_values),c[0]>i&&(c[0]=i),c[1]<j&&(c[1]=j),a.new_data.sort(function(a,b){return a.name-b.name}),y_data1=a.new_data.map(function(a){return a.name}),y_range1=[a.reduced_height,0],a.yScale=a.k.scaleIdentification("ordinal",y_data1,y_range1,.3),a.extra_top_margin=a.yScale.rangeBand()/2,a.y1=d3.scale.ordinal().domain(a.getuniqueGroups).rangeRoundBands([a.yScale.rangeBand(),0]),a.extra_top_margin=0):"string"===a.axis_y_data_format&&(c=a.new_data.map(function(a){return a.name}),d=[0,a.reduced_height],a.yScale=a.k.scaleIdentification("ordinal",c,d,.3),a.extra_top_margin=a.yScale.rangeBand()/2,a.y1=d3.scale.ordinal().domain(a.getuniqueGroups).rangeRoundBands([0,a.yScale.rangeBand()])),"number"===a.axis_x_data_format&&(a.max_x_value=d3.max(a.new_data,function(a){return d3.max(a.data,function(a){return a.x})}),b=[0,a.max_x_value],k=a.k._domainBandwidth(b,1),e=[0,a.reduced_width],g=d3.min(a.x_tick_values),h=d3.max(a.x_tick_values),k[0]>g&&(k[0]=g),k[1]<h&&(k[1]=h),a.xScale=a.k.scaleIdentification("linear",k,e),a.extra_left_margin=0),a.xdomain=a.xScale.domain(),a.ydomain=a.yScale.domain(),a.highlight_x_positions=[];var l=a.group.selectAll(".groupedBar-rect").data(a.new_data);l.enter().append("g").attr("class","groupedBar-rect"),a.highlight_y_positions="",l.attr("transform",function(b){return a.optionalFeatures().checkIfHighLightDataExists(b.name),a.highlight_group_exits&&(a.flag=!0,a.highlight_y_positions=a.yScale(b.name)),"translate(0,"+a.yScale(b.name)+")"}).on({mouseout:function(){"default"===a.mode&&(PykCharts.boolean(a.chart_onhover_highlight_enable)&&a.mouseEvent.highlightGroupHide(a.selector+" .groupedBar-rect","rect"),a.mouseEvent.axisHighlightHide(a.selector+" .y.axis"))},mousemove:function(b){"default"===a.mode&&(PykCharts.boolean(a.chart_onhover_highlight_enable)&&a.mouseEvent.highlightGroup(a.selector+" .groupedBar-rect",this,"rect"),a.mouseEvent.axisHighlightShow(b.name,a.selector+" .y.axis",a.ydomain,"bar"))}});var m=l.selectAll("rect").data(function(a){return a.data});m.enter().append("rect"),m.attr({height:0,y:function(b){return a.y1(b.name)},x:0,width:0,height:function(){return.98*a.y1.rangeBand()},fill:function(b){return a.fillColor.colorGroup(b)},"fill-opacity":function(b,c){return"saturation"===a.color_mode?(c+1)/a.no_of_groups:1},stroke:a.border.color(),"stroke-width":a.border.width(),"stroke-dasharray":a.border.style(),"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(a){return a.name}}).on({mouseover:function(b){if("default"===a.mode&&PykCharts["boolean"](a.tooltip_enable)){var c=b.tooltip?b.tooltip:b.x;a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(c)}},mouseout:function(b){"default"===a.mode&&PykCharts["boolean"](a.tooltip_enable)&&a.mouseEvent.tooltipHide(b)},mousemove:function(b){"default"===a.mode&&PykCharts["boolean"](a.tooltip_enable)&&a.mouseEvent.tooltipPosition(b)},click:function(b){PykCharts["boolean"](a.click_enable)&&a.addEvents(b.name,d3.select(this).attr("data-id"))}}).transition().duration(a.transitions.duration()).attr("width",function(b){return a.xScale(b.x)}),m.exit().remove(),l.exit().remove();var n=d3.transform(d3.select(d3.selectAll(".groupedBar-rect")[0][a.new_data.length-1]).attr("transform")),o=(n.translate[0],n.translate[1]);return d=[a.reduced_height-o-2*a.y1.rangeBand(),o+2*a.y1.rangeBand()],a.yScale1=a.k.scaleIdentification("linear",c,d),this},ticks:function(){function b(){d.attr({x:function(b){return a.xScale(b.x)},y:function(b){return a.y1(b.name)+a.y1.rangeBand()/2},dx:4,dy:2}).transition().text(function(a){return a.x?a.x.toFixed():void 0}).attr({"pointer-events":"none"}).text(function(b){return b.x&&(a.txt_width=this.getBBox().width,a.txt_height=this.getBBox().height,b.x&&a.txt_width<a.xScale(b.x)&&a.txt_height<a.y1.rangeBand())?b.x:void 0})}if(a.pointer_size){var c=a.group.selectAll(".groupedBar-ticks").data(a.new_data);c.enter().append("g").attr("class","groupedBar-ticks"),c.attr("transform",function(b){return"translate(0,"+a.yScale(b.name)+")"});var d=c.selectAll(".ticks_label").data(function(a){return a.data});d.enter().append("text"),d.attr("class","ticks_label").style("font-weight",a.pointer_weight).style("font-size",a.pointer_size+"px").attr("fill",a.pointer_color).style("font-family",a.pointer_family).text(""),setTimeout(b,a.transitions.duration()),d.exit().remove(),c.exit().remove()}return this},mapColors:function(){a.no_of_groups=d3.max(a.new_data,function(a){return a.data.length});for(var b=0;b<a.new_data_length;b++)if(a.new_data[b].data.length===a.no_of_groups){a.group_data=a.new_data[b].data,a.group_data_length=a.group_data.length;break}for(var b=0;b<a.group_data_length;b++)a.group_data[b].color="color"===a.color_mode&&a.chart_color[b]?a.chart_color[b]:a.default_color[0];a.new_data.forEach(function(b){b.data.forEach(function(b){for(var c=0;c<a.group_data_length;c++)if(a.group_data[c].name===b.name){b.color=a.group_data[c].color;break}})})},legends:function(){if(PykCharts.boolean(a.legends_enable)){var b,c=a.group_data;b=c.map(function(a){return a.color}),c=c.map(function(a){return a.name}),c=a.k.__proto__._unique(c),a.multiD.legendsPosition(a,"groupBar",c,b)}return this},checkIfHighLightDataExists:function(b){return a.highlight&&("number"===a.axis_y_data_format?a.highlight_group_exits=a.highlight===b:"string"===a.axis_y_data_format&&(a.highlight_group_exits=a.highlight.toLowerCase()===b.toLowerCase())),this},highlightRect:function(){function b(){y=a.highlight_y_positions-5;var b=a.group.selectAll(".highlight-groupedBar-rect").data([a.highlight]);b.enter().append("rect"),b.attr("class","highlight-groupedBar-rect").attr({x:0,y:y,height:a.y1.rangeBand()*a.group_data_length+10,width:a.reduced_width+5,fill:"none",stroke:a.highlight_color,"stroke-width":"1.5px","stroke-dasharray":"5,5","stroke-opacity":1}),b.exit().remove(),PykCharts["boolean"](a.highlight_y_positions)?highlight_array=a.highlight:b.remove()}return a.flag&&setTimeout(b,a.transitions.duration()),this},newYAxis:function(){if(PykCharts["boolean"](a.axis_y_enable)){"right"===a.axis_y_position&&a.new_yAxisgroup.attr("transform","translate("+(a.chart_width-a.chart_margin_left-a.chart_margin_right-a.legendsGroup_width)+",0)");var b=d3.svg.axis().scale(a.yScale).orient(a.axis_y_pointer_position).tickSize(0).outerTickSize(a.axis_y_outer_pointer_length);a.new_yAxisgroup.style("stroke",function(){return a.axis_y_line_color}).call(b),d3.selectAll(a.selector+" .y.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this},sort:function(b,c){if("string"===a.axis_y_data_format){try{if("alphabetically"!==a.data_sort_type)throw a.data_sort_type=d.data_sort_type,"data_sort_type"}catch(e){a.k.warningHandling(e,"8")}return b=a.k.__proto__._sortData(b,"y",c,a)}return b}};return c}},PykCharts.multiD.column=function(a){var b=this;b.interval="";new PykCharts.Configuration.Theme({});this.execute=function(c){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.scaleFunction(b),PykCharts.grid(b),b.stop||(b.panels_enable="no",b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.multiD=new PykCharts.multiD.configuration(b),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("column",a),b.compare_data=b.k.__proto__._groupBy("column",a),b.axis_y_data_format="number",b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),b.k.remove_loading_bar(d),void b.render())},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},this.transformData=function(){var c=[],d=[];if(0!=a.chart_color&&void 0!=a.chart_color)b.chart_color[0]=a.chart_color[0];else for(var e=0,f=b.data.length;f>e;e++)if(""!=b.data[e].color&&void 0!=b.data[e].color){b.chart_color[0]=b.data[e].color,(void 0==a.axis_x_pointer_color||""==a.axis_x_pointer_color)&&(b.axis_x_pointer_color=b.chart_color[0]);break}b.data.forEach(function(a){a.name=a.x,a.color=b.chart_color[0]});for(var g=0,f=b.data.length;f>g;g++)c[g]=b.data[g].group;d=b.k.__proto__._unique(c),b.no_of_groups=d.length},this.render=function(){var c=b.selector.substring(1,b.selector.length),d=c+"_svg";b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.Configuration.mouseEvent(a),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),b.transformData();try{if(b.no_of_groups>1)throw"Invalid data in the JSON"}catch(e){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+b.selector+'. "'+e+'"  Visit www.pykcharts.com/errors#error_8')}"time"===b.axis_x_data_format&&b.data.forEach(function(a){a.x=b.k.dateConversion(a.x)}),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#"+d,"columnChart").emptyDiv(b.selector).subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).createGroups(),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createColumn().axisContainer(),b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values).yGrid(b.svgContainer,b.group,b.yScale).xAxisTitle(b.xgroup).yAxisTitle(b.ygroup),"string"!==b.axis_x_data_format?(console.log(b.xScale1.domain()),b.k.xAxis(b.svgContainer,b.xgroup,b.xScale1,b.extra_left_margin,b.x_domain,b.x_tick_values,null,"bar",b),b.optionalFeatures().newXAxis()):b.k.xAxis(b.svgContainer,b.xgroup,b.xScale,b.extra_left_margin,b.x_domain,b.x_tick_values,null,null,b)):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+d,"columnChart").emptyDiv(b.selector).makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).createGroups(),b.k.liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().createColumn().axisContainer(),b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values).xAxisTitle(b.xgroup).yAxisTitle(b.ygroup),"string"!==b.axis_x_data_format?(b.k.xAxis(b.svgContainer,b.xgroup,b.xScale1,b.extra_left_margin,b.x_domain,b.x_tick_values,null,"bar"),b.optionalFeatures().newXAxis()):b.k.xAxis(b.svgContainer,b.xgroup,b.xScale,b.extra_left_margin,b.x_domain,b.x_tick_values)),b.k.exportSVG(b,"#"+d,"columnChart");var f=b.k.resize(b.svgContainer);b.k.__proto__._ready(f),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},this.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("column",a),b.refresh_data=b.k.__proto__._groupBy("column",a);var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];b.transformData(),"time"===b.axis_x_data_format&&b.data.forEach(function(a){a.x=b.k.dateConversion(a.x),a.color=b.chart_color[0]});try{if(b.no_of_groups>1)throw"Invalid data in the JSON"}catch(e){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+b.selector+'. "'+e+'"  Visit www.pykcharts.com/errors#error_8')}d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().createColumn(),b.k.yAxis(b.svgContainer,b.ygroup,b.yScale,b.y_domain,b.y_tick_values).yGrid(b.svgContainer,b.group,b.yScale),"string"!==b.axis_x_data_format?(b.k.xAxis(b.svgContainer,b.xgroup,b.xScale,b.extra_left_margin,b.x_domain,b.x_tick_values,null,"bar"),b.optionalFeatures().newXAxis()):b.k.xAxis(b.svgContainer,b.xgroup,b.xScale,b.extra_left_margin,b.x_domain,b.x_tick_values)},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.optionalFeatures=function(){var a=b.selector.substring(1,b.selector.length),c={svgContainer:function(c,d){return document.getElementById(a).className+=" PykCharts-twoD",b.svgContainer=d3.select(b.selector+" #chart-container-"+d).append("svg:svg").attr({width:b.chart_width,height:b.chart_height,id:c,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+b.chart_width+" "+b.chart_height}),this},createGroups:function(){return b.group=b.svgContainer.append("g").attr({id:"column-group",transform:"translate("+b.chart_margin_left+","+b.chart_margin_top+")"}),PykCharts.boolean(b.chart_grid_y_enable)&&b.group.append("g").attr({id:"ygrid","class":"y grid-line"}),this},axisContainer:function(){return(PykCharts.boolean(b.axis_x_enable)||b.axis_x_title)&&(b.xgroup=b.group.append("g").attr({id:"xaxis","class":"x axis"}).style("stroke","none")),(PykCharts.boolean(b.axis_y_enable)||b.axis_y_title)&&(b.ygroup=b.group.append("g").attr({id:"yaxis","class":"y axis"}),b.new_xAxisgroup=b.group.append("g").attr({"class":"x new-axis",id:"new-xaxis"}).style("stroke","blue")),this},createColumn:function(){b.x_tick_values=b.k.processXAxisTickValues(),b.y_tick_values=b.k.processYAxisTickValues(),b.reducedWidth=b.chart_width-b.chart_margin_left-b.chart_margin_right;var a,c,d,e,f,g,h,i,j=b.chart_height-b.chart_margin_top-b.chart_margin_bottom,k=[],l=[];"number"===b.axis_y_data_format?(e=[0,d3.max(b.data,function(a){return a.y})],l=b.k._domainBandwidth(e,1),c=[b.chart_height-b.chart_margin_top-b.chart_margin_bottom,0],h=d3.min(b.y_tick_values),i=d3.max(b.y_tick_values),l[0]>h&&(l[0]=h),l[1]<i&&(l[1]=i),b.yScale=b.k.scaleIdentification("linear",l,c),b.extra_top_margin=0):"string"===b.axis_y_data_format?(l=b.data.map(function(a){return a.y}),c=[0,b.chart_height-b.chart_margin_top-b.chart_margin_bottom],b.yScale=b.k.scaleIdentification("ordinal",l,c,.3),b.extra_top_margin=b.yScale.rangeBand()/2):"time"===b.axis_y_data_format&&(l=d3.extent(b.data,function(a){return parseDate(a.y)}),h=d3.min(b.y_tick_values,function(a){return new Date(a)}),i=d3.max(b.y_tick_values,function(a){return new Date(a)}),new Date(l[0])>new Date(h)&&(l[0]=h),new Date(l[1])<new Date(i)&&(l[1]=max__tick_value),c=[b.chart_height-b.chart_margin_top-b.chart_margin_bottom,0],b.yScale=b.k.scaleIdentification("time",l,c),b.extra_top_margin=0),"number"===b.axis_x_data_format?(a=[d3.min(b.data,function(a){return+a.x}),d3.max(b.data,function(a){return+a.x})],console.log(a),k=b.k._domainBandwidth(a),d=[0,b.reducedWidth],f=d3.min(b.x_tick_values),g=d3.max(b.x_tick_values),k[0]>f&&(k[0]=f),k[1]<g&&(k[1]=g),b.data.sort(function(a,b){return a.x-b.x}),console.log(k),b.xScale1=b.k.scaleIdentification("linear",k,d),x_data1=b.data.map(function(a){return a.x}),x_range1=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("ordinal",x_data1,x_range1,.3),b.extra_left_margin=b.xScale.rangeBand()/2):"string"===b.axis_x_data_format?(k=b.data.map(function(a){return a.x}),d=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("ordinal",k,d,.3),b.extra_left_margin=b.xScale.rangeBand()/2):"time"===b.axis_x_data_format&&(max=d3.max(b.data,function(a){return a.x}),min=d3.min(b.data,function(a){return a.x}),a=[min.getTime(),max.getTime()],f=d3.min(b.x_tick_values,function(a){return b.k.dateConversion(a)}),g=d3.max(b.x_tick_values,function(a){return b.k.dateConversion(a)}),k[0]>f&&(k[0]=f),k[1]<g&&(k[1]=g),d=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("time",a,d),b.data.sort(function(a,b){return a.x<b.x?-1:a.x>b.x?1:void 0}),console.log(data),b.xScale1=b.k.scaleIdentification("linear",k,d),x_data1=b.data.map(function(a){return a.x}),x_range1=[0,b.reducedWidth],b.xScale=b.k.scaleIdentification("ordinal",x_data1,x_range1,.3),b.extra_left_margin=b.xScale.rangeBand()/2),b.x_domain=b.xScale.domain(),b.y_domain=b.yScale.domain(),b.bar=b.group.selectAll(".column-rect").data(b.data),b.bar.enter().append("g").attr("class","column-rect").append("svg:rect"),b.bar.attr("class","column-rect").select("rect").attr({"class":"vcolumn",x:function(a){return b.xScale(a.x)},y:j,height:0,width:function(a){return b.xScale.rangeBand(a.x)},fill:function(a){return b.fillColor.colorPieMS(a)},stroke:b.border.color(),"stroke-width":b.border.width(),"stroke-dasharray":b.border.style(),"data-id":function(a){return a.name}}).on({mouseover:function(a){"default"===b.mode&&(PykCharts.boolean(b.chart_onhover_highlight_enable)&&b.mouseEvent1.highlight(b.selector+" .vcolumn",this),PykCharts["boolean"](b.tooltip_enable)&&(b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(a.tooltip?a.tooltip:a.y)))},mouseout:function(a){"default"===b.mode&&(PykCharts.boolean(b.chart_onhover_highlight_enable)&&b.mouseEvent1.highlightHide(b.selector+" .vcolumn"),PykCharts["boolean"](b.tooltip_enable)&&b.mouseEvent.tooltipHide(a),b.mouseEvent.axisHighlightHide(b.selector+" .x.axis"))},mousemove:function(a){"default"===b.mode&&(PykCharts["boolean"](b.tooltip_enable)&&b.mouseEvent.tooltipPosition(a),b.mouseEvent.axisHighlightShow(a.x,b.selector+" .x.axis",b.x_domain))},click:function(a){PykCharts["boolean"](b.click_enable)&&b.addEvents(a.name,d3.select(this).attr("data-id"))}}).transition().duration(b.transitions.duration()).attr({y:function(a){return b.yScale(a.y)},height:function(a){return j-b.yScale(a.y)}}),b.bar.exit().remove();{var m=d3.transform(d3.select(d3.selectAll(b.selector+" .column-rect")[0][b.data.length-1]).attr("transform")),n=m.translate[0];m.translate[1]}return d=[n+b.xScale.rangeBand(),b.reducedWidth-n-b.xScale.rangeBand()],b.xScale1=b.k.scaleIdentification("linear",k,d),this},newXAxis:function(){if(PykCharts["boolean"](b.axis_x_enable)){"bottom"===b.axis_x_position&&b.new_xAxisgroup.attr("transform","translate(0,"+(b.chart_height-b.chart_margin_top-b.chart_margin_bottom)+")");var a=d3.svg.axis().scale(b.xScale).orient(b.axis_x_pointer_position).tickSize(0).ticks(b.axis_x_no_of_axis_value).outerTickSize(b.axis_x_outer_pointer_length);b.new_xAxisgroup.style("stroke",function(){return b.axis_x_line_color}).call(a),d3.selectAll(b.selector+" .x.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this}};return c}},PykCharts.multiD.groupedColumn=function(a){var b=this;b.interval="";new PykCharts.Configuration.Theme({});this.execute=function(c){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.scaleFunction(b),PykCharts.grid(b),b.stop||(b.panels_enable="no",b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.multiD=new PykCharts.multiD.configuration(b),b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("column",a),b.compare_data=b.k.__proto__._groupBy("column",a),b.axis_y_data_format="number",b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),b.k.remove_loading_bar(d),void b.render())},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},b.dataTransformation=function(){b.group_arr=[],b.new_data=[],b.data_length=b.data.length;for(var a=0;a<b.data_length;a++)b.group_arr[a]=b.data[a].x;b.uniq_group_arr=b.k.__proto__._unique(b.group_arr);for(var c=b.uniq_group_arr.length,d=0;c>d;d++){b.new_data[d]={name:b.uniq_group_arr[d],data:[]};for(var e=0;e<b.data_length;e++)b.uniq_group_arr[d]===b.data[e].x&&b.new_data[d].data.push({y:b.data[e].y,name:b.data[e].group,tooltip:b.data[e].tooltip,color:b.data[e].color})}b.new_data_length=b.new_data.length},b.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("column",a),b.refresh_data=b.k.__proto__._groupBy("column",a),b.map_group_data=b.multiD.mapGroup(b.data),b.dataTransformation(),b.optionalFeatures().mapColors(),"time"===b.axis_x_data_format&&(b.new_data.forEach(function(a){a.name=b.k.dateConversion(a.name)}),b.data.forEach(function(a){a.x=b.k.dateConversion(a.x)}));var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().createChart().legends().highlightRect(),b.k.yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain,b.y_tick_values,b.legendsGroup_width).yGrid(b.svgContainer,b.group,b.yScale,b.legendsGroup_width),"string"!==b.axis_y_data_format?(b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height,"groupcolumn"),b.optionalFeatures().newXAxis()):b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height)},PykCharts.boolean(b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},b.render=function(){var b=this,c=b.selector.substring(1,b.selector.length),d=c+"_svg";b.map_group_data=b.multiD.mapGroup(b.data),b.dataTransformation(),b.optionalFeatures().mapColors(),"time"===b.axis_x_data_format&&(b.new_data.forEach(function(a){a.name=b.k.dateConversion(a.name)}),b.data.forEach(function(a){a.x=b.k.dateConversion(a.x)})),b.border=new PykCharts.Configuration.border(b),b.transitions=new PykCharts.Configuration.transition(b),b.mouseEvent1=new PykCharts.Configuration.mouseEvent(b),b.fillColor=new PykCharts.Configuration.fillChart(b,null,a),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#"+d,"groupColumnChart").emptyDiv(b.selector).subtitle().makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).legendsContainer(1),b.k.liveData(b).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().legends().createGroups(1).createChart().axisContainer().highlightRect(),b.k.yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain,b.y_tick_values,b.legendsGroup_width).yGrid(b.svgContainer,b.group,b.yScale,b.legendsGroup_width).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup),"string"!==b.axis_y_data_format?(b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height,"groupcolumn"),b.optionalFeatures().newXAxis()):b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height)):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+d,"groupColumnChart").emptyDiv(b.selector).makeMainDiv(b.selector,1),b.optionalFeatures().svgContainer(d,1).legendsContainer(1).createGroups(1).createChart().axisContainer().highlightRect(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.k.yAxis(b.svgContainer,b.yGroup,b.yScale,b.ydomain,b.y_tick_values,b.legendsGroup_width).xAxisTitle(b.xGroup).yAxisTitle(b.yGroup),"string"!==b.axis_y_data_format?(b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height,"groupcolumn"),b.optionalFeatures().newXAxis()):b.k.xAxis(b.svgContainer,b.xGroup,b.xScale,b.extra_left_margin,b.xdomain,b.x_tick_values,b.legendsGroup_height)),b.k.exportSVG(b,"#"+d,"groupColumnChart");var e=b.k.resize(b.svgContainer);b.k.__proto__._ready(e),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},b.optionalFeatures=function(){var a=this,b=a.selector.substring(1,a.selector.length),c={svgContainer:function(c,d){return document.getElementById(b).className+=" PykCharts-twoD",a.svgContainer=d3.select(a.selector+" #chart-container-"+d).append("svg:svg").attr({width:a.chart_width,height:a.chart_height,id:c,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+a.chart_width+" "+a.chart_height}),this},createGroups:function(){return a.group=a.svgContainer.append("g").attr({id:"groupedColumn-group",transform:"translate("+a.chart_margin_left+","+(a.chart_margin_top+a.legendsGroup_height)+")"}),PykCharts.boolean(a.chart_grid_y_enable)&&a.group.append("g").attr({id:"ygrid","class":"y grid-line"}),this},legendsContainer:function(){return PykCharts.boolean(a.legends_enable)&&"default"===a.mode?a.legendsGroup=a.svgContainer.append("g").attr({id:"groupedColumn-legends","class":"legends",transform:"translate(0,10)"}).style("visibility","hidden"):(a.legendsGroup_height=0,a.legendsGroup_width=0),this},axisContainer:function(){return(PykCharts.boolean(a.axis_x_enable)||a.axis_x_title)&&(a.xGroup=a.group.append("g").attr({"class":"x axis",id:"xaxis"}).style("stroke","black"),a.new_xAxisgroup=a.group.append("g").attr({"class":"x new-axis",id:"new-xaxis"}).style("stroke","blue")),(PykCharts.boolean(a.axis_y_enable)||a.axis_y_title)&&(a.yGroup=a.group.append("g").attr({"class":"y axis",id:"yaxis"}).style("stroke","blue")),this
},createChart:function(){a.reduced_width=a.chart_width-a.chart_margin_left-a.chart_margin_right-a.legendsGroup_width,a.reduced_height=a.chart_height-a.chart_margin_top-a.chart_margin_bottom-a.legendsGroup_height,a.getuniqueGroups=a.data.map(function(a){return a.group}),a.getuniqueGroups=a.k.__proto__._unique(a.getuniqueGroups),a.x_tick_values=a.k.processXAxisTickValues(),a.y_tick_values=a.k.processYAxisTickValues();var b,c,d,e,f,g,h,i,j,k=[];"number"===a.axis_y_data_format&&(a.max_y_value=d3.max(a.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),f=[0,a.max_y_value],c=a.k.__proto__._domainBandwidth(f,1),i=d3.min(a.y_tick_values),j=d3.max(a.y_tick_values),c[0]>i&&(c[0]=i),c[1]<j&&(c[1]=j),d=[a.reduced_height,0],a.yScale=a.k.scaleIdentification("linear",c,d)),"number"===a.axis_x_data_format?(max=d3.max(a.new_data,function(a){return a.name}),min=d3.min(a.new_data,function(a){return a.name}),b=[min,max],k=[min,max],g=d3.min(a.x_tick_values),h=d3.max(a.x_tick_values),k[0]>g&&(k[0]=g),k[1]<h&&(k[1]=h),a.new_data.sort(function(a,b){return a.name-b.name}),e=[0,a.reduced_width],a.xScale1=a.k.scaleIdentification("linear",k,e),x_data1=a.new_data.map(function(a){return a.name}),x_range1=[0,a.reduced_width],a.xScale=a.k.scaleIdentification("ordinal",x_data1,x_range1,.2),a.extra_left_margin=a.xScale.rangeBand()/2,a.xdomain=a.xScale.domain(),a.x1=d3.scale.ordinal().domain(a.getuniqueGroups).rangeRoundBands([0,a.xScale.rangeBand()])):"string"===a.axis_x_data_format?(k=a.new_data.map(function(a){return a.name}),e=[0,a.reduced_width],a.xScale=a.k.scaleIdentification("ordinal",k,e,.2),a.extra_left_margin=a.xScale.rangeBand()/2,a.xdomain=a.xScale.domain(),a.x1=d3.scale.ordinal().domain(a.getuniqueGroups).rangeRoundBands([0,a.xScale.rangeBand()])):"time"===a.axis_x_data_format&&(max=d3.max(a.new_data,function(a){return a.name}),min=d3.min(a.new_data,function(a){return a.name}),b=[min.getTime(),max.getTime()],k=[min,max],e=[0,a.reduced_width],g=d3.min(a.x_tick_values,function(b){return b=a.k.dateConversion(b)}),h=d3.max(a.x_tick_values,function(b){return b=a.k.dateConversion(b)}),k[0]>g&&(k[0]=g),k[1]<h&&(k[1]=h),a.xScale=a.k.scaleIdentification("time",k,e),a.new_data.sort(function(a,b){return new Date(a.name)<new Date(b.name)?-1:new Date(a.name)>new Date(b.name)?1:void 0}),x_data1=a.new_data.map(function(a){return a.name}),x_range1=[0,a.reduced_width],a.xScale1=a.k.scaleIdentification("ordinal",x_data1,x_range1,.2),x_data1=a.new_data.map(function(a){return a.name}),x_range1=[0,a.reduced_width],a.xScale=a.k.scaleIdentification("ordinal",x_data1,x_range1,.2),a.extra_left_margin=a.xScale.rangeBand()/2,a.xdomain=a.xScale.domain(),a.x1=d3.scale.ordinal().domain(a.getuniqueGroups).rangeRoundBands([0,a.xScale.rangeBand()])),a.xdomain=a.xScale.domain(),a.ydomain=a.yScale.domain(),a.highlight_y_positions=[];var l=a.group.selectAll(".groupedColumn-rect").data(a.new_data);l.enter().append("g").attr("class","groupedColumn-rect"),l.attr("transform",function(b){return a.optionalFeatures().checkIfHighLightDataExists(b.name),a.highlight_group_exits&&(a.flag=!0,a.highlight_x_positions=a.xScale(b.name)),"translate("+a.xScale(b.name)+",0)"}).on({mouseout:function(){"default"===a.mode&&(PykCharts.boolean(a.chart_onhover_highlight_enable)&&a.mouseEvent.highlightGroupHide(a.selector+" .groupedColumn-rect","rect"),a.mouseEvent.axisHighlightHide(a.selector+" .x.axis"))},mousemove:function(b){"default"===a.mode&&(PykCharts.boolean(a.chart_onhover_highlight_enable)&&a.mouseEvent.highlightGroup(a.selector+" .groupedColumn-rect",this,"rect"),a.mouseEvent.axisHighlightShow(b.name,a.selector+" .x.axis",a.xdomain))}});var m=l.selectAll("rect").data(function(a){return a.data});m.enter().append("rect"),m.attr("height",0).attr({x:function(b){return a.x1(b.name)},y:a.reduced_height,width:function(){return.98*a.x1.rangeBand()},fill:function(b){return a.fillColor.colorGroup(b)},"fill-opacity":function(b,c){return"saturation"===a.color_mode?(c+1)/a.no_of_groups:1},stroke:a.border.color(),"srtoke-width":a.border.width(),"stroke-dasharray":a.border.style(),"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(a){return a.name}}).on({mouseover:function(b){if("default"===a.mode&&PykCharts["boolean"](a.tooltip_enable)){var c=b.tooltip?b.tooltip:b.y;a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(c)}},mouseout:function(b){"default"===a.mode&&PykCharts["boolean"](a.tooltip_enable)&&a.mouseEvent.tooltipHide(b)},mousemove:function(b){"default"===a.mode&&PykCharts["boolean"](a.tooltip_enable)&&a.mouseEvent.tooltipPosition(b)},click:function(b){PykCharts["boolean"](a.click_enable)&&a.addEvents(b.name,d3.select(this).attr("data-id"))}}).transition().duration(a.transitions.duration()).attr({height:function(b){return a.reduced_height-a.yScale(b.y)},y:function(b){return a.flag&&a.highlight_y_positions.push(a.yScale(b.y)),a.yScale(b.y)}}),l.exit().remove(),m.exit().remove();{var n=d3.transform(d3.select(d3.selectAll(".groupedColumn-rect")[0][a.new_data.length-1]).attr("transform")),o=n.translate[0];n.translate[1]}return e=[a.reduced_height-o-2*a.x1.rangeBand(),o+2*a.x1.rangeBand()],a.xScale1=a.k.scaleIdentification("linear",k,e),this},mapColors:function(){a.no_of_groups=d3.max(a.new_data,function(a){return a.data.length});for(var b=0;b<a.new_data_length;b++)if(a.new_data[b].data.length===a.no_of_groups){a.group_data=a.new_data[b].data,a.group_data_length=a.group_data.length;break}a.new_data.forEach(function(b){b.data.forEach(function(b){for(var c=0;c<a.group_data_length;c++)if(a.group_data[c].name===b.name){b.color=a.group_data[c].color;break}})})},legends:function(){if(PykCharts.boolean(a.legends_enable)){var b,c=a.group_data;b=c.map(function(a){return a.color}),c=c.map(function(a){return a.name}),c=a.k.__proto__._unique(c),a.multiD.legendsPosition(a,"groupColumn",c,b)}return this},checkIfHighLightDataExists:function(b){return a.highlight&&("number"===a.axis_x_data_format?a.highlight_group_exits=a.highlight===b:"string"===a.axis_x_data_format&&(a.highlight_group_exits=a.highlight.toLowerCase()===b.toLowerCase())),this},newXAxis:function(){if(PykCharts["boolean"](a.axis_x_enable)){"bottom"===a.axis_x_position&&a.new_xAxisgroup.attr("transform","translate(0,"+(a.chart_height-a.chart_margin_top-a.chart_margin_bottom-a.legendsGroup_height)+")");var b=d3.svg.axis().scale(a.xScale).orient(a.axis_x_pointer_position).tickSize(0).outerTickSize(a.axis_x_outer_pointer_length);a.new_xAxisgroup.style("stroke",function(){return a.axis_x_line_color}).call(b),d3.selectAll(a.selector+" .x.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this},highlightRect:function(){function b(){x=a.highlight_x_positions-5;var b=a.group.selectAll(".highlight-groupedColumn-rect").data([a.highlight]);b.enter().append("rect"),b.attr({"class":"highlight-groupedColumn-rect",x:x,y:0,width:a.x1.rangeBand()*a.group_data.length+10,height:a.reduced_height+5,fill:"none",stroke:a.highlight_color,"stroke-width":"1.5px","stroke-dasharray":"5,5","stroke-opacity":1}),b.exit().remove(),PykCharts["boolean"](a.highlight_x_positions)?highlight_array=a.highlight:b.remove()}return a.flag&&setTimeout(b,a.transitions.duration()),this}};return c}},PykCharts.multiD.scatter=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),b.bubbleRadius=a.scatterplot_radius?a.scatterplot_radius:c.multiDimensionalCharts.scatterplot_radius,b.panels_enable="no",PykCharts.scaleFunction(b);try{if(!b.k.__proto__._isNumber(b.bubbleRadius))throw b.bubbleRadius=c.multiDimensionalCharts.scatterplot_radius,"bubbleRadius"}catch(e){b.k.warningHandling(e,"1")}if(!b.stop){b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading();{var f=c.multiDimensionalCharts;c.stylesheet}b.multiD=new PykCharts.multiD.configuration(b),b.scatterplot_pointer_enable=a.scatterplot_pointer_enable?a.scatterplot_pointer_enable.toLowerCase():f.scatterplot_pointer_enable,b.zoomed_out=!0,b.radius_range=PykCharts["boolean"](b.panels_enable)?[2*b.k.__proto__._radiusCalculation(1.1),2*b.k.__proto__._radiusCalculation(2.6)]:[2*b.k.__proto__._radiusCalculation(4.5),2*b.k.__proto__._radiusCalculation(11)],b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);if(b.stop||d===!1)return void b.k.remove_loading_bar(e);b.data=b.k.__proto__._groupBy("scatterplot",c),b.axis_y_data_format=b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"time"===b.axis_y_data_format&&""===b.axis_y_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),b.compare_data=b.k.__proto__._groupBy("scatterplot",c),b.k.remove_loading_bar(e);var f=new PykCharts.multiD.scatterplotFunctions(a,b,"scatterplot");f.render()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}}},PykCharts.multiD.panelsOfScatter=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.scaleFunction(b),b.bubbleRadius=a.scatterplot_radius?a.scatterplot_radius:c.multiDimensionalCharts.scatterplot_radius,b.panels_enable="yes",b.legends_display="horizontal";try{if(!b.k.__proto__._isNumber(b.bubbleRadius))throw b.bubbleRadius=c.multiDimensionalCharts.scatterplot_radius,"bubbleRadius"}catch(e){b.k.warningHandling(e,"1")}if(!b.stop){b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading();{var f=c.multiDimensionalCharts;c.stylesheet}b.multiD=new PykCharts.multiD.configuration(b),b.scatterplot_pointer_enable=a.scatterplot_pointer_enable?a.scatterplot_pointer_enable.toLowerCase():f.scatterplot_pointer_enable,b.zoomed_out=!0,b.radius_range=PykCharts["boolean"](b.panels_enable)?[2*b.k.__proto__._radiusCalculation(3.5),2*b.k.__proto__._radiusCalculation(8)]:[2*b.k.__proto__._radiusCalculation(4.5),2*b.k.__proto__._radiusCalculation(11)],b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);if(b.stop||d===!1)return void b.k.remove_loading_bar(e);b.data=b.k.__proto__._groupBy("scatterplot",c),b.axis_y_data_format=b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"time"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"time"===b.axis_y_data_format&&""===b.axis_y_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),b.compare_data=b.k.__proto__._groupBy("scatterplot",c),b.k.remove_loading_bar(e);var f=new PykCharts.multiD.scatterplotFunctions(a,b,"scatterplot");f.render()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}}},PykCharts.multiD.pulse=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),PykCharts.scaleFunction(b);{var e=c.multiDimensionalCharts;c.stylesheet}b.multiD=new PykCharts.multiD.configuration(b),b.bubbleRadius=a.scatterplot_radius?a.scatterplot_radius:.6*e.scatterplot_radius,b.panels_enable="no";try{if(!b.k.__proto__._isNumber(b.bubbleRadius))throw b.bubbleRadius=.6*e.scatterplot_radius,"bubbleRadius"}catch(f){b.k.warningHandling(f,"1")}b.stop||(b.k.storeInitialDivHeight(),b.zoomed_out=!0,b.radius_range=[2*b.k.__proto__._radiusCalculation(1.1),2*b.k.__proto__._radiusCalculation(3.5)],"default"===b.mode&&b.k.loading(),b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);if(b.stop||d===!1)return void b.k.remove_loading_bar(e);b.data=b.k.__proto__._groupBy("pulse",c),b.axis_y_data_format=b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format=b.k.xAxisDataFormatIdentification(b.data),"date"===b.axis_x_data_format&&""===b.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to pass Date data so please pass axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"date"===b.axis_y_data_format&&""===b.axis_y_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+'.("You seem to pass Date data so please pass axis_y_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),b.compare_data=b.k.__proto__._groupBy("pulse",c),b.k.remove_loading_bar(e);var f=new PykCharts.multiD.scatterplotFunctions(a,b,"pulse");f.render()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))}},PykCharts.multiD.scatterplotFunctions=function(a,b,c){function d(){e.zoomed_out=!1;for(var a,b=PykCharts["boolean"](e.panels_enable)?e.no_of_groups:1,c=0;b>c;c++){var d=d3.select(e.selector+" #"+e.container_id+c);e.k.isOrdinal(d,".x.axis",e.x),e.k.isOrdinal(d,".y.axis",e.yScale),e.optionalFeatures().plotCircle().label().ticks(),d3.select(e.selector+" #"+e.container_id+c).selectAll(".scatterplot-dot").attr({r:function(b){return a=e.sizes(b.weight)*PykCharts.getEvent().scale},cx:function(a){return e.x(a.x)+e.extra_left_margin},cy:function(a){return e.yScale(a.y)+e.extra_top_margin}}),d3.select(e.selector+" #"+e.container_id+c).selectAll(".scatterplot-label").attr({x:function(a){return e.x(a.x)+e.extra_left_margin},y:function(a){return e.yScale(a.y)+e.extra_top_margin+5}}).style("font-size",e.label_size+"px"),d3.select(e.selector+" #"+e.container_id+c).selectAll(".tick_label").attr({x:function(a){return e.x(a.x)},y:function(b){return e.yScale(b.y)-a}})}if("dblclick"===PykCharts.getEvent().sourceEvent.type&&e.count++,e.count===e.zoom_level+1)for(var c=0;b>c;c++){if("yes"===e.panels_enable){e.new_data=[];for(var f=0;f<e.data_length;f++)e.data[f].group===e.uniq_group_arr[c]&&e.new_data.push(e.data[f])}else e.new_data=e.data;d3.select(e.selector+" #"+e.container_id+c).call(function(){return e.zoomOut(c)}),e.count=1}}var e=b;e.refresh=function(b){e.executeRefresh=function(a){e.data=e.k.__proto__._groupBy("scatterplot",a),e.refresh_data=e.k.__proto__._groupBy("scatterplot",a);var b=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=b[0];b[1];e.uniq_group_arr=e.k.__proto__._unique(e.data.map(function(a){return a.group})),b[1]&&e.k.lastUpdatedAt("liveData"),e.map_group_data=e.multiD.mapGroup(e.data),"time"===e.axis_x_data_format&&e.data.forEach(function(a){a.x=e.k.dateConversion(a.x)}),PykCharts["boolean"](e.panels_enable)?PykCharts["boolean"](e.panels_enable)&&"scatterplot"===c&&(document.querySelector(e.selector+" #panels_of_scatter_main_div").innerHTML=null,e.renderChart()):(e.new_data=e.data,e.optionalFeatures().createChart().legends().plotCircle().ticks(),"scatterplot"===c&&e.optionalFeatures().label(0).labelPosition()),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width)},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(b),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(a.data,e,"executeRefresh")},e.calculatePanelInRow=function(){var a,b=parseInt(e.k._getHighestParentsAttribute(e.selector,"width"));a=b?b:d3.select("body").style("width"),e.no_of_containers_in_row=Math.floor(parseInt(a)/e.chart_width),e.no_of_containers_in_row>e.uniq_group_arr.length&&(e.no_of_containers_in_row=e.uniq_group_arr.length),a<e.chart_width&&(e.no_of_containers_in_row=1)},this.render=function(){var a=e.selector.substring(1,e.selector.length);if(e.container_id=a+"_svg",e.map_group_data=e.multiD.mapGroup(e.data),e.fillChart=new PykCharts.Configuration.fillChart(e),e.transitions=new PykCharts.Configuration.transition(e),e.border=new PykCharts.Configuration.border(e),e.uniq_group_arr=e.k.__proto__._unique(e.data.map(function(a){return a.group})),e.no_of_groups=1,PykCharts["boolean"](e.panels_enable)&&e.calculatePanelInRow(),"time"===e.axis_x_data_format&&e.data.forEach(function(a){a.x=e.k.dateConversion(a.x)}),"default"===e.mode)PykCharts["boolean"](e.panels_enable)&&"scatterplot"===c?(e.w=e.chart_width,e.chart_height=e.chart_height,e.chart_margin_left=e.chart_margin_left,e.chart_margin_right=e.chart_margin_right,e.k.title(e.new_width).backgroundColor(e).export(e,e.container_id,c,e.panels_enable,e.uniq_group_arr,e.new_width).emptyDiv(e.selector).subtitle(e.new_width),d3.select(e.selector).append("div").attr("id","panels_of_scatter_main_div"),e.renderChart(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).xAxisTitle(e.xGroup,e.legendsGroup_height,e.legendsGroup_width).yAxisTitle(e.yGroup)):(e.k.title().backgroundColor(e).export(e,"#"+e.container_id+"0",c).emptyDiv(e.selector).subtitle(),e.w=e.chart_width,e.chart_height=e.chart_height,e.new_data=e.data,e.k.makeMainDiv(e.selector,0),e.optionalFeatures().svgContainer(0).legendsContainer(0),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends().createGroups(0).createChart().ticks(),"scatterplot"===c&&e.optionalFeatures().label(0).labelPosition(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).xAxisTitle(e.xGroup,e.legendsGroup_height,e.legendsGroup_width).yAxisTitle(e.yGroup),e.k.exportSVG(e,"#"+e.container_id+"0",c)),e.k.createFooter(e.new_width).lastUpdatedAt().credits().dataSource();else if("infographics"===e.mode)if(PykCharts["boolean"](e.panels_enable)&&"scatterplot"===c){e.k.backgroundColor(e).export(e,e.container_id,c,e.panels_enable,e.uniq_group_arr,e.new_width).emptyDiv(e.selector),e.no_of_groups=e.uniq_group_arr.length,e.data_length=e.data.length,e.w=e.chart_width,e.chart_height=e.chart_height,e.chart_margin_left=e.chart_margin_left,e.chart_margin_right=e.chart_margin_right;for(var b=0;b<e.no_of_groups;b++){e.new_data=[];for(var d=0;d<e.data_length;d++)e.data[d].group===e.uniq_group_arr[b]&&e.new_data.push(e.data[d]);e.k.makeMainDiv(e.selector,b),e.optionalFeatures().svgContainer(b).legendsContainer(b),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends(b).createGroups(b).createChart().label(b).ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).xAxisTitle(e.xGroup,e.legendsGroup_height,e.legendsGroup_width).yAxisTitle(e.yGroup)}e.optionalFeatures().labelPosition(),e.k.exportSVG(e,e.container_id,c,e.panels_enable,e.uniq_group_arr),e.k.emptyDiv(e.selector)}else e.k.backgroundColor(e).export(e,"#"+e.container_id+"0",c).emptyDiv(e.selector),e.w=e.chart_width,e.new_data=e.data,e.k.makeMainDiv(e.selector,0),e.optionalFeatures().svgContainer(0).legendsContainer(0),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends().createGroups(0).createChart().ticks(),"scatterplot"===c&&e.optionalFeatures().label(0).labelPosition(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).xAxisTitle(e.xGroup,e.legendsGroup_height,e.legendsGroup_width).yAxisTitle(e.yGroup),e.k.exportSVG(e,"#"+e.container_id+"0",c);if(PykCharts["boolean"](e.panels_enable)){var f=e.k.resize(void 0,e.new_width);e.k.__proto__._ready(f),window.addEventListener("resize",function(){return e.calculatePanelInRow(),e.k.resize(void 0,e.new_width)})}else{var f=e.k.resize(e.svgContainer);e.k.__proto__._ready(f),window.addEventListener("resize",function(){return e.k.resize(e.svgContainer)})}},e.optionalFeatures=function(){var a=e.selector.substring(1,e.selector.length),b={svgContainer:function(b){document.querySelector(e.selector+" #chart-container-"+b).style.width=e.w;var c=document.getElementById(a);return c.classList.contains("PykCharts-weighted")||(c.className+=" PykCharts-weighted"),e.svgContainer=d3.select(e.selector+" #chart-container-"+b).append("svg").attr({width:e.w,height:e.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.w+" "+e.chart_height,id:e.container_id+""+b,"class":"svgcontainer"}),this},createGroups:function(a){return e.group=e.svgContainer.append("g").attr({transform:"translate("+e.chart_margin_left+","+(e.chart_margin_top+e.legendsGroup_height)+")",id:"main"}),e.ticksElement=e.svgContainer.append("g").attr({transform:"translate("+e.chart_margin_left+","+(e.chart_margin_top+e.legendsGroup_height)+")",id:"main2"}),(PykCharts["boolean"](e.axis_x_enable)||e.axis_x_title)&&(e.xGroup=e.group.append("g").attr({"class":"x axis",id:"xaxis"}).style("stroke","black")),(PykCharts["boolean"](e.axis_y_enable)||e.axis_y_title)&&(e.yGroup=e.group.append("g").attr({"class":"y axis",id:"yaxis"}).style("stroke","blue")),e.clip=e.group.append("svg:clipPath").attr("id","clip"+a+e.selector).append("svg:rect").attr({width:e.w-e.chart_margin_left-e.chart_margin_right-e.legendsGroup_width,height:e.chart_height-e.chart_margin_top-e.chart_margin_bottom-e.legendsGroup_height}),e.chartBody=e.group.append("g").attr({id:"clip"+a,"clip-path":"url(#clip"+a+e.selector+")"}),this},legendsContainer:function(){return PykCharts["boolean"](e.legends_enable)&&e.map_group_data[1]&&"default"===e.mode?e.legendsGroup=e.svgContainer.append("g").attr("id","scatterplot-legends").style("visibility","visible"):(e.legendsGroup_width=0,e.legendsGroup_height=0),this},createChart:function(a){if("scatterplot"==c){e.new_data.sort(function(a,b){return b.weight-a.weight}),e.weight=e.new_data.map(function(a){return a.weight});for(var b=e.weight.length,f=[],g=0;b>g;g++)0!==e.weight[g]&&f.push(e.weight[g]);e.weight=f,e.sorted_weight=e.weight.slice(0).reverse()}else{e.weight=e.new_data.map(function(a){return a.weight});for(var b=e.weight.length,f=[],g=0;b>g;g++)0!==e.weight[g]&&f.push(e.weight[g]);e.weight=f,e.sorted_weight=e.weight.slice(0)}if(e.sorted_weight.sort(function(a,b){return a-b}),e.x_tick_values=e.k.processXAxisTickValues(),e.y_tick_values=e.k.processYAxisTickValues(),e.group.append("text").attr({fill:"black","text-anchor":"end",x:e.w-70,y:e.chart_height+40}),e.zoomed_out===!0){var h,i,j,k,l,m,n,o,p=[],q=[];if("number"===e.axis_y_data_format?(k=d3.extent(e.data,function(a){return parseFloat(a.y)}),q=e.k.__proto__._domainBandwidth(k,2,"number"),i=[e.chart_height-e.chart_margin_top-e.chart_margin_bottom-e.legendsGroup_height,0],n=d3.min(e.y_tick_values),o=d3.max(e.y_tick_values),q[0]>n&&(q[0]=n),q[1]<o&&(q[1]=o),e.yScale=e.k.scaleIdentification("linear",q,i),e.extra_top_margin=0):"string"===e.axis_y_data_format?(e.data.forEach(function(a){q.push(a.y)}),i=[0,e.chart_height-e.chart_margin_top-e.chart_margin_bottom-e.legendsGroup_height],e.yScale=e.k.scaleIdentification("ordinal",q,i,0),e.extra_top_margin=e.yScale.rangeBand()/2):"time"===e.axis_y_data_format&&(q=d3.extent(e.data,function(a){return new Date(a.x)}),n=d3.min(e.y_tick_values,function(a){return new Date(a)}),o=d3.max(e.y_tick_values,function(a){return new Date(a)}),new Date(q[0])>new Date(n)&&(q[0]=n),new Date(q[1])<new Date(o)&&(q[1]=max__tick_value),i=[e.chart_height-e.chart_margin_top-e.chart_margin_bottom-e.legendsGroup_height,0],e.yScale=e.k.scaleIdentification("time",q,i),e.extra_top_margin=0),"number"===e.axis_x_data_format?(h=d3.extent(e.data,function(a){return parseFloat(a.x)}),p=e.k.__proto__._domainBandwidth(h,2),l=d3.min(e.x_tick_values),m=d3.max(e.x_tick_values),p[0]>l&&(p[0]=l),p[1]<m&&(p[1]=m),j=[0,e.w-e.chart_margin_left-e.chart_margin_right-e.legendsGroup_width],e.x=e.k.scaleIdentification("linear",p,j),e.extra_left_margin=0):"string"===e.axis_x_data_format?(e.data.forEach(function(a){p.push(a.x)}),j=[0,e.w-e.chart_margin_left-e.chart_margin_right-e.legendsGroup_width],e.x=e.k.scaleIdentification("ordinal",p,j,0),e.extra_left_margin=e.x.rangeBand()/2):"time"===e.axis_x_data_format&&(max=d3.max(e.data,function(a){return a.x}),min=d3.min(e.data,function(a){return a.x}),h=[min.getTime(),max.getTime()],p=e.k.__proto__._domainBandwidth(h,2,"time"),l=d3.min(e.x_tick_values,function(a){return e.k.dateConversion(a)}),m=d3.max(e.x_tick_values,function(a){return e.k.dateConversion(a)}),p[0]>l&&(p[0]=l),p[1]<m&&(p[1]=m),j=[0,e.w-e.chart_margin_left-e.chart_margin_right],e.x=e.k.scaleIdentification("time",p,j),e.extra_left_margin=0),e.xdomain=e.x.domain(),e.ydomain=e.yScale.domain(),e.x1=1,e.y1=12,e.count=1,"pulse"!==c)var r=d3.behavior.zoom().scale(e.count).x(e.x).y(e.yScale).on("zoom",d);if(PykCharts["boolean"](e.zoom_enable)&&"string"!==e.axis_y_data_format&&"string"!==e.axis_x_data_format&&"default"===e.mode){var s;s=PykCharts["boolean"](e.panels_enable)?e.no_of_groups:1;for(var g=0;g<e.no_of_groups;g++)d3.select(e.selector+" #"+e.container_id+g).call(r),d3.select(e.selector+" #"+e.container_id+g).on({"wheel.zoom":null,"mousewheel.zoom":null})}e.optionalFeatures().plotCircle(a)}return this},legends:function(a){return PykCharts["boolean"](e.legends_enable)&&e.map_group_data[1]&&"default"===e.mode&&e.multiD.legendsPosition(e,"scatter",e.map_group_data[0],void 0,a),this},ticks:function(){function a(){b.text(function(a){return a.name})}if(PykCharts["boolean"](e.scatterplot_pointer_enable)){var b=e.ticksElement.selectAll(".ticks_label").data(e.new_data);b.enter().append("text"),b.attr({"class":"ticks_label",x:function(a){return e.x(a.x)},y:function(a){return e.yScale(a.y)},"pointer-events":"none",dx:-1,dy:function(a){return-e.sizes(a.weight)-4}}).style({"text-anchor":"middle","font-family":e.label_family,"font-size":e.label_size+"px"}).text(""),setTimeout(a,e.transitions.duration()),b.exit().remove()}return this},plotCircle:function(){return e.circlePlot=e.chartBody.selectAll(".scatterplot-dot").data(e.new_data),e.circlePlot.enter().append("circle").attr("class","scatterplot-dot"),e.circlePlot.attr({r:0,cx:function(a){return e.x(a.x)+e.extra_left_margin},cy:function(a){return e.yScale(a.y)+e.extra_top_margin},fill:function(a){return e.fillChart.colorPieW(a)},"fill-opacity":function(a){return"pulse"==c&&PykCharts["boolean"](e.variable_circle_size_enable)?1:e.multiD.opacity(a.weight,e.weight,e.data)},"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(a){return a.x},stroke:e.border.color(),"stroke-width":e.border.width(),"stroke-dasharray":e.border.style(),"stroke-opacity":1}).on({mouseover:function(a){"default"===e.mode&&(PykCharts["boolean"](e.tooltip_enable)&&(tooltipText=a.tooltip?a.tooltip:"<table><thead><th colspan='2'><b>"+a.name+"</b></th></thead><tr><td>X</td><td><b>"+a.x+"</b></td></tr><tr><td>Y</td><td><b>"+a.y+"<b></td></tr><tr><td>Weight</td><td><b>"+a.weight+"</b></td></tr></table>",e.mouseEvent.tooltipPosition(a),e.mouseEvent.tooltipTextShow(tooltipText)),PykCharts["boolean"](e.chart_onhover_highlight_enable)&&(PykCharts["boolean"](e.panels_enable)?e.mouseEvent.highlight(e.selector+" #"+this.parentElement.parentElement.parentElement.parentElement.id+" .scatterplot-dot",this):e.mouseEvent.highlight(e.selector+" .scatterplot-dot",this)))},mouseout:function(a){"default"===e.mode&&(PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipHide(a),PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(PykCharts["boolean"](e.panels_enable)?e.selector+" #"+this.parentElement.parentElement.parentElement.parentElement.id+" .scatterplot-dot":e.selector+" .scatterplot-dot"))},mousemove:function(a){"default"===e.mode&&PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipPosition(a)},dblclick:function(){PykCharts.getEvent().stopPropagation()},mousedown:function(){PykCharts.getEvent().stopPropagation()},click:function(a){PykCharts["boolean"](e.click_enable)&&e.addEvents(a.x,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("r",function(a){return e.sizes(a.weight)}),e.circlePlot.exit().remove(),this},label:function(a){if(PykCharts["boolean"](e.label_size)){var b=e.selector.substring(1,e.selector.length);e.circleLabel=e.chartBody.selectAll(".scatterplot-label").data(e.new_data),e.circleLabel.enter().append("text"),e.circleLabel.attr("class","scatterplot-label").attr("id",b+"-bubble-label-"+a).text(""),e.circleLabel.exit().remove()}return this},labelPosition:function(){function a(){for(var a=0;a<e.no_of_groups;a++)d3.selectAll(e.selector+"-bubble-label-"+a).attr({x:function(a){return e.x(a.x)+e.extra_left_margin},y:function(a){return e.yScale(a.y)+e.extra_top_margin+5},"text-anchor":"middle","pointer-events":"none",fill:e.label_color}).style({"font-weight":e.label_weight,"font-size":e.label_size+"px","font-family":e.label_family}).text(function(a){return a.weight}).text(function(a){return this.getBBox().width<2*e.sizes(a.weight)&&this.getBBox().height<2*e.sizes(a.weight)?a.weight:""})}return setTimeout(a,e.transitions.duration()),this}};return b},e.zoomOut=function(a){e.zoomed_out=!0,e.x1=1,e.y1=12,e.optionalFeatures().createChart(a).label().ticks();var b=d3.select(e.selector+" #"+e.container_id+a),c=b.select("#xaxis"),d=b.select("#yaxis");e.k.xAxis(b,c,e.x,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).yAxis(b,d,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width),d3.select(e.selector+" #"+e.container_id+a).selectAll(".scatterplot-dot").attr({r:function(a){return e.sizes(a.weight)},cx:function(a){return e.x(a.x)+e.extra_left_margin},cy:function(a){return e.yScale(a.y)+e.extra_top_margin}}),d3.select(e.selector+" #"+e.container_id+a).selectAll(".scatterplot-label").style("font-size",e.label_size+"px").attr({x:function(a){return e.x(a.x)+e.extra_left_margin},y:function(a){return e.yScale(a.y)+e.extra_top_margin+5}})},e.renderChart=function(){e.no_of_groups=e.uniq_group_arr.length,e.data_length=e.data.length;for(var a=0;a<e.no_of_groups;a++){e.new_data=[];for(var b=0;b<e.data_length;b++)e.data[b].group===e.uniq_group_arr[a]&&e.new_data.push(e.data[b]);e.k.makeMainDiv(e.selector+" #panels_of_scatter_main_div",a),e.optionalFeatures().svgContainer(a).legendsContainer(a);var d=e.selector.substr(1,e.selector.length);
d3.selectAll("#tooltip-svg-container-"+a+"-pyk-tooltip"+d).remove(),e.k.liveData(e).tooltip(!0,e.selector,a),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().legends(a).createGroups(a).createChart().label(a).ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.x,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).xAxisTitle(e.xGroup,e.legendsGroup_height,e.legendsGroup_width).yAxisTitle(e.yGroup)}e.optionalFeatures().labelPosition(),e.k.exportSVG(e,e.container_id,c,e.panels_enable,e.uniq_group_arr),e.k.emptyDiv(e.selector)}},PykCharts.multiD.spiderWeb=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){var e=c.multiDimensionalCharts;b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),b.bubbleRadius=a.spiderweb_radius?a.spiderweb_radius:.6*e.scatterplot_radius,b.spiderweb_outer_radius_percent=a.spiderweb_outer_radius_percent?a.spiderweb_outer_radius_percent:e.spiderweb_outer_radius_percent,b.panels_enable="no",b.data_sort_enable="yes",b.data_sort_type="alphabetically",b.data_sort_order="ascending";try{if(!b.k.__proto__._isNumber(b.bubbleRadius))throw b.bubbleRadius=.6*e.scatterplot_radius,"spiderweb_radius"}catch(f){b.k.warningHandling(f,"1")}try{if(!b.k.__proto__._isNumber(b.spiderweb_outer_radius_percent))throw b.bubbleRadius=e.spiderweb_outer_radius_percent,"spiderweb_outer_radius_percent"}catch(f){b.k.warningHandling(f,"1")}b.stop||(b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.spiderweb_outer_radius_percent>100&&(b.spiderweb_outer_radius_percent=100),b.multiD=new PykCharts.multiD.configuration(b),b.inner_radius=0,b.executeData=function(a){var c=b.k.validator().validatingJSON(a),d=b.selector.substring(1,b.selector.length);return b.stop||c===!1?void b.k.remove_loading_bar(d):(b.data=b.k.__proto__._groupBy("spiderweb",a),b.compare_data=b.k.__proto__._groupBy("spiderweb",a),b.k.remove_loading_bar(d),void b.render())},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))},b.dataTransformation=function(){b.group_arr=[],b.uniq_group_arr=[],b.x_arr=[],b.uniq_x_arr=[],b.data=b.k.__proto__._sortData(b.data,"x","group",b),b.data_length=b.data.length;for(var a=0;a<b.data_length;a++)b.group_arr[a]=b.data[a].group;b.uniq_group_arr=b.k.__proto__._unique(b.group_arr);for(var c=b.uniq_group_arr.length,d=0;d<b.data_length;d++)b.x_arr[d]=b.data[d].x;b.k.__proto__._unique(b.x_arr);b.new_data=[];for(var d=0;c>d;d++){b.new_data[d]={name:b.uniq_group_arr[d],data:[]};for(var e=0;e<b.data_length;e++)b.uniq_group_arr[d]===b.data[e].group&&b.new_data[d].data.push({x:b.data[e].x,y:b.data[e].y,weight:b.data[e].weight,color:b.data[e].color,tooltip:b.data[e].tooltip})}b.new_data_length=b.new_data.length},b.refresh=function(c){b.executeRefresh=function(a){b.data=b.k.__proto__._groupBy("spiderweb",a),b.refresh_data=b.k.__proto__._groupBy("spiderweb",a),b.map_group_data=b.multiD.mapGroup(b.data),b.dataTransformation();var c=b.k.checkChangeInData(b.refresh_data,b.compare_data);b.compare_data=c[0];var d=c[1];d&&b.k.lastUpdatedAt("liveData"),b.optionalFeatures().createChart().legends().xAxis().yAxis()},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(c),b.k.dataSourceFormatIdentification(b.data,b,"executeRefresh")):b.k.dataSourceFormatIdentification(a.data,b,"executeRefresh")},this.render=function(){b.fillChart=new PykCharts.Configuration.fillChart(b);var a=b.selector.substring(1,b.selector.length),c=a+"_svg";b.border=new PykCharts.Configuration.border(b),b.map_group_data=b.multiD.mapGroup(b.data),b.dataTransformation(),"default"===b.mode?(b.k.title().backgroundColor(b).export(b,"#"+c,"spiderweb").emptyDiv(b.selector).subtitle().makeMainDiv(b.selector,1),b.h=b.chart_height,b.optionalFeatures().svgContainer(c,1).legendsContainer(1),b.k.liveData(b).tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b),b.optionalFeatures().legends().createGroups(),b.spiderweb_outer_radius_percent=b.k.__proto__._radiusCalculation(b.spiderweb_outer_radius_percent,"spiderweb"),b.radius_range=[3*b.spiderweb_outer_radius_percent/100,.09*b.spiderweb_outer_radius_percent],b.sizes=new PykCharts.multiD.bubbleSizeCalculation(b,b.data,b.radius_range),b.optionalFeatures().createChart().xAxis().yAxis(),b.k.createFooter().lastUpdatedAt().credits().dataSource()):"infographics"===b.mode&&(b.k.backgroundColor(b).export(b,"#"+c,"spiderweb").emptyDiv(b.selector),b.k.makeMainDiv(b.selector,1),b.h=b.chart_height,b.optionalFeatures().svgContainer(c,1).legendsContainer().createGroups(),b.spiderweb_outer_radius_percent=b.k.__proto__._radiusCalculation(b.spiderweb_outer_radius_percent,"spiderweb"),b.radius_range=[3*b.spiderweb_outer_radius_percent/100,.09*b.spiderweb_outer_radius_percent],b.sizes=new PykCharts.multiD.bubbleSizeCalculation(b,b.data,b.radius_range),b.optionalFeatures().createChart().xAxis().yAxis(),b.k.tooltip(),b.mouseEvent=new PykCharts.Configuration.mouseEvent(b)),b.k.exportSVG(b,"#"+c,"spiderweb");var d=b.k.resize(b.svgContainer);b.k.__proto__._ready(d),window.addEventListener("resize",function(){return b.k.resize(b.svgContainer)})},this.degrees=function(a){return a/Math.PI*180-90},this.optionalFeatures=function(){var a=this,b=a.selector.substring(1,a.selector.length),c={svgContainer:function(c,d){return document.getElementById(b).className+=" PykCharts-spider-web",a.svgContainer=d3.select(a.selector+" #chart-container-"+d).append("svg").attr({"class":"svgcontainer",id:c,width:a.chart_width,height:a.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+a.chart_width+" "+a.chart_height}),this},createGroups:function(){return a.group=a.svgContainer.append("g").attr({id:"spider-group",transform:"translate("+(a.chart_width-a.legendsGroup_width)/2+","+(a.h+a.legendsGroup_height+20)/2+")"}),a.ticksElement=a.svgContainer.append("g").attr("transform","translate("+(a.chart_width-a.legendsGroup_width)/2+","+(a.h+a.legendsGroup_height+20)/2+")"),this},legendsContainer:function(){return PykCharts["boolean"](a.legends_enable)&&a.map_group_data[1]&&"default"===a.mode?a.legendsGroup=a.svgContainer.append("g").attr({"class":"spiderweb-legends",id:"legends"}):(a.legendsGroup_width=0,a.legendsGroup_height=0),this},createChart:function(){var b,c,d,e=a.new_data[0].data,f=e.length;d=d3.max(a.new_data,function(a){return d3.max(a.data,function(a){return a.y})}),c=d3.min(a.new_data,function(a){return d3.min(a.data,function(a){return a.y})}),a.yScale=d3.scale.linear().domain([c,d]).range([a.inner_radius,a.spiderweb_outer_radius_percent]),a.y_domain=[],a.nodes=[];for(var g=[],b=0;b<a.new_data_length;b++){for(var h=[],i=0;i<a.new_data[b].data.length;i++)g.push(a.yScale(a.new_data[b].data[i].y)),h[i]=a.yScale(a.new_data[b].data[i].y);a.y_domain[b]=h}a.y=d3.scale.linear().domain(d3.extent(g,function(a){return parseFloat(a)})).range([.1,.9]);for(var b=0;b<a.new_data_length;b++){for(var j=[],i=0;f>i;i++)j[i]={x:i,y:a.y(a.y_domain[b][i]),tooltip:a.new_data[b].data[i].tooltip||a.new_data[b].data[i].weight};a.nodes[b]=j}a.radius=d3.scale.linear().range([a.inner_radius,a.spiderweb_outer_radius_percent]);for(var k=0;k<a.new_data_length;k++){var l=[];for(i=0;i<a.new_data[k].data.length;i++)l[i]=a.new_data[k].data[i].tooltip;a.angle=d3.scale.ordinal().domain(d3.range(a.new_data[k].data.length+1)).rangePoints([0,2*Math.PI]),a.yAxis=[];for(var b=0;b<a.new_data[k].data.length;b++)a.yAxis.push({x:b,y:.25},{x:b,y:.5},{x:b,y:.75},{x:b,y:1});var m,n=[];a.yAxis_length=a.yAxis.length;for(var b=0;b<a.yAxis_length;b++)m=b<a.yAxis_length-4?a.yAxis[b+4]:a.yAxis[b-a.yAxis_length+4],n.push({source:a.yAxis[b],target:m});for(var o,p=[],b=0;b<a.nodes[k].length;b++)b<a.nodes[k].length-1?(m=a.nodes[k][b+1],o=a.fillChart.colorPieW(a.new_data[k].data[b])):(m=a.nodes[k][0],o=a.fillChart.colorPieW(a.new_data[k].data[b])),p.push({source:a.nodes[k][b],target:m,color:o});var q=a.group.selectAll("#link"+k).data(p);q.enter().append("path").attr("class","link"),q.attr({"class":"link",stroke:function(a){return a.color},"stroke-opacity":1,id:"link"+k,d:d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})}),q.exit().remove(),a.weight=a.new_data[k].data.map(function(a){return a.weight});for(var r=a.weight.length,s=[],b=0;r>b;b++)0!==a.weight[b]&&s.push(a.weight[b]);a.weight=s,a.sorted_weight=a.weight.slice(0),a.sorted_weight.sort(function(a,b){return a-b});var t=a.group.selectAll(".node"+k).data(a.nodes[k]);t.enter().append("circle").attr({"class":"dot node"+k,transform:function(b){return"rotate("+a.degrees(a.angle(b.x))+")"}}),t.attr({"class":"dot node"+k,cx:function(b){return a.radius(b.y)},r:function(b,c){return a.sizes(a.new_data[k].data[c].weight)},"fill-opacity":function(b,c){return a.multiD.opacity(a.new_data[k].data[c].weight,a.weight,a.data)},"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:a.border.color(),"stroke-width":a.border.width(),"stroke-dasharray":a.border.style(),"data-id":function(b,c){return a.new_data[0].data[c].x}}).style("fill",function(b,c){return a.fillChart.colorPieW(a.new_data[k].data[c])}).on({mouseover:function(b){"default"===a.mode&&(a.mouseEvent.tooltipPosition(b),a.mouseEvent.tooltipTextShow(b.tooltip),PykCharts["boolean"](a.chart_onhover_highlight_enable)&&a.mouseEvent.highlight(a.selector+" .dot",this))},mouseout:function(b){"default"===a.mode&&(a.mouseEvent.tooltipHide(b),PykCharts["boolean"](a.chart_onhover_highlight_enable)&&a.mouseEvent.highlightHide(a.selector+" .dot"))},mousemove:function(b){"default"===a.mode&&a.mouseEvent.tooltipPosition(b)},click:function(b,c){PykCharts["boolean"](a.click_enable)&&a.addEvents(a.new_data[0].data[c].x,d3.select(this).attr("data-id"))}}),t.exit().remove()}return a.group.selectAll(".axis").data(d3.range(a.new_data[0].data.length)).enter().append("line").attr({"class":"axis",transform:function(b){return"rotate("+a.degrees(a.angle(b))+")"},x1:a.radius.range()[0],x2:a.radius.range()[1]}),a.group.selectAll(".grid").data(n).enter().append("path").attr({"class":"grid",d:d3.customHive.link().angle(function(b){return a.angle(b.x)}).radius(function(b){return a.radius(b.y)})}),this},legends:function(){return PykCharts["boolean"](a.legends_enable)&&a.map_group_data[1]&&"default"===a.mode&&a.multiD.legendsPosition(a,"spiderWeb",a.map_group_data[0]),this},xAxis:function(){a.length=a.new_data[0].data.length;var b=a.group.selectAll("text.x-axis-title").data(a.nodes[0]);return b.enter().append("text").attr("class","x-axis-title"),b.attr({transform:function(){return"translate("+-a.spiderweb_outer_radius_percent+","+-a.spiderweb_outer_radius_percent+")"},x:function(b,c){return a.spiderweb_outer_radius_percent*(1-.2*Math.sin(2*c*Math.PI/a.length))+1.25*a.spiderweb_outer_radius_percent*Math.sin(2*c*Math.PI/a.length)},y:function(b,c){return a.spiderweb_outer_radius_percent*(1-.6*Math.cos(2*c*Math.PI/a.length))-.47*a.spiderweb_outer_radius_percent*Math.cos(2*c*Math.PI/a.length)}}).style({"text-anchor":"middle","font-size":a.axis_x_pointer_size+"px","font-family":a.axis_x_pointer_family,"font-weight":a.axis_x_pointer_weight,fill:a.axis_x_pointer_color}),b.text(function(b,c){return a.new_data[0].data[c].x}),b.exit().remove(),this},yAxis:function(){for(var b=a.yScale.domain(),c=b[1]/4,d=[],e=4,f=0;e>=0;e--,f++)d[f]=e*c;var g=a.ticksElement.selectAll("text.y-axis-ticks").data(d);return g.enter().append("text").attr("class","y-axis-ticks"),g.style("text-anchor","start").attr({transform:"translate(5,"+-a.spiderweb_outer_radius_percent+")",x:0,y:function(b,c){return c*(a.spiderweb_outer_radius_percent/4)},dy:-2}),g.text(function(a){return a}).style({"font-size":a.axis_y_pointer_size+"px","font-family":a.axis_y_pointer_family,"font-weight":a.axis_y_pointer_weight,fill:a.axis_y_pointer_color}),g.exit().remove(),this},sort:function(){if("string"===a.axis_y_data_format)try{if("alphabetically"!==a.data_sort_type)throw a.data_sort_type=multiDimensionalCharts.data_sort_type,"data_sort_type";a.data=a.k.__proto__._sortData(a.data,"y","group",a)}catch(b){a.k.warningHandling(b,"8")}return this}};return c}},PykCharts.multiD.waterfall=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({}),d=c.multiDimensionalCharts;this.execute=function(e){b=new PykCharts.validation.processInputs(b,a,"multiDimensionalCharts"),b.calculate_total=a.calculate_total?a.calculate_total:d.calculate_total,b.calculate_total_of=a.calculate_total_of?a.calculate_total_of:[],b.axis_y_background_color=a.axis_y_background_color?a.axis_y_background_color:c.multiDimensionalCharts.axis_y_background_color,PykCharts.scaleFunction(b),b.color_mode="color",b.grid_y_enable="no",b.grid_color="#fff",b.panels_enable="no",b.longest_tick_width=0,b.ticks_formatter=d3.format("s");try{if(0==b.chart_color.length)throw b.chart_color=["rgb(255, 60, 131)","rgb(0, 185, 250)","grey"],"chart_color";if(1==b.chart_color.length)throw b.chart_color.push("rgb(0, 185, 250)","grey"),"chart_color";if(2==b.chart_color.length)throw b.chart_color.push("grey"),"chart_color"}catch(f){console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+b.selector+".(\"You seem to have passed less than three colors for '"+f+"', in a waterfall chart.\")  Visit www.pykcharts.com/errors#warning_18")}b.stop||(b.k.storeInitialDivHeight(),"default"===b.mode&&b.k.loading(),b.multiD=new PykCharts.multiD.configuration(b),b.executeData=function(c){var d=b.k.validator().validatingJSON(c),e=b.selector.substring(1,b.selector.length);return b.stop||d===!1?void b.k.remove_loading_bar(e):(b.data=b.k.__proto__._groupBy("waterfall",c),b.compare_data=b.k.__proto__._groupBy("waterfall",c),b.axis_y_data_format=b.k.yAxisDataFormatIdentification(b.data),b.axis_x_data_format="number",b.k.remove_loading_bar(e),PykCharts.multiD.waterfallFunctions(a,b,"waterfall"),void b.render())},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(e),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData"))}},PykCharts.multiD.waterfallFunctions=function(a,b){var c=b;c.refresh=function(b){for(var d=document.querySelectorAll(".custom-axis"),e=0;e<d.length;e++)d[e].parentNode.removeChild(d[e]);c.executeRefresh=function(a){c.data=c.k.__proto__._groupBy("waterfall",a),c.refresh_data=c.k.__proto__._groupBy("waterfall",a);var b=c.k.checkChangeInData(c.refresh_data,c.compare_data);c.compare_data=b[0];var d=b[1];d&&c.k.lastUpdatedAt("liveData"),c.groupData(),c.sortData(),c.calculateRiverData(),c.optionalFeatures().createScales().ticks().createChart(),c.k.yAxis(c.svgContainer,c.yGroup,c.yScale,c.yDomain,c.y_tick_values,void 0,void 0,c.tick_format_function),c.xaxis()},PykCharts["boolean"](c.interactive_enable)?(c.k.dataFromPykQuery(b),c.k.dataSourceFormatIdentification(c.data,c,"executeRefresh")):c.k.dataSourceFormatIdentification(a.data,c,"executeRefresh")},c.render=function(){var a=this,b=a.selector.substring(1,a.selector.length);a.container_id=b+"_svg",a.groupData(),a.sortData(),a.calculateRiverData(),a.transitions=new PykCharts.Configuration.transition(a),a.mouseEvent1=new PykCharts.Configuration.mouseEvent(a),a.border=new PykCharts.Configuration.border(a),a.reducedWidth=a.chart_width-a.chart_margin_left-a.chart_margin_right,a.reducedHeight=a.chart_height-a.chart_margin_top-a.chart_margin_bottom,"default"===a.mode?(a.k.title().backgroundColor(a).export(a,"#"+a.container_id,"waterfallChart").subtitle().makeMainDiv(a.selector,1),a.optionalFeatures(b).svgContainer(1,a.container_id).createGroups(),a.k.liveData(a).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a),a.optionalFeatures(b).axisContainer().createScales().ticks().createChart()):"infographics"===a.mode&&(a.k.backgroundColor(a).export(a,"#"+a.container_id,"waterfallChart").emptyDiv().makeMainDiv(a.selector,1),a.optionalFeatures(b).svgContainer(1,a.container_id).createGroups().axisContainer().createScales().ticks().createChart(),a.k.tooltip(),a.mouseEvent=new PykCharts.Configuration.mouseEvent(a)),a.k.yAxis(a.svgContainer,a.yGroup,a.yScale,a.yDomain,a.y_tick_values,void 0,void 0,a.tick_format_function).yAxisTitle(a.yGroup,void 0),a.xaxis(),a.optionalFeatures().axis_background(a.container_id),a.k.exportSVG(a,"#"+a.container_id,"waterfallChart");var c=a.k.resize(a.svgContainer);a.k.__proto__._ready(c),window.addEventListener("resize",function(){return a.k.resize(a.svgContainer)})},c.optionalFeatures=function(a){var b=this,c={svgContainer:function(c,d){return document.getElementById(a).className+=" PykCharts-twoD",b.svgContainer=d3.select(b.selector+" #chart-container-"+c).append("svg:svg").attr("width",b.chart_width).attr("height",b.chart_height).attr("id",d).attr("class","svgcontainer").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+b.chart_width+" "+b.chart_height),b.background_rect=b.svgContainer.selectAll(".background-rect").data(["rect"]),b.background_rect.enter().append("rect").attr("class","background-rect"),b.background_rect.attr("y",b.chart_margin_top).attr("width",b.longest_tick_width).attr("height",b.reducedHeight).attr("fill",b.axis_y_background_color),this},createGroups:function(){return b.group=b.svgContainer.append("g").attr("id","chartsvg").attr("transform","translate("+b.chart_margin_left+","+b.chart_margin_top+")"),this},createScales:function(){b.y_values=[],b.x_values=[];for(var a=b.river_data.length,c=[],d=0;a>d;d++)c.push(b.river_data[d].y),b.y_values.push(b.river_data[d].unique_name),b.x_values.push(b.river_data[d].end);return b.y_values.reverse(),c.reverse(),b.tick_format_function=function(a){var b=a.lastIndexOf("-");return-1!=b?a.substring(0,b):a},b.yScale=d3.scale.ordinal().domain(b.y_values).rangeRoundBands([b.reducedHeight,0],.1),b.yDomain=c,b.data_length=b.data.length,b.bars=b.group.selectAll(".bar").data(b.river_data),b.bars.attr("transform",function(a){return"translate(5, "+b.yScale(a.unique_name)+")"}),b.bars.enter().append("g").attr("class",function(a){return"bar "+a.group}).attr("transform",function(a){return"translate(5, "+b.yScale(a.unique_name)+")"}),this},axisContainer:function(){return(PykCharts.boolean(b.axis_y_enable)||b.axis_y_title)&&(b.yGroup=b.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(){b.y_tick_values=b.k.processYAxisTickValues(),b.xScale=d3.scale.linear().domain([0,d3.max(b.x_values,function(a){return a})]).range([0,b.reducedWidth-b.longest_tick_width-15]);var a=b.bars.selectAll(".rect").data(function(a){return[a]});a.enter().append("rect").attr("class","rect").attr("stroke",b.border.color()).attr("stroke-width",b.border.width()).attr("stroke-dasharray",b.border.style()).attr("stroke-opacity",1);var c=0;return a.attr("x",function(a){return b.xScale(a.start)+b.longest_tick_width+15}).attr("height",b.yScale.rangeBand()).attr("width",0).attr("fill",function(a){return a.color}).attr("fill-opacity",1).attr("data-id",function(a){return a.unique_name}).on("mouseover",function(a){if("default"===b.mode){if(PykCharts["boolean"](b.tooltip_enable)){var c=a.tooltip?a.tooltip:"<table><thead><th colspan='2'><b>"+a.y+"</b></th></thead><tr><td>Start</td><td><b>"+b.ticks_formatter(a.start)+"</b></td></tr><tr><td>Weight</td><td><b>"+b.ticks_formatter(a.x)+"</b></td></tr></table>";b.mouseEvent.tooltipPosition(a),b.mouseEvent.tooltipTextShow(c)}b.mouseEvent.axisHighlightShow(a.unique_name,b.selector+" .y.axis",b.y_values,"waterfall"),PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlight(b.selector+" .rect",this)}}).on("mouseout",function(a){"default"===b.mode&&(PykCharts["boolean"](b.tooltip_enable)&&b.mouseEvent.tooltipHide(a),b.mouseEvent.axisHighlightHide(b.selector+" .y.axis"),PykCharts["boolean"](b.chart_onhover_highlight_enable)&&b.mouseEvent.highlightHide(b.selector+" .rect"))}).on("mousemove",function(a){"default"===b.mode&&PykCharts["boolean"](b.tooltip_enable)&&b.mouseEvent.tooltipPosition(a)}).on("click",function(a){PykCharts["boolean"](b.click_enable)&&b.addEvents(a.unique_name,d3.select(this).attr("data-id"))}).transition().duration(b.transitions.duration()).delay(function(){return c++,c/b.data_length*b.transitions.duration()}).attr("x",function(a){return b.xScale("negative"==a.group?a.end:a.start)+b.longest_tick_width+15}).attr("width",function(a){return Math.abs(b.xScale(a.x))}),a.exit().remove(),b.bars.exit().remove(),this},ticks:function(){if(b.pointer_size){var a=b.bars.selectAll(".ticks-text").data(function(a){return[a]});a.enter().append("text").attr("class","ticks-text").style("font-weight",b.pointer_weight).style("font-size",b.pointer_size+"px").style("font-family",b.pointer_family).text(""),a.text(function(a){return b.ticks_formatter(a.x)}).style("visibility","hidden").attr("y",function(){return b.yScale.rangeBand()/2+this.getBBox().height/3}).attr("dx",".25em").attr("fill",function(a){return b.longest_tick_width=b.longest_tick_width<this.getBBox().width?this.getBBox().width:b.longest_tick_width,"negative"==a.group?b.chart_color[0]:"positive"==a.group?b.chart_color[1]:void 0}).style("visibility","visible"),a.exit().remove()}return this},axis_background:function(a){if(PykCharts.boolean(b.axis_y_enable)&&b.axis_y_pointer_size){for(var c=document.querySelectorAll("#"+a+" #yaxis .tick text"),d=c.length,e=[],f=0;d>f;f++)e.push(c[f].getBBox().width);var g=d3.max(e,function(a){return a});b.background_rect.attr("x",b.chart_margin_left-g-10).attr("width",g+10),b.background_rect.exit().remove()}return this}};return c},c.groupData=function(){for(c.group_arr=[],c.new_data=[],c.ticks=[],c.x_arr=[],j=0;j<c.data.length;j++)c.group_arr[j]=c.data[j].group;c.uniq_group_arr=c.k.__proto__._unique(c.group_arr);for(var a=c.uniq_group_arr.length,b=0;b<c.data.length;b++)c.x_arr[b]=+c.data[b].x;c.k.__proto__._unique(c.x_arr);c.flag=0;for(var b=0;a>b;b++){c.new_data[b]={name:c.uniq_group_arr[b],data:[]};for(var d=0;d<c.data.length;d++)c.uniq_group_arr[b]===c.data[d].group&&c.new_data[b].data.push({x:+c.data[d].x,y:c.data[d].y,tooltip:c.data[d].tooltip,name:c.data[d].group,unique_name:c.data[d].group?c.data[d].y+"-"+c.data[d].group:c.data[d].y})}c.new_data_length=c.new_data.length},c.dataTransformation=function(a){for(var b=0,d=0,e=a.data,f="Total",g=(e.length,0);g<c.data.length;g++)d+=c.data[g].x,b>d&&(b=d);return a.name&&(f=f+" "+a.name),b=0>b?Math.abs(b):0,e=c.rivergroup(b,e,f,b,a.name)},c.check_total_is_present=function(a){for(var b=!1,d=0;d<c.calculate_total_of.length;d++)if(a===c.calculate_total_of[d]){b=!0;break}return b},c.rivergroup=function(a,b,d,e,f){for(var g=0;g<b.length;g++)b[g].start=e,e+=b[g].x,b[g].end=e,b[g].group=b[g].x>0?"positive":"negative",b[g].color=b[g].x>0?c.chart_color[1]:c.chart_color[0],b[g].name=b[g].name,c.river_data.push(b[g]);return total_start=a,total_end=b[b.length-1].end,total_weight=total_end-total_start,totol_group=0>total_weight?"negative":"positive",c.river_data.push({y:d,x:total_weight,end:total_end,start:total_start,group:totol_group,color:c.chart_color[2],name:b[b.length-1].name,unique_name:f?d+"-"+f:d}),b},c.calculateRiverData=function(){c.river_data=[];for(var a,b=0;b<c.new_data_length;b++)if(0===b)c.dataTransformation(c.new_data[b]);else{var d=c.river_data.length;a=c.river_data[d-1];var e=c.check_total_is_present(a.name);PykCharts["boolean"](c.calculate_total)?!e&&c.calculate_total_of.length&&c.river_data.pop():c.river_data.pop(),name="Total "+c.new_data[b].name,c.rivergroup(c.river_data[0].start,c.new_data[b].data,name,a.end,c.new_data[b].name)}e=c.check_total_is_present(c.river_data[c.river_data.length-1].name),PykCharts["boolean"](c.calculate_total)?!e&&c.calculate_total_of.length&&c.river_data.pop():c.river_data.pop()},c.xaxis=function(){function a(a,b,d,e){c.group.append("line").attr("x1",a).attr("y1",d).attr("x2",b).attr("y2",e).attr("class","custom-axis").attr("stroke",c.axis_x_line_color).attr("stroke-width",1).style("shape-rendering","crispEdges")}var b=c.xScale.domain(),d=c.xScale(b[0])+c.longest_tick_width+15,e=c.xScale(b[1])+c.longest_tick_width+15,f=5,g=c.xScale(c.new_data[0].data[0].start)+c.longest_tick_width+15;if(PykCharts["boolean"](c.axis_x_enable)){a(d+f,e+f+1,c.reducedHeight,c.reducedHeight),a(d+f,d+f,c.reducedHeight,c.reducedHeight+c.axis_x_outer_pointer_length),a(e+f,e+f,c.reducedHeight,c.reducedHeight+c.axis_x_pointer_length),a(g+f,g+f,c.reducedHeight,c.reducedHeight+c.axis_x_pointer_length);var h=c.group.selectAll(".custom-axis-text").data([0]);h.enter().append("text"),h.attr("class","custom-axis-text").attr("x",g+f).attr("y",c.reducedHeight+c.axis_x_pointer_length).attr("dy",12).attr("text-anchor","middle").attr("fill",c.axis_x_pointer_color).style("font-family",c.axis_x_pointer_family).style("font-size",c.axis_x_pointer_size).style("font-weight",c.axis_x_pointer_weight).text("0"),h.exit().remove()}},c.sortData=function(){if("number"===c.axis_y_data_format||"time"===c.axis_y_data_format)for(var a=0;a<c.new_data_length;a++)c.new_data[a].data=c.k.__proto__._sortData(c.new_data[a].data,void 0,"y",c)}},PykCharts.maps={},PykCharts.maps.processInputs=function(a,b){{var c=new PykCharts.Configuration.Theme({}),d=c.stylesheet,e=(c.functionality,c.mapsTheme);b.optional}if(a.timeline_duration="timeline_duration"in b?b.timeline_duration:e.timeline_duration,a.margin_left=b.timeline_margin_left?b.timeline_margin_left:e.timeline_margin_left,a.margin_right=b.timeline_margin_right?b.timeline_margin_right:e.timeline_margin_right,a.margin_top=b.timeline_margin_top?b.timeline_margin_top:e.timeline_margin_top,a.margin_bottom=b.timeline_margin_bottom?b.timeline_margin_bottom:e.timeline_margin_bottom,a.tooltip_position_top=b.tooltip_position_top?b.tooltip_position_top:e.tooltip_position_top,a.tooltip_position_left=b.tooltip_position_left?b.tooltip_position_left:e.tooltip_position_left,a.tooltipTopCorrection=d3.select(a.selector).style("top"),a.tooltipLeftCorrection=d3.select(a.selector).style("left"),a.chart_color=b.chart_color?b.chart_color:[],a.saturation_color=b.saturation_color?b.saturation_color:"",a.palette_color=b.palette_color?b.palette_color:e.palette_color,a.label_enable=b.label_enable?b.label_enable.toLowerCase():e.label_enable,a.chart_onhover_effect=b.chart_onhover_effect?b.chart_onhover_effect.toLowerCase():e.chart_onhover_effect,a.default_zoom_level=b.default_zoom_level?b.default_zoom_level:80,a.k=new PykCharts.Configuration(a),a.total_no_of_colors=b.total_no_of_colors&&a.k.__proto__._isNumber(parseInt(b.total_no_of_colors,10))?parseInt(b.total_no_of_colors,10):e.total_no_of_colors,a.k.validator().validatingSelector(a.selector.substring(1,a.selector.length)).isArray(a.chart_color,"chart_color").validatingDataType(a.margin_left,"timeline_margin_left",e.timeline_margin_left,"margin_left").validatingDataType(a.margin_right,"timeline_margin_right",e.timeline_margin_right,"margin_right").validatingDataType(a.margin_top,"timeline_margin_top",e.timeline_margin_top,"margin_top").validatingDataType(a.margin_bottom,"timeline_margin_bottom",e.timeline_margin_bottom,"margin_bottom").validatingDataType(a.tooltip_position_top,"tooltip_position_top",e.tooltip_position_top).validatingDataType(a.tooltip_position_left,"tooltip_position_left",e.tooltip_position_left).validatingColor(a.highlight_color,"highlight_color",d.highlight_color).validatingColor(a.saturation_color,"saturation_color",d.saturation_color),a.chart_color.constructor===Array&&a.chart_color[0]&&a.k.validator().validatingColor(a.chart_color[0],"chart_color",d.chart_color),"saturation"===a.color_mode)try{if(a.total_no_of_colors<3||a.total_no_of_colors>9)throw a.total_no_of_colors=e.total_no_of_colors,"total_no_of_colors"}catch(f){a.k.warningHandling(f,"10")}try{if("shadow"!==a.chart_onhover_effect.toLowerCase()&&"none"!==a.chart_onhover_effect.toLowerCase()&&"highlight_border"!==a.chart_onhover_effect.toLowerCase()&&"color_saturation"!==a.chart_onhover_effect.toLowerCase())throw a.chart_onhover_effect=e.chart_onhover_effect,"chart_onhover_effect"}catch(f){a.k.warningHandling(f,"12")}try{if(!a.k.__proto__._isNumber(a.default_zoom_level))throw a.default_zoom_level=80,"default_zoom_level"}catch(f){a.k.warningHandling(f,"1")}return a.timeline_duration=1e3*a.timeline_duration,a},PykCharts.maps.oneLayer=function(a){var b=this;b.interval="";var c=new PykCharts.Configuration.Theme({});this.execute=function(d){b=new PykCharts.validation.processInputs(b,a,"maps"),b=PykCharts.maps.processInputs(b,a),b.executeData=function(d){var e=b.k.validator().validatingJSON(d),f=b.selector.substring(1,b.selector.length);return b.stop||e===!1?void b.k.remove_loading_bar(f):(b.k.storeInitialDivHeight(),b.data=d,b.data_length=b.data.length,b.compare_data=d,b.k.totalColors(b.total_no_of_colors).colorType(b.color_mode).loading(b.loading).tooltip(),d3.json(PykCharts.assets+"ref/"+b.map_code+"-topo.json",function(d,e){if(d&&404===d.status)return b.k.errorHandling("map_code","3"),void b.k.remove_loading_bar(f);b.map_data=e;for(var g=b.map_data.objects.geometries.length,h=0;g>h;h++){var i=b.map_data.objects.geometries[h].properties.NAME_1.replace("'","&#39;");b.map_data.objects.geometries[h].properties.NAME_1=i}d3.json(PykCharts.assets+"ref/colorPalette.json",function(d){b.color_palette_data=d;var e=b.k.__proto__._where(b.color_palette_data,{name:b.palette_color});try{if(!e.length)throw b.palette_color=c.mapsTheme.palette_color,"palette_color"}catch(f){b.k.warningHandling(f,"11")}d3.select(b.selector).html(""),d3.select(b.selector).style("height","auto");var g=new PykCharts.maps.mapFunctions(a,b,"oneLayer");g.render()})}),b.extent_size=d3.extent(b.data,function(a){return parseInt(a.size,10)}),void(b.difference=b.extent_size[1]-b.extent_size[0]))},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")}},PykCharts.maps.timelineMap=function(a){var b=this,c=new PykCharts.Configuration.Theme({});this.execute=function(d){b=new PykCharts.validation.processInputs(b,a,"maps"),b=PykCharts.maps.processInputs(b,a),PykCharts.scaleFunction(b),b.executeData=function(d){var e=b.k.validator().validatingJSON(d),f=b.selector.substring(1,b.selector.length);if(b.stop||e===!1)return void b.k.remove_loading_bar(f);b.k.storeInitialDivHeight(),b.timeline_data=d,b.compare_data=d;{var g=d3.extent(d,function(a){return a.timestamp});d.length}b.data=b.k.__proto__._where(d,{timestamp:g[0]}),b.data_length=b.data.length,b.redeced_width=b.chart_width-2*b.margin_left-b.margin_left,b.k.totalColors(b.total_no_of_colors).colorType(b.color_mode).loading(b.loading).tooltip(b.tooltip_enable),d3.json(PykCharts.assets+"ref/"+b.map_code+"-topo.json",function(d){b.map_data=d;for(var e=b.map_data.objects.geometries.length,f=0;e>f;f++){var g=b.map_data.objects.geometries[f].properties.NAME_1.replace("'","&#39;");b.map_data.objects.geometries[f].properties.NAME_1=g}d3.json(PykCharts.assets+"ref/colorPalette.json",function(d){b.color_palette_data=d;var e=b.k.__proto__._where(b.color_palette_data,{name:b.palette_color});try{if(!e.length)throw b.palette_color=c.mapsTheme.palette_color,"palette_color"}catch(f){b.k.warningHandling(f,"11")}var g=d3.extent(b.timeline_data,function(a){return a.timestamp});b.data=b.k.__proto__._where(b.timeline_data,{timestamp:g[0]}),b.data_length=b.data.length,b.data.sort(function(a,b){return a.timestamp-b.timestamp}),d3.select(b.selector).html("");var h=new PykCharts.maps.mapFunctions(a,b,"timeline");h.render()})}),b.extent_size=d3.extent(b.data,function(a){return parseInt(a.size,10)}),b.difference=b.extent_size[1]-b.extent_size[0]},PykCharts["boolean"](b.interactive_enable)?(b.k.dataFromPykQuery(d),b.k.dataSourceFormatIdentification(b.data,b,"executeData")):b.k.dataSourceFormatIdentification(a.data,b,"executeData")
}},PykCharts.maps.mapFunctions=function(a,b,c){var d=b,e=d.selector.substring(1,d.selector.length),f=e+"_svg";this.render=function(){d.border=new PykCharts.Configuration.border(d),d.mouseEvent=new PykCharts.Configuration.mouseEvent(d),d.k.title().backgroundColor(d),"oneLayer"===c&&d.k.export(d,"#"+f,c).emptyDiv().subtitle().exportSVG(d,"#"+f,c),d.current_palette=d.k.__proto__._where(d.color_palette_data,{name:d.palette_color,number:d.total_no_of_colors})[0],"timeline"===c&&d.k.subtitle(),d.optionalFeatures().svgContainer(f).legendsContainer(d.legends_enable).legends(d.legends_enable).createMap().label(d.label_enable),d.redeced_height=d.chart_height-d.margin_top-d.margin_bottom,d.k.createFooter().lastUpdatedAt().credits().dataSource(),"timeline"===c&&(d.optionalFeatures().axisContainer(!0),d.renderDataForTimescale(),d.backgroundColor(),d.renderButtons(),d.renderTimeline());var a=d.k.resize(d.svgContainer);d.k.__proto__._ready(a),window.addEventListener("resize",function(){return d.k.resize(d.svgContainer)})},d.refresh=function(b){d.executeRefresh=function(a){d.data=a,d.data_length=d.data.length,d.refresh_data=a;var b=d.k.checkChangeInData(d.refresh_data,d.compare_data);d.compare_data=b[0];var c=b[1];c&&d.k.lastUpdatedAt("liveData"),d.extent_size=d3.extent(d.data,function(a){return parseInt(a.size,10)}),d.difference=d.extent_size[1]-d.extent_size[0],d.optionalFeatures().legends(d.legends_enable).createMap()},"oneLayer"===c&&(PykCharts["boolean"](d.interactive_enable)?(d.k.dataFromPykQuery(b),d.k.dataSourceFormatIdentification(d.data,d,"executeRefresh")):d.k.dataSourceFormatIdentification(a.data,d,"executeRefresh"))},d.optionalFeatures=function(){var a=d.selector.substring(1,d.selector.length),b={legends:function(a){return PykCharts["boolean"](a)&&d.renderLegend(),this},legendsContainer:function(a){return PykCharts["boolean"](a)&&"saturation"===d.color_mode?d.legendsContainer=d.svgContainer.append("g").attr("id","legend-container"):(d.legendsGroup_height=0,d.legendsGroup_width=0),this},label:function(a){return PykCharts["boolean"](a)&&d.renderLabel(),this},svgContainer:function(b){document.getElementById(a).style.width="100%",d.svgContainer=d3.select(d.selector).append("svg").attr({width:d.chart_width,height:d.chart_height,id:b,"class":"PykCharts-map",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+d.chart_width+" "+d.chart_height}),d.map_cont=d.svgContainer.append("g").attr("id","map_group");var c=d.map_cont.append("defs"),e=c.append("filter").attr("id","dropshadow");e.append("feGaussianBlur").attr({"in":"SourceAlpha",stdDeviation:1,result:"blur"}),e.append("feOffset").attr({"in":"blur",dx:1,dy:1,result:"offsetBlur"});var f=e.append("feMerge");return f.append("feMergeNode").attr('in", "offsetBlur'),f.append("feMergeNode").attr("in","SourceGraphic"),this},createMap:function(){var b=d.chart_width-d.legendsGroup_width,c=d.chart_height-d.legendsGroup_height-d.margin_bottom-d.margin_top-10,e=150,f=[b/2,c/2];if(document.getElementById(a).style.backgroundColor=d.background_color,d.group=d.map_cont.selectAll(".map_group").data(topojson.feature(d.map_data,d.map_data.objects).features),d.group.enter().append("g").attr("class","map_group").append("path"),"world"===d.map_code||"world_with_antarctica"===d.map_code)var g=[0,0];else var g=d3.geo.centroid(topojson.feature(d.map_data,d.map_data.objects));var h=d3.geo.mercator().center(g).scale(e).translate(f);d.path=d3.geo.path().projection(h);var i=d.path.bounds(topojson.feature(d.map_data,d.map_data.objects)),j=e*b/(i[1][0]-i[0][0]),k=e*c/(i[1][1]-i[0][1]),e=k>j?j:k,f=[b-(i[0][0]+i[1][0])/2,c-(i[0][1]+i[1][1])/2];h=d3.geo.mercator().center(g).scale(d.default_zoom_level/100*e).translate(f),d.path=d.path.projection(h);var l=d3.select("#pyk-tooltip");return d.chart_data=d.group.select("path").attr({d:d.path,"class":"area",iso2:function(a){return a.properties.iso_a2},area_name:function(a){return a.properties.NAME_1},fill:d.renderColor,prev_fill:function(){return d3.select(this).attr("fill")},"fill-opacity":d.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(a){return a.properties.iso_a2}}).style({stroke:d.border.color(),"stroke-width":d.border.width(),"stroke-dasharray":d.border.style()}).on({mouseover:function(a){var b=d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2})[0];if(b){if(PykCharts["boolean"](d.tooltip_enable)){var c=d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2})[0].tooltip?d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2})[0].tooltip:"<table><thead><th colspan='2'><b>"+a.properties.NAME_1+"</b></th></thead><tr><td>Size</td><td><b>"+d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2})[0].size+"</b></td></tr></table>";l.style("display","block"),l.html(c),"moving"===d.tooltip_mode?l.style("top",function(){return PykCharts.getEvent().pageY-20+"px"}).style("left",function(){return PykCharts.getEvent().pageX+20+"px"}):"fixed"===d.tooltip_mode&&l.style("top",d.tooltip_position_top+"px").style("left",d.tooltip_position_left+"px")}"color_saturation"===d.onhover1&&PykCharts["boolean"](d.chart_onhover_highlight_enable)?d.mouseEvent.highlight(d.selector+" .area",this):d.bodColor(a)}},mouseout:function(a){PykCharts["boolean"](d.tooltip_enable)&&l.style("display","none"),d.bodUncolor(a),d.mouseEvent.highlightHide(d.selector+" .area")},click:function(a){PykCharts["boolean"](d.click_enable)&&d.addEvents(a.properties.iso_a2,d3.select(this).attr("data-id"))}}),d.group.exit().remove(),this},enableClick:function(a){return PykCharts["boolean"](a)?(d.chart_data.on("click",d.clicked),d.onhover1=d.chart_onhover_effect):d.onhover1=d.chart_onhover_effect,this},axisContainer:function(a){return PykCharts["boolean"](a)&&(d.gxaxis=d.svgContainer.append("g").attr({id:"xaxis","class":"x axis",transform:"translate("+2*d.margin_left+","+d.redeced_height+")"})),this}};return b},d.renderColor=function(a,b){if(!PykCharts["boolean"](a))return!1;var c,e=d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2});if(e.length>0){if("color"===d.color_mode)return d.chart_color[0]?d.chart_color[0]:e.length>0&&PykCharts["boolean"](e[0].color)?e[0].color:d.default_color[0];if("saturation"===d.color_mode){if(d.highlight===d.map_data.objects.geometries[b].properties.iso_a2)return d.highlight_color;if(""!==d.saturation_color)return d.saturation_color;if(""!==d.palette_color)for(c=e[0].size,b=0;b<d.current_palette.colors.length;b++)if(c>=d.extent_size[0]+b*(d.difference/d.current_palette.colors.length)&&c<=d.extent_size[0]+(b+1)*(d.difference/d.current_palette.colors.length))return 1===d.data.length?d.current_palette.colors[d.current_palette.colors.length-1]:d.current_palette.colors[b]}return d.default_color[0]}return d.default_color[0]},d.renderOpacity=function(a){return""!==d.saturation_color&&"saturation"===d.color_mode?(d.oneninth=+d3.format(".2f")(d.difference/d.total_no_of_colors),d.opacity=(d.extent_size[0]+d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2})[0].size+d.oneninth)/d.difference,d.opacity):1},d.renderLegend=function(){var a;if("saturation"===d.color_mode){if("vertical"===d.legends_display){var b=0,c=0;""===d.palette_color?(d.legendsContainer.attr("height",290),d.legendsGroup_height=0):(d.legendsContainer.attr("height",30*d.current_palette.number+20),d.legendsGroup_height=0),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,i=function(){return 38},j=function(){return 20};var e=function(){return c++,24*c+12},f=function(){return b++,24*b+23}}else if("horizontal"===d.legends_display){var g=0,h=0;""===d.palette_color?(g=9,h=9):(g=d.current_palette.number,h=d.current_palette.number,d.legendsContainer.attr("height",30*d.current_palette.number+20),d.legendsGroup_height=30*d.current_palette.number+20),d.legendsContainer.attr("height",50),d.legendsGroup_height=50,final_rect_x=0,final_text_x=0,legend_text_widths=[],temp_text=temp_rect=0,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var i=function(a,b){return legend_text_widths[b]=this.getBBox().width,legend_start_x=16,final_text_x=0===b?legend_start_x:legend_start_x+temp_text,temp_text=temp_text+legend_text_widths[b]+30,final_text_x};f=30,rect_parameter1value=13,rect_parameter2value=13;var j=function(a,b){return final_rect_x=0===b?0:temp_rect,temp_rect=temp_rect+legend_text_widths[b]+30,final_rect_x};e=18}if(""!==d.saturation_color){for(var a,k=[],h=1;h<=d.total_no_of_colors;h++)k.push(h);a=d3.format(".1f")(d.extent_size[1]/d.total_no_of_colors),d.leg=function(b,c){return"<"+d3.round(a*(c+1))};var l=d.legendsContainer.selectAll(".rect").data(k);d.legends_text=d.legendsContainer.selectAll(".text").data(k),d.legends_text.enter().append("text"),d.legends_text.attr("class","text").attr("pointer-events","none").text(d.leg).attr({fill:d.legends_text_color,"font-family":d.legends_text_family,"font-size":d.legends_text_size,"font-weight":d.legends_text_weight,x:i,y:f}),l.enter().append("rect"),l.attr("class","rect").attr({x:j,y:e,width:rect_parameter1value,height:rect_parameter2value,fill:d.saturation_color,"fill-opacity":function(a,b){return(b+1)/d.total_no_of_colors}});var m,n=d.legendsContainer.node().getBBox().width;d.legendsGroup_width="vertical"===d.legends_display?n+20:0,m="vertical"===d.legends_display?d.chart_width-d.legendsGroup_width:d.chart_width-n-20,n<d.chart_width&&d.legendsContainer.attr("transform","translate("+(m-20)+",10)"),d.legendsContainer.style("visibility","visible"),d.legends_text.exit().remove(),l.exit().remove()}else{d.leg=function(a,b){return"<"+d3.round(d.extent_size[0]+(b+1)*(d.difference/d.current_palette.number))};var l=d.legendsContainer.selectAll(".rect").data(d.current_palette.colors);d.legends_text=d.legendsContainer.selectAll(".text").data(d.current_palette.colors),d.legends_text.enter().append("text"),d.legends_text.attr("class","text").attr("pointer-events","none").text(d.leg).attr({fill:d.legends_text_color,"font-family":d.legends_text_family,"font-size":d.legends_text_size,"font-weight":d.legends_text_weight,x:i,y:f}),l.enter().append("rect"),l.attr({"class":"rect",width:rect_parameter1value,height:rect_parameter2value,fill:function(a){return a},x:j,y:e});var m,n=d.legendsContainer.node().getBBox().width;d.legendsGroup_width="vertical"===d.legends_display?n+20:0,m="vertical"===d.legends_display?d.chart_width-d.legendsGroup_width:d.chart_width-n-20,n<d.chart_width&&d.legendsContainer.attr("transform","translate("+m+",10)"),d.legendsContainer.style("visibility","visible"),d.legends_text.exit().remove(),l.exit().remove()}}else{var o=document.getElementById("legend-container");o&&o.parentNode.removeChild(o)}},d.renderLabel=function(){d.group.append("text").attr({x:function(a){return d.path.centroid(a)[0]},y:function(a){return d.path.centroid(a)[1]},"text-anchor":"middle","font-size":"10px",fill:d.label_color,"pointer-events":"none"}).text(function(a){return a.properties.NAME_1.replace("&#39;","'")})},d.bodColor=function(a){var b=d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2});PykCharts["boolean"](d.chart_onhover_highlight_enable)?"highlight_border"===d.onhover1?d3.select("path[area_name='"+a.properties.NAME_1+"']").style({stroke:d.border.color(),"stroke-width":parseFloat(d.border.width())+1.5+"px","stroke-dasharray":d.border.style()}):"shadow"===d.onhover1&&d3.select("path[area_name='"+a.properties.NAME_1+"']").attr({filter:"url(#dropshadow)","fill-opacity":function(){return""===d.palette_color&&"saturation"===d.color_mode?(d.oneninth_dim=+d3.format(".2f")(d.difference/d.total_no_of_colors),d.opacity_dim=(d.extent_size[0]+b[0].size+d.oneninth_dim)/d.difference,d.opacity_dim/2):.5}}):d.bodUncolor(a)},d.bodUncolor=function(a){d3.select("path[area_name='"+a.properties.NAME_1+"']").style({stroke:d.border.color(),"stroke-width":d.border.width(),"stroke-dasharray":d.border.style()}).attr({filter:null,"fill-opacity":function(){return""!==d.saturation_color&&"saturation"===d.color_mode?(d.oneninth_high=+d3.format(".2f")(d.difference/d.total_no_of_colors),d.opacity_high=(d.extent_size[0]+d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2})[0].size+d.oneninth_high)/d.difference,d.opacity_high):1}})},this.clicked=function(a){var b={};b.container=PykCharts.getEvent().target.ownerSVGElement.parentNode.id,b.area=a.properties,b.data=d.k.__proto__._where(d.data,{iso2:a.properties.iso_a2})[0];try{customFunction(b)}catch(c){}},d.backgroundColor=function(){function a(e){return c=e,b=d3.select(e).style("background-color"),"transparent"!==b&&"rgba(0, 0, 0, 0)"!==b?d.k.__proto__._colourBrightness(b,d3.selectAll(e)[0]):void 0!==d3.select(e)[0][0].parentNode.tagName&&"body"!==d3.select(e)[0][0].parentNode.tagName.toLowerCase()?a(d3.select(e)[0][0].parentNode):void d.k.__proto__._colourBrightness("rgb(255,255,255)",d3.select(e)[0])}var b,c;a(d.selector),d3.select(c)[0][0].classList.contains("light")||"/overview"===window.location.pathname?(d.play_image_url=PykCharts.assets+"img/play.png",d.pause_image_url=PykCharts.assets+"img/pause.png",d.marker_image_url=PykCharts.assets+"img/marker.png"):(d.play_image_url=PykCharts.assets+"img/play-light.png",d.pause_image_url=PykCharts.assets+"img/pause-light.png",d.marker_image_url=PykCharts.assets+"img/marker-light.png")},d.renderDataForTimescale=function(){d.unique=[],x_extent=d3.extent(d.timeline_data,function(a){return a.timestamp}),x_range=[0,d.redeced_width],d.xScale=d.k.scaleIdentification("linear",x_extent,x_range);for(var a=d.timeline_data.length,b=0;a>b;b++)-1===d.unique.indexOf(d.timeline_data[b].timestamp)&&d.unique.push(d.timeline_data[b].timestamp);d.unique.sort(function(a,b){return a-b}),d.k.xAxis(d.svgContainer,d.gxaxis,d.xScale),d.gxaxis&&d.gxaxis.attr("transform","translate("+2*d.margin_left+","+d.redeced_height+")")},d.renderTimeline=function(){var a=interval1=d.interval_index=1;d.play.on("click",function(){b()}),d.timeline_status="";var b=function(){if("playing"===d.timeline_status)d.play.attr("xlink:href",d.play_image_url),d.timeline_status="paused",d.interval_index=a,clearInterval(d.play_interval);else{d.timeline_status="playing",d.play.attr("xlink:href",d.pause_image_url),a=d.interval_index;var b=function(){a===d.unique.length&&(a=0),d.marker.attr("x",2*d.margin_left+d.xScale(d.unique[a])-7),d.data=d.k.__proto__._where(d.timeline_data,{timestamp:d.unique[a]}),d.data_length=d.data.length,d.data.sort(function(a,b){return a.timestamp-b.timestamp}),d.extent_size=d3.extent(d.data,function(a){return parseInt(a.size,10)}),d.difference=d.extent_size[1]-d.extent_size[0];for(var b=0;b<d.data_length;b++)d3.select(d.selector+" path[iso2='"+d.data[b].iso2+"']").attr({fill:d.renderColor,"fill-opacity":d.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")}});a++};d.play_interval=setInterval(function(){b(),1===a&&(d.play.attr("xlink:href",d.play_image_url),d.interval_index=1,d.timeline_status="",clearInterval(d.play_interval))},d.timeline_duration),b()}}},d.renderButtons=function(){function a(){if(document.getElementsByTagName("body")[0].style.cursor="pointer","playing"!==d.timeline_status){for(var a,b,c,e,f=PykCharts.getEvent().sourceEvent.pageX-d.margin_left,g=[],h=d.xScale.range(),i=d.unique.length,j=(h[1]-h[0])/i,k=0,l=0;i>l;l++)k+=j,g[l]=parseInt(k);for(var m=0;i>m;m++)if(f>=g[m]&&f<=g[m+1]){if(a=g[m],b=g[m+1],c=f-a,e=b-f,c>=e&&i-2>=m){d.marker.attr("x",2*d.margin_left+d.xScale(d.unique[m])-7),d.data=d.k.__proto__._where(d.timeline_data,{timestamp:d.unique[m]}),d.data_length=d.data.length,d.data.sort(function(a,b){return a.timestamp-b.timestamp}),d.extent_size=d3.extent(d.data,function(a){return parseInt(a.size,10)}),d.difference=d.extent_size[1]-d.extent_size[0];for(var n=0;n<d.data_length;n++)d3.select(d.selector+" path[iso2='"+d.data[n].iso2+"']").attr({fill:d.renderColor,"fill-opacity":d.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")}});d.interval_index=m}}else if(f>g[m]&&m>i-2){d.marker.attr("x",2*d.margin_left+d.xScale(d.unique[m])-7),d.data=d.k.__proto__._where(d.timeline_data,{timestamp:d.unique[m]}),d.data_length=d.data.length,d.data.sort(function(a,b){return a.timestamp-b.timestamp}),d.extent_size=d3.extent(d.data,function(a){return parseInt(a.size,10)}),d.difference=d.extent_size[1]-d.extent_size[0];for(var n=0;n<d.data_length;n++)d3.select(d.selector+" path[iso2='"+d.data[n].iso2+"']").attr({fill:d.renderColor,"fill-opacity":d.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")}});d.interval_index=m}}}var b=d3.select(d.selector+" .axis").node().getBBox();drag=d3.behavior.drag().origin(Object).on("drag",a).on("dragend",function(){document.getElementsByTagName("body")[0].style.cursor="default"}),d.play=d.svgContainer.append("image").attr({"xlink:href":d.play_image_url,x:d.margin_left/2,y:d.redeced_height-d.margin_top-b.height/2,width:"24px",height:"21px"}).style("cursor","pointer"),d.marker=d.svgContainer.append("image").attr({"xlink:href":d.marker_image_url,x:2*d.margin_left+d.xScale(d.unique[0])-7,y:d.redeced_height,width:"14px",height:"12px"}).style("cursor","pointer").call(drag)}};var anonymousFunc=function(){function a(a){var b=document.createElement("script");b.type="text/javascript",b.async=!1,b.onload=function(){try{PykCharts.numberFormat=d3.format(","),d3&&d3.customHive&&topojson&&$c&&paper&&(window.PykChartsInit(),document.querySelector("body").onclick=function(){0===PykCharts.export_menu_status&&d3.selectAll(".dropdown-multipleConatiner-export").style("visibility","hidden"),PykCharts.export_menu_status=0})}catch(a){}},b.src=a;var c=document.getElementsByTagName("link")[0];c.parentNode.insertBefore(b,c)}var b=[PykCharts.assets+"lib/d3.min.js",PykCharts.assets+"lib/topojson.min.js",PykCharts.assets+"lib/custom-hive.min.js",PykCharts.assets+"lib/colors.min.js",PykCharts.assets+"lib/paper-full.min.js"];try{d3||a(b[0])}catch(c){a(b[0])}try{d3.customHive||a(b[1])}catch(c){a(b[1])}try{topojson||a(b[2])}catch(c){a(b[2])}try{$c||a(b[3])}catch(c){a(b[3])}try{paper||a(b[4])}catch(c){a(b[4])}};window.onload=anonymousFunc;